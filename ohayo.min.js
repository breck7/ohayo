var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(q){f(q)}}:b}var d,f,g=new e(function(a,
b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6-impl","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(c=c||0;c<e;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6-impl","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill("Object.values",function(a){return a?a:function(a){var b=[],d;for(d in a)$jscomp.owns(a,d)&&b.push(a[d]);return b}},"es8","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es6","es3");
$jscomp.polyfill("WeakMap",function(a){function b(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function c(a){var c=Object[a];c&&(Object[a]=function(a){b(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(l){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);c("freeze");c("preventExtensions");
c("seal");var e=0,f=function(a){this.id_=(e+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};f.prototype.set=function(a,c){b(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};f.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};f.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};f.prototype.delete=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return f},"es6-impl","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(p){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var b=new WeakMap,c=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype.delete=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};c.prototype.has=function(a){return!!d(this,a).entry};c.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};c.prototype.entries=function(){return e(this,function(a){return[a.key,
a.value]})};c.prototype.keys=function(){return e(this,function(a){return a.key})};c.prototype.values=function(){return e(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var d=function(a,c){var d=c&&typeof c;"object"==d||"function"==d?b.has(c)?d=b.get(c):(d=""+ ++g,b.set(c,d)):d="p_"+c;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=
e[a];if(c!==c&&f.key!==f.key||c===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},e=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=a.next=a.head=a},g=0;return c},"es6-impl","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=b.length);c=Math.max(0,Math.min(c|0,b.length));for(var e=a.length;0<e&&0<c;)if(b[--c]!=a[--e])return!1;return 0>=e}},"es6-impl","es3");$jscomp.polyfill("Object.assign",function(a){return a?a:function(a,c){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var f in e)$jscomp.owns(e,f)&&(a[f]=e[f])}return a}},"es6-impl","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6-impl","es3");var AbstractChisel=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(AbstractChisel,TreeNotation);AbstractChisel.prototype.getApp=function(){return this.getRootNode()};
AbstractChisel.prototype.getParseErrorCount=function(){return this.length?lodash.sum(this.getTopDownArray().map(function(a){return a.getParseErrorCount()})):0};AbstractChisel.prototype.getStump=function(){return this._htmlStump};AbstractChisel.prototype.toJavascript=function(){return""};AbstractChisel.prototype._stopPropagationCommand=function(){};AbstractChisel.prototype.isNode=function(){return"undefined"!==typeof exports};AbstractChisel.prototype.getHakon=function(){return""};
AbstractChisel.prototype.getTheme=function(){return this.getApp().getTheme()};AbstractChisel.prototype.getCommandsBuffer=function(){this._commandsBuffer||(this._commandsBuffer=[]);return this._commandsBuffer};AbstractChisel.prototype.logCommand=function(a){this.getCommandsBuffer().push({command:a,time:this._getNow()})};AbstractChisel.prototype.getMessageBuffer=function(){this._messageBuffer||(this._messageBuffer=new TreeNotation);return this._messageBuffer};
AbstractChisel.prototype.clearCommand=function(){delete this._messageBuffer;return Promise.resolve()};AbstractChisel.prototype.logMessage=function(a){this.getMessageBuffer().append("message",a)};AbstractChisel.prototype.unmount=function(){this.isMounted()&&(this._getChildChisels().forEach(function(a){return a.unmount()}),this.chiselWillUnmount(),this._removeCss(),this._removeHtml(),delete this._lastRenderedTime,this.chiselDidUnmount())};
AbstractChisel.prototype._removeCss=function(){this._cssStump.removeStump();delete this._cssStump};AbstractChisel.prototype._removeHtml=function(){this._htmlStump.removeStump();delete this._htmlStump};AbstractChisel.prototype._confirmAndUnmountCommand=function(){var a=this;return(this.hasChanges()?this.getApp().confirm("Drop changes?"):Promise.resolve(!0)).then(function(b){if(!b)return!1;b=a.getApp();a.unmountAndDestroy();b.renderApp()})};
AbstractChisel.prototype.getBray=function(){return"@ div\n class "+this.constructor.name};AbstractChisel.prototype.chiselWillMount=function(){};AbstractChisel.prototype.chiselDidMount=function(){void 0===AbstractChisel._mountedChisels&&(AbstractChisel._mountedChisels=0);AbstractChisel._mountedChisels++};AbstractChisel.prototype.chiselDidUnmount=function(){AbstractChisel._mountedChisels--};AbstractChisel.prototype.chiselWillUnmount=function(){};AbstractChisel.prototype.forceUpdate=function(){};
AbstractChisel.prototype.getNewestTimeToRender=function(){return this._lastTimeToRender};AbstractChisel.prototype._setLastRenderedTime=function(a){this._lastRenderedTime=a;return this};AbstractChisel.prototype.chiselDidUpdate=function(){};AbstractChisel.prototype._getChildChisels=function(){return this.getChildren().filter(function(a){return a instanceof AbstractChisel})};AbstractChisel.prototype.makeAllDirty=function(){this.makeDirty();this._getChildChisels().forEach(function(a){return a.makeAllDirty()})};
AbstractChisel.prototype.hasChildren=function(){return 0<this._getChildChisels().length};AbstractChisel.prototype.getStumpForChildren=function(){return this.getStump()};AbstractChisel.prototype._renderChildren=function(){var a=this.getStumpForChildren();this._getChildChisels().filter(function(a){return a.isMounted()||a.shouldChiselMount()}).forEach(function(b,c){return b.render(a,c)})};AbstractChisel.prototype.getLastRenderedTime=function(){return this._lastRenderedTime};
AbstractChisel.prototype.makeDirty=function(){this._setLastRenderedTime(0)};AbstractChisel.prototype._getCss=function(){return this.getTheme().hakonToCss(this.getHakon())};AbstractChisel.prototype._getCssBray=function(){return"@ style\n styleFor "+this.constructor.name+"\n bern"+TreeNotation.nest(this._getCss(),2)};
AbstractChisel.prototype._update=function(){if(!this._shouldChiselUpdate())return!1;this._setLastRenderedTime(this._getNow());this._removeCss();this._mountCss();if(this.hasChildren())return!1;this.updateHtml();this._lastTimeToRender=this._getNow()-this.getLastRenderedTime();return!0};AbstractChisel.prototype._mountCss=function(a){this._cssStump=this.getApp().getWillowDocument().getHeadStump().insertChildNode(this._getCssBray())};
AbstractChisel.prototype._mountHtml=function(a,b){this._htmlStump=a.insertChildNode(this.getBray(),b);this._htmlStump.setStumpChisel(this)};AbstractChisel.prototype.updateHtml=function(){var a=this._htmlStump.getParent(),b=this._htmlStump.getIndex();this._removeHtml();this._mountHtml(a,b)};
AbstractChisel.prototype._mount=function(a,b){if(!this.shouldChiselMount())return this;this._setLastRenderedTime(this._getNow());this.chiselWillMount();this.getApp().getWillowDocument();this._mountCss(a);this._mountHtml(a,b);this._lastTimeToRender=this._getNow()-this.getLastRenderedTime();return this};AbstractChisel.prototype.unmountAndDestroy=function(){this.unmount();return this.destroy()};
AbstractChisel.prototype.toggle=function(a,b){var c=this.getNode(a);if(!b)return c?c.unmountAndDestroy():this.append(a);c=void 0===c?void 0:c.getBeam();c=b.indexOf(c);b=-1===c||c+1===b.length?b[0]:b[c+1];this.delete(a);b&&this.touchNode(a).setBeam(b);return b};AbstractChisel.prototype.isMounted=function(){return!!this._htmlStump};AbstractChisel.prototype.getNextOrPrevious=function(a){var b=a.length,c=a.indexOf(this);if(1!==b)return c===b-1?a[c-1]:a[c+1]};
AbstractChisel.prototype.toggleAndRender=function(a,b){this.toggle(a,b);this.getApp().renderApp();return Promise.resolve()};AbstractChisel.prototype.appendAndRender=function(a,b){this.append(a,b);this.getApp().renderApp();return Promise.resolve()};AbstractChisel.prototype.swapAndRender=function(a,b){var c=this.has(a)?b:a;a=this.has(a)?a:b;a=this.getNode(a);b=a.getIndex();this.insert(c,void 0,b);a.unmountAndDestroy();this.getApp().renderApp();return Promise.resolve()};
AbstractChisel.prototype._shouldChiselUpdate=function(){var a=this.getLastRenderedTime();return!a||a<this.getMTime()?!0:this.getDependencyTimestamps().some(function(b){return b>a})};AbstractChisel.prototype.getDependencyTimestamps=function(){return[]};AbstractChisel.prototype.shouldChiselMount=function(){return!0};
AbstractChisel.prototype.render=function(a,b){var c=this.isMounted(),d=!1;c?d=this._update():this._mount(a,b);this.isMounted()&&this._renderChildren();c?d&&this.chiselDidUpdate():this.chiselDidMount();return this};window.AbstractChisel=AbstractChisel;var AbstractProgramChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractProgramChisel,AbstractChisel);AbstractProgramChisel._mountedChisels=AbstractChisel._mountedChisels;
AbstractProgramChisel.prototype.parseNodeType=function(a){var b=this.getDictionary();return(a=b.parseNodeTypeFromDictionary(this,a))?a:b.getDidYouMeanDefinition().getDefinitionJSClass()};AbstractProgramChisel.prototype.getProgram=function(){return this};AbstractProgramChisel.prototype.getOutputBinder=function(){this._outputBinder||(this._outputBinder=new Binder(this));return this._outputBinder};AbstractProgramChisel.prototype.getGuess=function(){return{guess:this.getParseErrorCount(),name:this.getExtensionName()}};
AbstractProgramChisel.prototype.getHierarchy=function(){return{node:this,children:this.getProgramBlocks().map(function(a){return a.getHierarchy()})}};AbstractProgramChisel.prototype.getProgramBlocks=function(){return this.getTopDownArray().filter(function(a){return a instanceof AbstractBlockChisel})};AbstractProgramChisel.prototype.getProgramOfInterest=function(){return this};
AbstractProgramChisel.prototype.getDictionary=function(){var a=this.getExtensionName();this._dictionary||(this._dictionary=new DictionaryProgram(this.getDictionaryString(),a,this));return this._dictionary};AbstractProgramChisel.prototype.isProgram=function(){return!0};AbstractProgramChisel.prototype.getProgramTypeString=function(){return this.getTopDownArray().map(function(a){return a.getIndentation()+a.getTypeLine()}).join("\n")};
AbstractProgramChisel.prototype.executeLoadProgramCode=function(){var a=this,b=this.getDictionary(),c=lodash.uniq(this.getProgramBlocks().map(function(a){return a.getBase()}));return Promise.all(c.map(function(c){return b.loadDefinitionCode(c,a.getApp())}))};AbstractProgramChisel.prototype.executeLoadProgramCodeAndData=function(){var a=this;return this.executeLoadProgramCode().then(function(){return Promise.all(a.getProgramBlocks().map(function(a){return a.executeLoadData()}))})};
AbstractProgramChisel.prototype.getBlockDimensionMap=function(a,b){return(new (this._getLayoutStrategyClass())(this,a,b)).makeBlockDimensionMap()};AbstractProgramChisel.prototype._getLayoutStrategyClass=function(){return LayoutStrategies[this.findBeam(">settings layout")]||LayoutStrategies.custom};AbstractProgramChisel.prototype.getProgramDimension=function(){var a=this.getApp().getWillowDocument().getBodyStump().getShadow();return{width:a.getShadowWidth()-this.getParent().getGutterWidth(),height:a.getShadowHeight()}};
AbstractProgramChisel.prototype.getSelectedBlocks=function(){return this.getProgramBlocks().filter(function(a){return a.isSelected()})};AbstractProgramChisel.prototype.clearSelection=function(){this.getSelectedBlocks().forEach(function(a){return a.unselect()})};AbstractProgramChisel.prototype.selectAll=function(){this.getProgramBlocks().forEach(function(a){return a.selectBlock()})};AbstractProgramChisel.prototype.getFirstSelectedBlock=function(){return this.getSelectedBlocks()[0]};
AbstractProgramChisel.prototype.selectNext=function(){for(var a=this.getFirstSelectedBlock().getNext();!a.getBase().startsWith(">");)a=this.getFirstSelectedBlock().getNext();this.clearSelection();a.selectBlock();return Promise.resolve()};AbstractProgramChisel.prototype.copySelection=function(a){a=this._copySelection(a);if(!a)return Promise.resolve();this.getApp().logMessage("Items copied");return Promise.resolve(a)};
AbstractProgramChisel.prototype._copySelection=function(a){var b=this.getApp().getWillowDocument();if(b.someInputHasFocus())return"";var c=this.selectionToString();if(!c)return"";b.setCopyData(a,c);return c};AbstractProgramChisel.prototype.selectionToString=function(){return this.getSelectedBlocks().map(function(a){return a.toString()}).join("\n")};AbstractProgramChisel.prototype.selectBlocksByShadowClass=function(a){a=void 0===a?"ui-selected":a;this.getApp().getWillowDocument().findStumpsByShadowClass(a).forEach(function(a){return a.getStumpChisel().selectBlock()})};
AbstractProgramChisel.prototype._getPinChangeInPixels=function(a,b){return{left:a.offset.left-b.left,top:a.offset.top-b.top}};AbstractProgramChisel.prototype.cutSelection=function(a){a=this._copySelection(a);if(!a)return Promise.resolve();this.deleteSelection();this.getApp().logMessage("Items cut");return Promise.resolve(a)};
AbstractProgramChisel.prototype.deleteSelection=function(){var a=this.getSelectedBlocks();if(!a.length)return Promise.resolve();a.forEach(function(a){return a.unmountAndDestroy()});return this.autosaveAndRender()};AbstractProgramChisel.prototype.duplicateSelection=function(){var a=this,b=this.getSelectedBlocks().map(function(b){return a.cloneBlock(b)}),c=this.autosaveAndRender();this.clearSelection();b.forEach(function(a){return a.selectBlock()});return c};
AbstractProgramChisel.prototype.selectPrevious=function(){for(var a=this.getFirstSelectedBlock().getPrevious();!a.getBase().startsWith(">");)a=this.getFirstSelectedBlock().getPrevious();this.clearSelection();a.selectBlock();return Promise.resolve()};AbstractProgramChisel.prototype.appendFromPaste=function(a){var b=this,c=this.concat(a).filter(function(a){return a instanceof AbstractBlockChisel});a=this.autosaveAndRender();this.clearSelection();return a.then(function(){return b.executeLoadProgramCodeAndData().then(function(){c.forEach(function(a){return a.selectBlock()})}).catch(function(a){console.error(a)})})};
AbstractProgramChisel.prototype.getAutocompleteWords=function(a){var b=this.getDictionary().getBlockNames().join("\n")+"\n"+this.childrenToString();return Util.getUniqueWordsArray(b).filter(function(b){return b.word.includes(a)&&b.word!==a}).map(function(a){return a.word})};AbstractProgramChisel.prototype.setLayout=function(a){this.touchNode(">settings layout").setBeam(a);return this};
AbstractProgramChisel.prototype.cloneBlock=function(a){var b=a.duplicate();(a=a.findBeam(BlockConstants.pin))&&b.touchNode(BlockConstants.pin).setBeam(this.getAvailableSpot(a));return b};AbstractProgramChisel.prototype._updateCustomPoint=function(){return this._updateCustomLayout()};AbstractProgramChisel.prototype._updateCustomPointWithWidthAndHeight=function(){return this._updateCustomLayout(!0)};
AbstractProgramChisel.prototype._updateCustomLayout=function(a){a=void 0===a?!0:a;var b=this,c=this.getApp();c.getWillowDocument().findStumpsWithClass("BlockChisel").forEach(function(c){return b._updateBlockLayout(c,a)});this.setLayout("custom");this.autosaveProgram();c.renderApp()};
AbstractProgramChisel.prototype._updateBlockLayout=function(a,b){var c=a.getShadow(),d=a.getStumpChisel();if(d.isVisible()){var e=c.getShadowOffset(),f=this.getGridSize();a=a.getParent().getShadow().getShadowOffset();c=[Math.floor((e.left-a.left)/f),Math.floor((e.top-a.top)/f),Math.floor(c.getShadowWidth()/f),Math.floor(c.getShadowHeight()/f)];b=(b?c:c.slice(0,2)).join(" ");d.findBeam(BlockConstants.pin)!==b&&(d.delete(BlockConstants.pin),d.prepend(BlockConstants.pin+" "+b))}};
AbstractProgramChisel.prototype.getAvailableSpot=function(a){a=a.split(" ").map(function(a){return parseInt(a)});a[0]++;a[1]++;return a.join(" ")};AbstractProgramChisel.prototype.toggleLayout=function(){var a=this.toggle(">settings layout",["custom","bin","tree"]);this.getProgramBlocks().forEach(function(a){return a.makeDirty()});this.getApp().logMessage("Layout set to '"+a+"'");return this.autosaveAndRender()};AbstractProgramChisel.prototype.getGridSize=function(){return 20};
AbstractProgramChisel.prototype.autosaveAndRender=function(){var a=this.autosaveProgram();this.getApp().renderApp();return a};AbstractProgramChisel.prototype.autosaveProgram=function(){var a=this,b=this.childrenToString(),c=this._getTopUndoVersion();if(b===c)return Promise.resolve();this._recordChange(b);return this.getApp().isAutoSaveEnabled()?this.forceSaveToDisk().then(function(){a.logMessage("Saved "+a.getUrl())}):Promise.resolve()};
AbstractProgramChisel.prototype._clearRedoStack=function(){var a=this._getRedoStack();a.splice(0,a.length)};AbstractProgramChisel.prototype._recordChange=function(a){this._clearRedoStack();this._getUndoStack().push(a)};AbstractProgramChisel.prototype.forceSaveToDisk=function(){var a=this._getDiff();this.setHash(a.newHash);this._setDiskVersion(a.newVersion);return this.getApp().saveProgramToDisk(this,a)};AbstractProgramChisel.prototype._getDiskVersion=function(){return this._diskVersion};
AbstractProgramChisel.prototype._setDiskVersion=function(a){this._diskVersion=a;return this};AbstractProgramChisel.prototype._getUndoStack=function(){this._undoStack||(this._undoStack=[]);return this._undoStack};AbstractProgramChisel.prototype._getRedoStack=function(){this._redoStack||(this._redoStack=[]);return this._redoStack};AbstractProgramChisel.prototype._getTopUndoVersion=function(){var a=this._getUndoStack();return a[a.length-1]};
AbstractProgramChisel.prototype.undoCommand=function(){var a=this._getUndoStack(),b=this._getRedoStack();if(1===a.length)return Promise.resolve();b.push(a.pop());return this._reloadFromUndoTop()};AbstractProgramChisel.prototype._reloadFromUndoTop=function(){this.unmount();this.setChildren(this._getTopUndoVersion());return this._reloadProgram()};AbstractProgramChisel.prototype.autosaveAndReloadWith=function(a){this.unmount();this.setChildren(a);this.autosaveProgram();return this._reloadProgram()};
AbstractProgramChisel.prototype._reloadProgram=function(){var a=this;return this.executeLoadProgramCodeAndData().then(function(){a.getParent().setMountedProgram(a);a.getApp().renderApp()})};AbstractProgramChisel.prototype.redoCommand=function(){var a=this._getUndoStack(),b=this._getRedoStack();if(!b.length)return Promise.resolve();a.push(b.pop());return this._reloadFromUndoTop()};AbstractProgramChisel.prototype.hasUnsavedChanges=function(){return this.childrenToString()!==this._getDiskVersion()};
AbstractProgramChisel.prototype.getHash=function(){return this._hash||""};AbstractProgramChisel.prototype.setHash=function(a){this._hash=a};AbstractProgramChisel.prototype._getDiff=function(){var a=this.getHash(),b=this.childrenToString(),c=this._getDiskVersion(),c=diff.compareStr(c,b,"\n"),d=new jsSHA("SHA-1","TEXT");d.update(a+JSON.stringify(c));d=d.getHash("HEX");return{oldHash:a,newHash:d,patch:c,newVersion:b}};
AbstractProgramChisel.prototype.setChildrenAndDiskAndUndoStack=function(a){this.setChildren(a);this._setDiskVersion(a);this._getUndoStack().push(a);return this};AbstractProgramChisel.prototype.getFileName=function(){return this.getUrl().split("/").pop()};AbstractProgramChisel.prototype.getUrl=function(){return this.getBeam()};AbstractProgramChisel.prototype.getCTime=function(){return this._ctime||0};
AbstractProgramChisel.prototype.getHakon=function(){var a=this.getTheme(),b=this.getParent().getGutterWidth();return".AbstractProgramChisel\n background "+a.surfaceBackground+"\n position relative\n left "+b+"px\n right 0\n bottom 0\n height calc(100% - 60px)\n\n.ui-selectable-helper\n position absolute\n z-index 100\n border-radius 2px\n background "+a.selectionBackground+"\n\n.ui-selecting,.ui-selected,.StaySelected\n outline 3px solid "+a.selectedOutline};
AbstractProgramChisel.prototype.makePin=function(a){var b=this.getGridSize();return[Math.floor((a.offsetX-0)/b),Math.floor(a.offsetY/b)].join(" ")};AbstractProgramChisel.prototype.chiselDidUpdate=function(){this._fixBigBug()};
AbstractProgramChisel.prototype._fixBigBug=function(){var a={"min-height":"","min-width":"",width:"",height:""},b=this.getApp(),c=this.getStump(),d=c.getParent(),e=b.getWillowDocument(),f=e.getHtmlStump(),b=(b=b.getMenuChisel())&&b.getStump();c.setStumpCss(a);d.setStumpCss(a);f.setStumpCss(a);e.forceRepaint();e=e.getDocumentSize();b&&b.setStumpCss(a);f.setStumpCss(a);a=e.width;e=e.height;b&&b.setStumpCss({width:a});f.setStumpCss({"min-height":"100%","min-width":"100%",width:a,height:e});f={"min-height":e-
60+"px","min-width":a+"px"};d.setStumpCss(f);c.setStumpCss(f)};AbstractProgramChisel.prototype.chiselDidMount=function(){this._makeSelectable();this._makeBlocksMoveableAndResizableAndEditable();this._fixBigBug()};
AbstractProgramChisel.prototype._makeSelectable=function(){var a=this.getApp(),b=this.getStump().getShadow(),c=a.getWillowDocument();b.onShadowEvent(ShadowEvents.click,function(a){a.target===b.getShadowElement()&&c.blurFocusedInput()});b.makeSelectable({cancel:".BlockChisel",distance:10,filter:".BlockChisel",start:function(b){b.shiftKey?c.findStumpsWithClass("ui-selected").forEach(function(a){return a.addClassToStump("StaySelected")}):a.clearSelectionCommand()},stop:function(){c.findStumpsWithClass("StaySelected").forEach(function(a){return a.addClassToStump("ui-selected").removeClassFromStump("StaySelected")});
a.selectBlocksByShadowClassCommand();return!0}})};AbstractProgramChisel.prototype.getProgramStats=function(){var a=this.getProgramBlocks(),b=a.map(function(a){return a.getBlockErrorCount()}).reduce(function(a,b){return a+b},0);return{blocks:a.length,errorCount:b,url:this.getFileName()}};AbstractProgramChisel.prototype.shouldChiselMount=function(){return AbstractChisel.prototype.shouldChiselMount.call(this)&&this.getParent().getMountedProgram()===this};
AbstractProgramChisel.prototype._makeBlocksMoveableAndResizableAndEditable=function(){var a=this.getApp(),b=a.getWillowDocument(),c=this,d=this.getGridSize();this.getStump().getShadow().onShadowEvent(ShadowEvents.mouseover,".BlockChisel",function(e){e=b.getStumpFromElement(this);var f=e.getShadow();if(f.isShadowResizable())return!0;c._makeGroupDraggable(e,[d,d]);f.makeResizable({handles:"se",grid:d,resize:function(a){a.stopPropagation();a.preventDefault();return!1},stop:function(){return a.getMountedProgram()._updateCustomPointWithWidthAndHeight()}})})};
AbstractProgramChisel.prototype.getContextMenuCommandsBray=function(){return"@ a\n data-onClickCommand app saveProgramAndNotifyCommand\n bern Save Program\n@ a\n data-onClickCommand app showTabRenamePromptCommand\n bern Rename program\n@ a\n data-onClickCommand app showDeleteFileConfirmDialogCommand\n bern Delete program\n@ a\n tabindex -1\n data-onClickCommand app saveCompiledCommand\n bern Save compiled '"+this.compilesTo()+"' file"};
AbstractProgramChisel.prototype.getBray=function(){return"@ div\n class AbstractProgramChisel "+this.constructor.name+"\n data-onContextMenuCommand chisel _openProgramContextMenuCommand\n data-onDblClickCommand app insertMorphBlockCommand"};AbstractProgramChisel.prototype._openProgramContextMenuCommand=function(){return this.getApp().toggleAndRender("programContextMenu")};AbstractProgramChisel.prototype._getSelectedBlockStumps=function(){return this.getApp().getWillowDocument().findStumpsWithClass("ui-selected")};
AbstractProgramChisel.prototype._updateSelectedOnMove=function(a,b){var c=this._getSelectedBlockStumps();c.length&&c.filter(function(b){return b!==a}).forEach(function(a){var c=parseFloat(a.getStumpCss("top")),d=parseFloat(a.getStumpCss("left"));a.setStumpCss({transform:"",top:c+b.top+"px",left:d+b.left+"px"})})};
AbstractProgramChisel.prototype._makeGroupDraggable=function(a,b){if(a.stumpHasClass("draggable"))return!0;var c,d=this,e=this.getApp(),f={stop:function(b,f){a.removeClassFromStump("noTransition");a.setStumpAttr("data-translate","undefined undefined");b=d._getPinChangeInPixels(f,c);d._updateSelectedOnMove(a,b);c=f;e.getMountedProgram()._updateCustomPoint()},handle:".BlockGrabber",drag:function(b,e){if(a.stumpHasClass("ui-selected")){var f=d._getPinChangeInPixels(e,c);d._getSelectedBlockStumps().filter(function(b){return b!==
a}).forEach(function(a){return a.setStumpCss({transform:"translate("+f.left+"px, "+f.top+"px)"})})}},start:function(b,d){c=d.offset;a.addClassToStump("noTransition");if(b=a.getStumpAttr("data-translate"))parseInt(b.split(" ")[0]),parseInt(b.split(" ")[1])}};b&&(f.grid=b);a.addClassToStump("draggable").getShadow().makeDraggable(f)};window.AbstractProgramChisel=AbstractProgramChisel;var AbstractCard=function(a,b){a=void 0===a?{}:a;this._puid=this._getUniqueId();this._sourceObject=a;this._binder=b};
AbstractCard.prototype._getUniqueId=function(){void 0===AbstractCard._uniqueId&&(AbstractCard._uniqueId=0);AbstractCard._uniqueId++;return AbstractCard._uniqueId};AbstractCard.prototype.destroy=function(){};AbstractCard.prototype._getCardBinder=function(){return this._binder};AbstractCard.prototype.getCardApp=function(){return this.getCardBlock().getApp()};AbstractCard.prototype.getCardBlock=function(){return this._getCardBinder().getBinderOwner()};AbstractCard.prototype.destroyCardCommand=function(){return Promise.resolve()};
AbstractCard.prototype.getCardSourceAsObject=function(){return this.getCardSource()};AbstractCard.prototype.getAsArray=function(a){var b=this.getCardNumeric();return a.map(function(a){return b[a]})};AbstractCard.prototype.getCardSource=function(){return this._sourceObject};
AbstractCard.prototype._parseNumeric=function(){var a=this,b=this._getCardBinder().getColumnsMap(),c={};Object.keys(b).forEach(function(d){var e=b[d],f=a.getCardValue(d);void 0===f&&(f="");c[d]=""===f?"":e.getType().fromStringToNumeric(f)});return c};AbstractCard.prototype.getCardNumeric=function(){this._numeric||(this._numeric=this._parseNumeric());return this._numeric};AbstractCard.prototype.getCardKeys=function(){return Object.keys(this.getCardSource())};AbstractCard.prototype.getFirstCell=function(){return this.getCardValue(this.getCardKeys()[0])};
AbstractCard.prototype.getCardValue=function(a){a=this.getCardSource()[a];return null===a?"":a};AbstractCard.prototype.setCardValue=function(a,b){this.getCardSource()[a]=b;return this};AbstractCard.prototype.reloadFromStr=function(a){var b=this.getCardSource();Object.keys(b).forEach(function(a){return delete b[a]});var c=JSON.parse(a);Object.keys(c).forEach(function(a){return b[a]=c[a]})};AbstractCard.prototype.deleteFromCard=function(a){delete this.getCardSource()[a];return this};
AbstractCard.prototype.getPuid=function(){return this._puid};AbstractCard.prototype.renameCardCol=function(a,b){var c=this.getCardSource();c[b]=c[a];delete c[a];return this};AbstractCard.prototype.cardToString=function(){return JSON.stringify(this.getCardSource(),null,2)};window.AbstractCard=AbstractCard;
var Binder=function(a,b,c,d){a=void 0===a?new TreeNotation:a;b=void 0===b?[]:b;c=void 0===c?[]:c;d=void 0===d?AbstractCard:d;var e=this;this._parentNode=a;this._cards=b.map(function(a){return a instanceof AbstractCard?a:new d(a,e)});var f={};this._columnsMap=f;c.concat(this._getDetectedColumns()).forEach(function(a){var b=e._getColumnTextVector(a.name);f[a.name]=new Column(a,b)});this._ctime=this.getBinderOwner()._getNow();this._addRanks()};Binder.prototype.getCards=function(){return this._cards};
Binder.prototype.getFirstColumnAsString=function(){return this.getCards().map(function(a){return a.getFirstCell()}).join("")};Binder.prototype.getFirstCard=function(){return this.getCards()[0]};Binder.prototype._getColumnTextVector=function(a){return this.getCards().map(function(b){return b.getCardValue(a)})};Binder.prototype.getColumnNumericVector=function(a){return this.getCards().map(function(b){return b.getCardNumeric()[a]})};
Binder.prototype._getUnionSample=function(){var a={};this.getSampleSet().forEach(function(b){b.getCardKeys().forEach(function(c){if(c){var d=a[c];if(void 0===d||""===d)a[c]=b.getCardValue(c)}})});return a};Binder.prototype.getColumnsByImportance=function(){var a=this.getColumnsArray();a.sort(Util.sortByAccessor(function(a){return a.getRank()}));return a};Binder.prototype.getSampleSet=function(){this._sampleSet||(this._sampleSet=lodash.sampleSize(this.getCards(),30));return this._sampleSet};
Binder.prototype.getCardCount=function(){return this.getCards().length};Binder.prototype.getCardSources=function(){return this.getCards().map(function(a){return a.getCardSource()})};Binder.prototype.getColumnNames=function(){return Object.keys(this.getColumnsMap())};Binder.prototype.getColumnsMap=function(){return this._columnsMap};Binder.prototype.getCTime=function(){return this._ctime};Binder.prototype.getColumnsArray=function(){return Object.values(this.getColumnsMap())};
Binder.prototype.getColumnsArrayOfObjects=function(){return this.getColumnsArray().map(function(a){return a.toObject()})};Binder.prototype.getNumericValues=function(){return this.getCards().map(function(a){return a.getCardNumeric()})};Binder.prototype.getBinderColumnByName=function(a){return this.getColumnsMap()[a]};Binder.prototype._getDetectedColumns=function(){var a=this.getColumnsMap();return Object.keys(this._getUnionSample()).map(function(a){return a.trim()}).filter(function(a){return a}).filter(function(b){return!a[b]}).map(function(a){return{name:a}})};
Binder.prototype.getBinderOwner=function(){return this._parentNode};Binder.prototype.getCardTypeName=function(){return"Card"};Binder.prototype.toTypeScriptInterface=function(){var a=this.getColumnsArray().map(function(a){return"  "+a.getColumnName()+": "+a.getTypeName()+";"}).join("\n");return"interface "+this.getCardTypeName()+" {\n"+a+"\n}"};Binder.prototype.toBlankFormTemplate=function(){var a=this.getColumnNames().join(" \n");return(new TreeNotation(a?a+" ":a)).toString()};
Binder.prototype.getSortedCards=function(a){if(!a)return this.getCards();var b=this.getCards().map(function(a){return a});Util.sortByFast(b,a);return b};Binder.prototype.getSortedCardsWithLimit=function(a,b){return this.getSortedCards(a).slice(0,b)};Binder.prototype.toDelimited=function(a){return(new TreeNotation(this.getCardSources())).toDelimited(a,this.getColumnNames())};
Binder.prototype._addRanks=function(){var a=this.getColumnsMap(),b=Object.keys(a).map(function(b){return a[b]});b.sort(function(a,b){if(a.getTitlePotential()>b.getTitlePotential())return-1;if(b.getTitlePotential()>a.getTitlePotential())return 1;if(.5<a.getMissingDataPercentage()||.5<b.getMissingDataPercentage()){if(a.getMissingDataPercentage()>b.getMissingDataPercentage())return 1;if(b.getMissingDataPercentage()>a.getMissingDataPercentage())return-1}return a.isTemporal()&&!b.isTemporal()?-1:!a.isTemporal()&&
b.isTemporal()||a.isLink()&&!b.isLink()?1:!a.isLink()&&b.isLink()?-1:a.isString()&&!b.isString()?1:!a.isString()&&b.isString()?-1:a.isString()&&b.isString()?4<a.getEntropy()&&8>a.getEntropy()&&a.getEntropy()>b.getEntropy()?-1:a.getEstimatedTextLength()>b.getEstimatedTextLength()?1:-1:0});b.forEach(function(a,b){a.setRank(b)});return this};window.Binder=Binder;var AbstractCardParser=function(){};AbstractCardParser.prototype.getProbForCardSpecimen=function(){return 0};
AbstractCardParser.prototype.isNode=function(){return"undefined"!==typeof exports};var AbstractTreeCardParser=function(a){AbstractCardParser.apply(this,arguments)};$jscomp.inherits(AbstractTreeCardParser,AbstractCardParser);AbstractTreeCardParser.prototype.parse=function(a){return this.parseTrees(a).getChildren().filter(function(a){return a.length}).map(function(a){return a.toObject()})};var DelimitedParser=function(a){AbstractTreeCardParser.apply(this,arguments)};
$jscomp.inherits(DelimitedParser,AbstractTreeCardParser);DelimitedParser.prototype.getExample=function(){return"john~12~50\nmary~13~43"};DelimitedParser.prototype.parseTrees=function(a,b,c,d){return TreeNotation.fromDelimited(a,b,c,d)};DelimitedParser.prototype.getFormatName=function(){return"delimited"};var CsvParser=function(a){AbstractTreeCardParser.apply(this,arguments)};$jscomp.inherits(CsvParser,AbstractTreeCardParser);CsvParser.prototype.getExample=function(){return"name,age,height\njohn,12,50"};
CsvParser.prototype.parseTrees=function(a){return TreeNotation.fromCsv(a)};CsvParser.prototype.getProbForCardSpecimen=function(a){return a.firstLineCommaCount?a.blankLineCount?.05:.49:0};CsvParser.prototype.getFormatName=function(){return"csv"};var TsvParser=function(a){AbstractTreeCardParser.apply(this,arguments)};$jscomp.inherits(TsvParser,AbstractTreeCardParser);TsvParser.prototype.getExample=function(){return"name\tage\theight\njohn\t12\t50"};TsvParser.prototype.parseTrees=function(a){return TreeNotation.fromTsv(a)};
TsvParser.prototype.getProbForCardSpecimen=function(a){return a.firstLineTabCount?5<a.tabCount?.9:.25:0};TsvParser.prototype.getFormatName=function(){return"tsv"};var PsvParser=function(a){AbstractTreeCardParser.apply(this,arguments)};$jscomp.inherits(PsvParser,AbstractTreeCardParser);PsvParser.prototype.getFormatName=function(){return"psv"};PsvParser.prototype.getExample=function(){return"name|age\nmike|33"};PsvParser.prototype.parseTrees=function(a){return TreeNotation.fromDelimited(a,"|")};
PsvParser.prototype.getProbForCardSpecimen=function(a){return a.firstLineVerticalBarCount?a.verticalBarCount>=a.lineCount?.8:.01:0};var SsvParser=function(a){AbstractTreeCardParser.apply(this,arguments)};$jscomp.inherits(SsvParser,AbstractTreeCardParser);SsvParser.prototype.getExample=function(){return"name age height\njohn 12 50"};SsvParser.prototype.getFormatName=function(){return"ssv"};SsvParser.prototype.parseTrees=function(a){return TreeNotation.fromSsv(a)};
SsvParser.prototype.getProbForCardSpecimen=function(a){return a.firstLineSpaceCount?a.blankLineCount?.05:.11:0};var XmlParser=function(a){AbstractTreeCardParser.apply(this,arguments)};$jscomp.inherits(XmlParser,AbstractTreeCardParser);XmlParser.prototype.getProbForCardSpecimen=function(a){return a.trimmedStr.match(/^ *\</)?1:0};XmlParser.prototype.getExample=function(){return"<person>\n <name>bob</name><age>32</age></person>"};XmlParser.prototype.getFormatName=function(){return"xml"};
XmlParser.prototype.parseTrees=function(a){return this.isNode()?new TreeNotation(a):TreeNotation.fromXml(a)};var HtmlParser=function(a){AbstractTreeCardParser.apply(this,arguments)};$jscomp.inherits(HtmlParser,AbstractTreeCardParser);HtmlParser.prototype.getProbForCardSpecimen=function(a){return a.trimmedStr.match(/^(\<\!doctype html\>|\<html|\<div)/i)?1:0};HtmlParser.prototype.getExample=function(){return"<!doctype html>\n<html>\n <head>bam</head></html>"};HtmlParser.prototype.getFormatName=function(){return"html"};
HtmlParser.prototype.parseTrees=function(a){return this.isNode()?new TreeNotation(a):TreeNotation.fromXml(a)};var SpacedParser=function(a){AbstractCardParser.apply(this,arguments)};$jscomp.inherits(SpacedParser,AbstractCardParser);SpacedParser.prototype.getExample=function(){return"name john\nage 12\n\nname mary\nage 20"};SpacedParser.prototype.getFormatName=function(){return"spaced"};SpacedParser.prototype.getProbForCardSpecimen=function(a){return 10<a.blankLineCount?.95:.05};
SpacedParser.prototype.parse=function(a){var b=a.indexOf("\n\n"),c=a.substr(0,b).split(/\n/g),d=a.substr(b+2).replace(/\n\n/g,"\n").trim().split("\n");a=c.length;for(var b=d.length,e=[],c=c.map(function(a){return a.replace(/ /g,"")}),f={lineNumber:0};f.lineNumber<b;f={obj:f.obj,lineNumber:f.lineNumber},f.lineNumber+=a)f.obj={},c.forEach(function(a){return function(b,c){a.obj[b]=d[a.lineNumber+c].trim()}}(f)),e.push(f.obj);return e};var TreeParser=function(a){AbstractTreeCardParser.apply(this,arguments)};
$jscomp.inherits(TreeParser,AbstractTreeCardParser);TreeParser.prototype.getExample=function(){return"person\n name john\n age 12\n height 50"};TreeParser.prototype.parseTrees=function(a){a=a instanceof TreeNotation?a:new TreeNotation(a);var b=a.getChildren().filter(function(a){return a.getBeam()}).length,c=a.getChildren().filter(function(a){return 0===a.length}).length;if(!b&&!c)return a;b=new TreeNotation;b.pushBeamAndChildren(void 0,a);return b};
TreeParser.prototype.getProbForCardSpecimen=function(a){return 1>a.indentedLineCount?0:.1};TreeParser.prototype.getFormatName=function(){return"tree"};var SectionsParser=function(a){AbstractCardParser.apply(this,arguments)};$jscomp.inherits(SectionsParser,AbstractCardParser);SectionsParser.prototype.getExample=function(){return"name\nage\n\njohn\n12\n\nmary\n20"};SectionsParser.prototype.getFormatName=function(){return"sections"};
SectionsParser.prototype.parse=function(a){var b=a.indexOf("\n\n"),c=[a.slice(0,b),a.slice(b+1)];a=c.shift().split(/\n/g);for(var b=a.length,c=c[0].trim().split(/\n/g),d=c.length/b,e=[],f={},g=0;g<d;f={obj:f.obj,values:f.values},g++){var h=g*b;f.values=c.slice(h,h+b);f.obj={};a.forEach(function(a){return function(b,c){return a.obj[b]=a.values[c]}}(f));e.push(f.obj)}return e};var ListParser=function(a){AbstractCardParser.apply(this,arguments)};$jscomp.inherits(ListParser,AbstractCardParser);
ListParser.prototype.getExample=function(){return"john doe\nfrank jones"};ListParser.prototype.getFormatName=function(){return"list"};ListParser.prototype.parse=function(a){return a.split(/\n/g).map(function(a,c){return{index:c,name:a}})};var TextParser=function(a){AbstractCardParser.apply(this,arguments)};$jscomp.inherits(TextParser,AbstractCardParser);TextParser.prototype.getFormatName=function(){return"text"};TextParser.prototype.getExample=function(){return"hello world"};
TextParser.prototype.getProbForCardSpecimen=function(a){return a.blankLineCount?.12:.05};TextParser.prototype.parse=function(a){return[{text:a}]};var AbstractJsonParser=function(a){AbstractCardParser.apply(this,arguments)};$jscomp.inherits(AbstractJsonParser,AbstractCardParser);AbstractJsonParser.prototype.getFormatName=function(){return"json"};AbstractJsonParser.prototype.getExample=function(){return JSON.stringify([{name:"joe",age:2},{name:"mike",age:4}])};
AbstractJsonParser.prototype.parse=function(a){a=JSON.parse(a);return a instanceof Array?a:[a]};var JsonParser=function(a){AbstractJsonParser.apply(this,arguments)};$jscomp.inherits(JsonParser,AbstractJsonParser);var AbstractJsonArrayParser=function(a){AbstractJsonParser.apply(this,arguments)};$jscomp.inherits(AbstractJsonArrayParser,AbstractJsonParser);AbstractJsonArrayParser.prototype.getExample=function(){return JSON.stringify([{name:"jane",age:33},{name:"bill",age:25}])};
AbstractJsonArrayParser.prototype.getProbForCardSpecimen=function(a){a=a.trimmedStr;return a.match(/^\s*\[/)&&a.match(/\]\s*$/)?.99:0};var JsonArrayParser=function(a){AbstractJsonArrayParser.apply(this,arguments)};$jscomp.inherits(JsonArrayParser,AbstractJsonArrayParser);var AbstractJsonObjectParser=function(a){AbstractJsonParser.apply(this,arguments)};$jscomp.inherits(AbstractJsonObjectParser,AbstractJsonParser);
AbstractJsonObjectParser.prototype.getProbForCardSpecimen=function(a){a=a.trimmedStr;return a.match(/^\s*\{/)&&a.match(/\}\s*$/)?.99:0};var JsonObjectParser=function(a){AbstractJsonObjectParser.apply(this,arguments)};$jscomp.inherits(JsonObjectParser,AbstractJsonObjectParser);var JsonMapParser=function(a){AbstractJsonObjectParser.apply(this,arguments)};$jscomp.inherits(JsonMapParser,AbstractJsonObjectParser);
JsonMapParser.prototype.getExample=function(){return JSON.stringify({person1:{name:"joe",age:2},person2:{name:"mike",age:4}})};JsonMapParser.prototype.getFormatName=function(){return"jsonMap"};JsonMapParser.prototype.parse=function(a){return Object.values(JSON.parse(a))};var JsonVectorParser=function(a){AbstractJsonArrayParser.apply(this,arguments)};$jscomp.inherits(JsonVectorParser,AbstractJsonArrayParser);JsonVectorParser.prototype.getExample=function(){return JSON.stringify([23,32,41])};
JsonVectorParser.prototype.getFormatName=function(){return"jsonVector"};JsonVectorParser.prototype.getProbForCardSpecimen=function(a){a=a.trimmedStr;try{var b=JSON.parse(a);return b instanceof Array?0===b.filter(function(a){return a&&"object"===typeof a&&a.hasOwnProperty}).length:0}catch(c){}return 0};JsonVectorParser.prototype.parse=function(a){return JSON.parse(a).map(function(a){return{value:a}})};var JsonCountMapParser=function(a){AbstractJsonObjectParser.apply(this,arguments)};
$jscomp.inherits(JsonCountMapParser,AbstractJsonObjectParser);JsonCountMapParser.prototype.getFormatName=function(){return"jsonCounts"};JsonCountMapParser.prototype.getProbForCardSpecimen=function(a){a=a.trimmedStr;try{var b=JSON.parse(a),c=Object.keys(b);return 2>c.length?0:c.some(function(a){return"number"!==typeof b[a]})?0:1}catch(d){}return 0};JsonCountMapParser.prototype.getExample=function(){return JSON.stringify({h1:10,h2:5,h3:2})};
JsonCountMapParser.prototype.parse=function(a){var b=JSON.parse(a);return Object.keys(b).map(function(a){return{name:a,count:b[a]}})};
var CardParser=function(){var a=this;this._parsers=[new CsvParser,new TsvParser,new SsvParser,new PsvParser,new TextParser,new TreeParser,new XmlParser,new HtmlParser,new SectionsParser,new SpacedParser,new ListParser,new JsonParser,new JsonArrayParser,new JsonVectorParser,new JsonMapParser,new JsonCountMapParser];this._parserMap={};this._parsers.forEach(function(b){var c=b.getFormatName();c&&(a._parserMap[c]=b)})};CardParser.prototype.getAllParsers=function(){return this._getParsersArray()};
CardParser.prototype.getEncodingNames=function(){return Object.keys(this._getParserMap())};CardParser.prototype.getExample=function(a){return this._getParser(a).getExample()};CardParser.prototype._getParser=function(a){var b=this._getParserMap();return b[a]||b.text};CardParser.prototype._getParserMap=function(){return this._parserMap};CardParser.prototype._getParsersArray=function(){return this._parsers};
CardParser.prototype.parseFromObject=function(a,b){return a instanceof Array?"object"===typeof a[0]?a:a.map(function(a){return"object"===typeof a?a:{value:a}}):"jsonMap"===b?Object.values(a):[a]};CardParser.prototype.parse=function(a,b){a=(void 0===a?"":a).trim();if(!a)return[];b=b||this.inferEncoding(a);return this._getParser(b).parse(a)};CardParser.prototype.parseAdvancedDelimited=function(a,b,c,d){return this._getParser("delimited").parse(a,b,c,d)};
CardParser.prototype.getProbabilities=function(a){var b=this._getParsersArray(),c={};a=new CardStringSpecimen(a);for(var d=0;d<b.length;d++){var e=b[d],f=e.getProbForCardSpecimen(a),e=e.getFormatName();if(1===f)return b={},b[e]=1,b;c[e]=f}return c};CardParser.prototype.inferEncoding=function(a){a=this.getProbabilities(a);var b=0,c=null,d;for(d in a)a[d]>b&&(b=a[d],c=d);return c};window.CardParser=CardParser;
var CardStringSpecimen=function(a){a=a.trim();var b=a.split(/\n/g),c=b[0],d=function(a,b){return(a.match(b)||[]).length};this.trimmedStr=a;this.lines=b;this.firstLine=c;this.lineCount=b.length;this.indentedLineCount=d(a,/\n /g);this.blankLineCount=d(a,/\n\n/g);this.commaCount=d(a,/\,/g);this.tabCount=d(a,/\t/g);this.verticalBarCount=d(a,/\|/g);this.firstLineCommaCount=d(c,/\,/g);this.firstLineTabCount=d(c,/\t/g);this.firstLineSpaceCount=d(c,/ /g);this.firstLineVerticalBarCount=d(c,/\|/g)};
window.CardStringSpecimen=CardStringSpecimen;var ObjectBackedCard=function(a){AbstractCard.apply(this,arguments)};$jscomp.inherits(ObjectBackedCard,AbstractCard);ObjectBackedCard._uniqueId=AbstractCard._uniqueId;window.ObjectBackedCard=ObjectBackedCard;var PivotTable=function(a,b,c){this._cards=a;var d={};b.forEach(function(a){return d[a.name]=a});c.forEach(function(a){return d[a.name]=a});this._columns=d};
PivotTable.prototype._getGroups=function(a,b){var c=new Map;a.forEach(function(a){var d=b.map(function(b){return a[b].toString().replace(/ /g,"")}).join(" ");d&&(c.has(d)||c.set(d,[]),c.get(d).push(a))});return c};
PivotTable.prototype.getNewCards=function(a){var b=this,c=this._getGroups(this._cards,a),d=[{name:"count",type:"number",min:0}];a.forEach(function(a){return d.push(b._columns[a])});var e=Object.values(this._columns).filter(function(a){return!!a.reduction});e.forEach(function(a){return d.push(a)});for(var f=[],g={},c=$jscomp.makeIterator(c),h=c.next();!h.done;g={newCard:g.newCard,firstCard:g.firstCard,group:g.group},h=c.next())h=$jscomp.makeIterator(h.value),h.next(),g.group=h.next().value,g.firstCard=
g.group[0],g.newCard={},a.forEach(function(a){return function(b){a.newCard[b]=a.firstCard?a.firstCard[b]:0}}(g)),g.newCard.count=g.group.length,e.forEach(function(a){return function(b){var c=b.name,d=a.group.map(function(a){return a[c]}).filter(function(a){return"number"===typeof a&&!isNaN(a)});b=b.reduction;var e=a.firstCard[c];"sum"===b&&(e=d.reduce(function(a,b){return a+b},0));"avg"===b&&(e=d.reduce(function(a,b){return a+b},0)/d.length);a.newCard[c]=e}}(g)),f.push(g.newCard);return{cards:f,columns:d}};
window.PivotTable=PivotTable;
var TableSpecimen=function(a,b){this.colCount=a.length;this.cardCount=b.length;this.primaryKey=this.timeseries=!1;this.nounType="thing";this.nounClasses="someGeneralThing someMoreSpecificThing";this.hasNominalCol=this.hasDateCol=this.hasNumericCol=!1;this.cardNounType="";this.hasSubNounColumn=!1;this.subNounColumns=[];this.correlationMatrx=[];this.mostImportantColumns=[];this.hasSlice=this.hasFrequencyColumn=this.hasRankColumn=this.isOrderImportant=!1;this.cohesivity=1;this.isPair=!1};
window.TableSpecimen=TableSpecimen;var TreeBackedCard=function(a){AbstractCard.apply(this,arguments)};$jscomp.inherits(TreeBackedCard,AbstractCard);TreeBackedCard._uniqueId=AbstractCard._uniqueId;TreeBackedCard.prototype.getCardId=function(){return this.getCardSource().getBase()};TreeBackedCard.prototype.destroy=function(){this.getCardSource().destroy();return AbstractCard.prototype.destroy.call(this)};TreeBackedCard.prototype.getCardSourceAsObject=function(){return this.getCardSource().toObject()};
TreeBackedCard.prototype.renameCardCol=function(a,b){return this.getCardSource().rename(a,b)};TreeBackedCard.prototype.reloadFromStr=function(a){return this.getCardSource().setChildren(a)};TreeBackedCard.prototype.setCardValue=function(a,b){this.getCardSource().touchNode(a).setBeam(b);return this};TreeBackedCard.prototype.getCardKeys=function(){return this.getCardSource().getBases()};TreeBackedCard.prototype.deleteFromCard=function(a){return this.getCardSource().delete(a)};
TreeBackedCard.prototype.cardToString=function(){return this.getCardSource().childrenToString()};TreeBackedCard.prototype.getCardValue=function(a){return this.getCardSource().findBeam(a)||""};window.TreeBackedCard=TreeBackedCard;var AbstractBlockChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractBlockChisel,AbstractChisel);AbstractBlockChisel._mountedChisels=AbstractChisel._mountedChisels;
AbstractBlockChisel.prototype.getStruct=function(){this._struct||(this._struct=this.getDefinition().computeStruct(this));return this._struct};AbstractBlockChisel.prototype._clearBlockStruct=function(){delete this._struct};AbstractBlockChisel.prototype.getInputBinder=function(){return this.getParent().getOutputBinder()};AbstractBlockChisel.prototype.getOutputBinder=function(){if(!this.isProvider())return this.getInputBinder();this._outputBinder||(this._outputBinder=new Binder(this));return this._outputBinder};
AbstractBlockChisel.prototype.isProvider=function(){return!1};AbstractBlockChisel.prototype.parseNodeType=function(a){return this.getDictionary().parseNodeTypeFromDictionary(this,a)||OtherTuple};AbstractBlockChisel.prototype.getProgram=function(){return this.getParent().getProgram()};AbstractBlockChisel.prototype.getChildBlocks=function(){return this.getChildrenByNodeType(AbstractBlockChisel)};AbstractBlockChisel.prototype.getHierarchy=function(){return{node:this,children:this.getChildBlocks().map(function(a){return a.getHierarchy()})}};
AbstractBlockChisel.prototype.getDictionary=function(){return this.getProgram().getDictionary()};AbstractBlockChisel.prototype.isVisible=function(){return"false"!==this.findBeam("visible")};AbstractBlockChisel.prototype.selectBlock=function(){this._selected=!0;this.isMounted()&&this.getStump().addClassToStump("ui-selected")};AbstractBlockChisel.prototype.unselect=function(){delete this._selected;this.isMounted()&&this.getStump().removeClassFromStump("ui-selected")};
AbstractBlockChisel.prototype.isSelected=function(){return this._selected};
AbstractBlockChisel.prototype.getBray=function(){return"@ div\n class BlockPage BlockChisel "+this.constructor.name+"\n id "+this.getId()+"\n data-onContextMenuCommand chisel _openBlockContextMenuCommand\n @ div\n  class BlockGrabber\n @ div\n  class BlockHeader\n  bern "+this.getBlockHeaderBern()+"\n @ div\n  class BlockBody"+TreeNotation.nest(this.getBlockBodyBray(),2)+"\n @ div\n  class BlockFooter"+TreeNotation.nest(this.getBlockFooterBray(),2)+"\n @ div\n  class BlockGrabber"};
AbstractBlockChisel.prototype.getBlockHeaderBern=function(){return""+this.getBase()};AbstractBlockChisel.prototype.getBeamPatternWords=function(){var a=this.getDefinition().getBeamPattern();return a?a.split(" "):[]};AbstractBlockChisel.prototype.makeBlockDimension=function(a){a=void 0===a?this.getPin():a;a=a.split(" ").map(function(a){return 20*parseInt(a)});var b={left:a[0],top:a[1]};2<a.length&&(b.width=a[2]);3<a.length&&(b.height=a[3]);return new BlockDimension(this,b)};
AbstractBlockChisel.prototype.getBlockBodyBray=function(){return""};AbstractBlockChisel.prototype._getCss=function(){var a="#"+this.getId(),b=this.getTheme(),c=this.isVisible()?"":"display: none",d=this.getBlockDimension(),d=d?d.toCss():"";return a+" { "+c+" "+d+" }\n      "+b.hakonToCss(this.getHakon())};AbstractBlockChisel.prototype.getDefinition=function(){var a=this.getBase();return this.getDictionary().getDefinitionByName(a)};
AbstractBlockChisel.prototype.mapTupleNamesToColumnNames=function(a){var b=this.getStruct();return a.map(function(a){return b[a]})};AbstractBlockChisel.prototype.getContextMenuBray=function(){return""};AbstractBlockChisel.loadCode=function(){return Promise.resolve()};AbstractBlockChisel.prototype.getStructColumns=function(){var a=this.getNode("columns"),b=a?a.toObject():{};return Object.keys(b).map(function(a){var c=b[a]||{};"object"!==typeof c&&(c={});c.name||(c.name=a);return c})};
AbstractBlockChisel.prototype.getBlockClassColumns=function(){return[]};AbstractBlockChisel.prototype.handleBlockError=function(a){this._errorCount||(this._errorCount=0);this._errorCount++;this.getApp().goRed(a)};AbstractBlockChisel.prototype.getBlockErrorCount=function(){return this._errorCount||0};AbstractBlockChisel.prototype.isProgram=function(){return!1};AbstractBlockChisel.prototype.getLimit=function(){return this.getStruct().limit};AbstractBlockChisel.prototype.getChildNodeSuggestions=function(){return[]};
AbstractBlockChisel.prototype.getId=function(){return"block"+this._getUid()};AbstractBlockChisel.prototype.getBlockDimension=function(){var a=this.getProgram(),b=a.getProgramDimension();return a.getBlockDimensionMap(b.width,b.height).get(this)};AbstractBlockChisel.prototype.getHeaderHeight=function(){return 30};AbstractBlockChisel.prototype.getFooterHeight=function(){return 30};
AbstractBlockChisel.prototype.getBlockBodyDimension=function(){var a=this.getBlockDimension();a.height=a.height-this.getHeaderHeight()-this.getFooterHeight();return a};AbstractBlockChisel.prototype.openBlockSourceEditorModalCommand=function(){return this.getApp().setTargetNode(this).toggleAndRender("nodeEditorModal")};AbstractBlockChisel.prototype.cloneBlockCommand=function(){var a=this.getProgram();a.cloneBlock(this);return a.autosaveAndRender()};
AbstractBlockChisel.prototype._changeBlockOrderByCommand=function(a){this.toggle("orderBy",[a,"-"+a,""]);this.autosaveBlock();this.makeDirty();return this.render()};AbstractBlockChisel.prototype.getDependencyTimestamps=function(){return[]};AbstractBlockChisel.prototype.executeLoadData=function(){return Promise.resolve()};AbstractBlockChisel.prototype.executeLoadDataAndRender=function(){var a=this;return this.executeLoadData().then(function(){return a.render()})};
AbstractBlockChisel.prototype.getFirstAncestor=function(){var a=this.getParent();return a instanceof AbstractBlockChisel?a.getFirstAncestor():this};AbstractBlockChisel.prototype.changeTypeCommand=function(a){var b=this;this.setBase(a);var c=this.duplicate();this.unmountAndDestroy();return c.getDefinition().executeLoadDefinitionCodeOrGetLoadingPromise(this.getApp()).then(function(){return b.getProgram().autosaveAndRender().then(function(){return c.executeLoadDataAndRender()})})};
AbstractBlockChisel.prototype.changeParentCommand=function(a){var b=this.getProgram(),b=(a=a?a.split(" ").map(function(a){return parseInt(a)}):"")?this.getApp().nodeAt(a):b;this.copyTo(b);this.unmountAndDestroy();return this.getProgram().autosaveAndRender()};AbstractBlockChisel.prototype._openBlockContextMenuCommand=function(){return this.getApp().setTargetNode(this).toggleAndRender("blockContextMenu")};AbstractBlockChisel.prototype.destroyBlockCommand=function(){this.unmountAndDestroy();return this.getProgram().autosaveAndRender()};
AbstractBlockChisel.prototype.getNewDataCommand=function(){};AbstractBlockChisel.prototype.setMonadOrChild=function(a,b){return this.has(a)?this.touchNode(a).setBeam(b):this.getDefinition().getMonadName()!==a||b.includes("\n")?this.touchNode(a).setBeam(b):this.setBeam(b)};AbstractBlockChisel.prototype.changeTupleCommand=function(a,b){this.setMonadOrChild(b,a);this.getApp().renderApp();return this.autosaveBlock()};
AbstractBlockChisel.prototype.changeWordCommand=function(a,b){this.setWord(b,a);this.render();return this.autosaveBlock()};AbstractBlockChisel.prototype.insertSuggestionCommand=function(a){var b=this;this.append(a);this.autosaveBlock();return this.getProgram().executeLoadProgramCode().then(function(){return b.render()})};AbstractBlockChisel.prototype.copyBlockCommand=function(){this.getApp().getWillowDocument().copyTextToClipboard(this.getFirstAncestor().toString());return Promise.resolve()};
AbstractBlockChisel.prototype.getHakon=function(){return""};AbstractBlockChisel.prototype.getTheme=function(){return this.getApp().getTheme()};AbstractBlockChisel.prototype.getBlockFooterBray=function(){return this.getBlockToolbarButtonBray()};AbstractBlockChisel.prototype.getBlockToolbarButtonBray=function(){return"@ span\n class BlockPencilButton\n data-onClickCommand chisel toggleToolbarCommand\n bern "+Icons("pencil",16)};AbstractBlockChisel.prototype.openBlockInspectorCommand=function(){return this.getApp().setTargetNode(this).toggleAndRender("blockInspectorModal")};
AbstractBlockChisel.prototype.getSuggestedSize=function(){return this.getDefinition().getSuggestedSize()};AbstractBlockChisel.prototype.getPin=function(){return this.findBeam(BlockConstants.pin)};AbstractBlockChisel.prototype.getStumpForChildren=function(){return this.getStump().getParent()};AbstractBlockChisel.prototype.chiselDidMount=function(){AbstractChisel.prototype.chiselDidMount.call(this);this._blockToolbar&&this._blockToolbar.render()};
AbstractBlockChisel.prototype.autosaveBlock=function(){this._clearBlockStruct();return this.getProgram().autosaveProgram()};AbstractBlockChisel.prototype.toggleToolbarCommand=function(){this._blockToolbar=this._blockToolbar?this._blockToolbar.unmount():(new BlockToolbarChisel("",void 0,this)).render(this.getStump());return Promise.resolve()};
AbstractBlockChisel.prototype.getTypeLine=function(){var a=this.getBeamPatternWords(),b=this.getWords(1),c=a.length-1;a.forEach(function(a,d){d===c&&b.slice(d).join(" ")});var a=["instruction"].concat(a),d=a[a.length-1];if(d.endsWith("+")){d=d.replace("+","");a[a.length-1]=d;for(var e=this.getWords();e.length>a.length;)a.push(d)}return a.join(" ")};
AbstractBlockChisel.prototype.getInspection=function(){var a=this.getMessageBuffer().getChildren().map(function(a){return"@ li\n bern "+moment(a.getMTime()).fromNow()+" - "+a.childrenToString()}),b=this.getDefinition().getDefinitionTuples().map(function(a){return a.getTupleName()+" "+a.getTupleTypeName()+" "+a.getDescription()}).join("\n"),c=this.getStruct(),d=this.getParent().getBase();return"@ div\n bern BlockClass: "+this.constructor.name+" Parent: "+d+"\n@ div\n bern Messages:\n@ ol\n "+a+"\n@ div\n bern Tree:\n@ pre\n bern"+
TreeNotation.nest(this.toString(),2)+"\n@ div\n bern BlockStruct:\n@ pre\n bern"+TreeNotation.nest(JSON.stringify(c,null,2),2)+"\n@ div\n bern All Block Tuples:\n@ pre\n bern"+TreeNotation.nest(b,2)};window.AbstractBlockChisel=AbstractBlockChisel;var BinPacker=function(){};
BinPacker.prototype.fit=function(a){var b=a.length;this.root={xcc:0,ycc:0,width:0<b?a[0].width:0,height:0<b?a[0].height:0};for(var c=0;c<b;c++){var d=a[c],e=this.findNode(this.root,d.width,d.height);d.fit=e?this.splitNode(e,d.width,d.height):this.growNode(d.width,d.height)}};BinPacker.prototype.findNode=function(a,b,c){return a.used?this.findNode(a.right,b,c)||this.findNode(a.down,b,c):b<=a.width&&c<=a.height?a:null};
BinPacker.prototype.splitNode=function(a,b,c){a.used=!0;a.down={xcc:a.xcc,ycc:a.ycc+c,width:a.width,height:a.height-c};a.right={xcc:a.xcc+b,ycc:a.ycc,width:a.width-b,height:c};return a};BinPacker.prototype.growNode=function(a,b){var c=this.root,d=a<=c.width,e=b<=c.height,f=d&&c.width>=c.height+b;return e&&c.height>=c.width+a?this.growRight(a,b):f?this.growDown(a,b):e?this.growRight(a,b):d?this.growDown(a,b):null};
BinPacker.prototype.growRight=function(a,b){var c=this.root;this.root={used:!0,xcc:0,ycc:0,width:c.width+a,height:c.height,down:c,right:{xcc:c.width,ycc:0,width:a,height:c.height}};return(c=this.findNode(this.root,a,b))?this.splitNode(c,a,b):null};BinPacker.prototype.growDown=function(a,b){var c=this.root;this.root={used:!0,xcc:0,ycc:0,width:c.width,height:c.height+b,down:{xcc:0,ycc:c.height,width:c.width,height:b},right:c};return(c=this.findNode(this.root,a,b))?this.splitNode(c,a,b):null};
window.BinPacker=BinPacker;var BlankLine=function(a){return AbstractBlockChisel.apply(this,arguments)||this};$jscomp.inherits(BlankLine,AbstractBlockChisel);BlankLine._mountedChisels=AbstractBlockChisel._mountedChisels;BlankLine.loadCode=AbstractBlockChisel.loadCode;window.BlankLine=BlankLine;var BlockConstants={pin:"pin",percentage:"percentage"};window.BlockConstants=BlockConstants;
var BlockDimension=function(a,b){a=a.getSuggestedSize();this.width=a.width;this.height=a.height;Object.assign(this,b)};BlockDimension.prototype.getScaledCss=function(a){a=void 0===a?1:a;return this._toCss({width:this.width*a,height:this.height*a,left:this.left*a,top:this.top*a})};BlockDimension.prototype.toCss=function(){return this._toCss(this)};BlockDimension.prototype._toCss=function(a){return"width: "+a.width+"px; height: "+a.height+"px; left: "+a.left+"px; top: "+a.top+"px"};
window.BlockDimension=BlockDimension;var DidYouMeanBlock=function(a){return AbstractBlockChisel.apply(this,arguments)||this};$jscomp.inherits(DidYouMeanBlock,AbstractBlockChisel);DidYouMeanBlock._mountedChisels=AbstractBlockChisel._mountedChisels;DidYouMeanBlock.loadCode=AbstractBlockChisel.loadCode;
DidYouMeanBlock.prototype.getBlockBodyBray=function(){var a=this.getBase(),b=this.getDictionary().getBlockNames();return(b=didYouMean(a,b))?"@ div\n bern No block '"+a+"' found. Did you mean\n @! a\n  bern "+b+"\n  tabindex -1\n  value "+b+"\n  data-onClickCommand chisel changeTypeCommand\n bern ?":"@ div\n bern No block '"+a+"' found."};DidYouMeanBlock.prototype.getParseErrorCount=function(){return this.getTopDownArray().length};DidYouMeanBlock.prototype.getBlockHeaderBern=function(){return""};
window.DidYouMeanBlock=DidYouMeanBlock;var AbstractLayoutStrategy=function(a,b,c){this._program=a;this._width=void 0===b?1400:b;this._height=void 0===c?1400:c};AbstractLayoutStrategy.prototype._getBlocks=function(){return this._getProgram().getProgramBlocks().filter(function(a){return a.isVisible()})};AbstractLayoutStrategy.prototype._getProgram=function(){return this._program};AbstractLayoutStrategy.prototype._getLayoutBoxWidth=function(){return this._width};
AbstractLayoutStrategy.prototype._getLayoutBoxHeight=function(){return this._height};var CustomLayout=function(a){AbstractLayoutStrategy.apply(this,arguments)};$jscomp.inherits(CustomLayout,AbstractLayoutStrategy);CustomLayout.prototype.makeBlockDimensionMap=function(){var a=this._getBlocks(),b=[],c=new Map;a.forEach(function(a,d){if(!a.getPin())return b.push(a);c.set(a,a.makeBlockDimension())});var d=0;b.forEach(function(a,b){b=a.makeBlockDimension("0 "+d);c.set(a,b);d+=b.height/20});return c};
var TreeLayout=function(a){AbstractLayoutStrategy.apply(this,arguments)};$jscomp.inherits(TreeLayout,AbstractLayoutStrategy);TreeLayout.prototype.makeBlockDimensionMap=function(){var a=this._getProgram().getHierarchy(),a=d3.hierarchy(a),b=d3.tree().size([.8*this._getLayoutBoxWidth(),.8*this._getLayoutBoxHeight()]),c=new Map;b(a).descendants().forEach(function(a){var b=a.data.node;b.isProgram()||(a=new BlockDimension(b,{width:80,height:80,left:a.x,top:a.y}),c.set(b,a))});return c};
var ColumnLayout=function(a){AbstractLayoutStrategy.apply(this,arguments)};$jscomp.inherits(ColumnLayout,AbstractLayoutStrategy);ColumnLayout.prototype.makeBlockDimensionMap=function(){var a=0,b=Math.floor((this._getLayoutBoxWidth()-800)/2),c=new Map;this._getBlocks().forEach(function(d){var e=d.getSuggestedSize(),f=new BlockDimension(d,{width:800,height:e.height,left:b,top:a});c.set(d,f);a+=e.height});return c};var BinLayout=function(a){AbstractLayoutStrategy.apply(this,arguments)};
$jscomp.inherits(BinLayout,AbstractLayoutStrategy);BinLayout.prototype.makeBlockDimensionMap=function(){var a=new Map,b=this._getBlocks().map(function(a){var b=a.getSuggestedSize();return{width:b.width,height:b.height,block:a}}),b=lodash.sortBy(b,function(a){return Math.max(a.width,a.height)}).reverse();(new BinPacker).fit(b);b.forEach(function(b){var c=new BlockDimension(b.block,{width:b.width,height:b.height,left:b.fit.xcc,top:b.fit.ycc});a.set(b.block,c)});return a};
var LayoutStrategies={custom:CustomLayout,column:ColumnLayout,tree:TreeLayout,bin:BinLayout};window.LayoutStrategies=LayoutStrategies;var MorphBlock=function(a){return AbstractBlockChisel.apply(this,arguments)||this};$jscomp.inherits(MorphBlock,AbstractBlockChisel);MorphBlock._mountedChisels=AbstractBlockChisel._mountedChisels;MorphBlock.loadCode=AbstractBlockChisel.loadCode;MorphBlock.prototype.getHakon=function(){this.getTheme();return".MorphBlock\n .BlockBody\n  display flex\n  flex-flow row wrap\n  overflow scroll\n  a\n   margin 10px\n   height 50px\n   overflow hidden\n   text-align center\n   text-overflow ellipsis\n   font-size 12px\n   width 50px"};
MorphBlock.prototype.getBlockBodyBray=function(){var a=this.getDictionary(),b=a.getTopNodeTypes();this.getApp();return b.map(function(b){return a.getDefinitionByName(b)}).map(function(a){var b=Icons(a.getSvg(),24);return"@ a\n title "+a.getDescription()+"\n tabindex -1\n value "+a.getBase()+"\n data-onClickCommand chisel changeTypeCommand\n bern "+b+"<br>"+a.getBase()}).join("\n")};MorphBlock.prototype.getBlockHeaderBern=function(){return""};window.MorphBlock=MorphBlock;
var SettingsBlock=function(a){return AbstractBlockChisel.apply(this,arguments)||this};$jscomp.inherits(SettingsBlock,AbstractBlockChisel);SettingsBlock._mountedChisels=AbstractBlockChisel._mountedChisels;SettingsBlock.loadCode=AbstractBlockChisel.loadCode;SettingsBlock.prototype.isVisible=function(){return"true"===this.findBeam("visible")};window.SettingsBlock=SettingsBlock;var AbstractCaddy=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(AbstractCaddy,TreeNotation);
AbstractCaddy.prototype.getCaddyLink=function(){return this.getLine()};AbstractCaddy.prototype._getCaddyStr=function(){return this.childrenToString()};AbstractCaddy.prototype.toCaddyObject=function(){return{link:this.getCaddyLink(),bytes:this._getCaddyStr()}};window.AbstractCaddy=AbstractCaddy;var AbstractAppChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractAppChisel,AbstractChisel);AbstractAppChisel._mountedChisels=AbstractChisel._mountedChisels;
AbstractAppChisel.prototype.chiselWillMount=function(){var a=this;this._startVisitCounter();var b=this.getFromStore(StorageKeys.openPrograms),b=(b=b?b.replace("!",""):"")?b.split(" "):[],b=lodash.uniq(b),c=this.getProgramToOpen();c&&-1===b.indexOf(c)&&b.push(c);b=b.map(function(a){return a===c?"!"+a:a});b=b.slice(0,30);this.concat("theme\nmenu\npanel\n programs "+b+"\n gutter\n  terminal\n  console");b.forEach(function(b){return b.startsWith("!")?a.openUrlInNewSpaceAndFocus(b.substr(1)):a.openUrlInNewSpace(b)});
this._setBodyShadowHandlers();this._makeProgramLinksOpenImmediately();this._makeWindowDroppable(this);this._makeWindowPastable(this);this._makeDocumentCopyableAndCuttable();this._makeWindowResizable(this);this._bindKeyboardShortcuts();this._setErrorHandlers();this.logMessage("Ohayo dear user!")};AbstractAppChisel.prototype.registerETN=function(a,b){this.getETNs()[a]=b;return this};AbstractAppChisel.prototype.getProgramClass=function(a){return this.getETNs()[a]||FlowProgram};
AbstractAppChisel.prototype.getETNs=function(){this._etns||(this._etns={},this.registerETN("flow",FlowProgram),this.registerETN("fire",FireProgram));return this._etns};AbstractAppChisel.prototype.getTargetNode=function(){return this._targetNode};AbstractAppChisel.prototype.setTargetNode=function(a){this._targetNode=a;return this};
AbstractAppChisel.prototype.getWillowDocument=function(){this._willowBrowser||(this._willowBrowser="undefined"===typeof jQuery?new WillowDocument("http://localhost:8000/"):new BrowserDocument(""));return this._willowBrowser};AbstractAppChisel.prototype.emptyFolderCommand=function(){};AbstractAppChisel.prototype.getServerPath=function(){return""};AbstractAppChisel.prototype.getVersion=function(){return Version};
AbstractAppChisel.prototype._startVisitCounter=function(){var a=this._getVisitCount();a++;this.setVisitCount(a)};AbstractAppChisel.prototype.setVisitCount=function(a){this.storeValue(StorageKeys.visitCount,a)};AbstractAppChisel.prototype._getVisitCount=function(){var a=this.getFromStore(StorageKeys.visitCount);return a?parseInt(a):0};
AbstractAppChisel.prototype.getNodeTypes=function(){return{theme:ThemeChisel,menu:MenuChisel,panel:PanelChisel,nodePickerModal:NodePickerModal,sourceEditorModal:SourceEditorModal,programContextMenu:ProgramContextMenuChisel,blockContextMenu:BlockContextMenuChisel,blockInspectorModal:BlockInspectorModal,cardEditorModal:CardEditorModal,insertCardModal:InsertCardModal,insertCardsModal:InsertCardsModal,promptModal:CustomPromptModal,confirmModal:CustomConfirmModal,nodeEditorModal:NodeEditorModal,helpModal:HelpModal}};
AbstractAppChisel.prototype.parseNodeType=function(a){return this.getNodeTypes()[a.split(" ")[0]]};AbstractAppChisel.prototype.getBray=function(){return"@ div\n class AbstractAppChisel "+this.constructor.name};AbstractAppChisel.prototype.getHakon=function(){return".AbstractAppChisel\n height 100%\n width 100%"};AbstractAppChisel.prototype.goRed=function(a){a=this.getMountedProgram();this.logMessage("error on program: "+(a?a.getUrl():"")+".")};
AbstractAppChisel.prototype.reportUncaughtError=function(a){if("undefined"===typeof ga)return Promise.resolve();ga("send","event","UncaughtError",error.name);return Promise.resolve()};AbstractAppChisel.prototype._setErrorHandlers=function(){var a=this;this.getWillowDocument().setErrorHandler(function(b,c,d){a.reportUncaughtError(b);a.goRed();console.error(b)})};AbstractAppChisel.prototype.openNodeEditorModalCommand=function(a){a=this.getMountedProgram().nodeAt(a);this.setTargetNode(a);return this.toggleAndRender("nodeEditorModal")};
AbstractAppChisel.prototype.closeModal=function(){this.getOpenModals().forEach(function(a){return a.unmountAndDestroy()})};AbstractAppChisel.prototype.getOpenModals=function(){return this.getChildren().filter(function(a){return a instanceof AbstractModalChisel})};AbstractAppChisel.prototype.closeAllContextMenus=function(){this.getChildren().filter(function(a){return a instanceof AbstractContextMenuChisel}).forEach(function(a){return a.unmountAndDestroy()})};
AbstractAppChisel.prototype.closeAllDropDownMenusCommand=function(){this.getTopDownArray().forEach(function(a){a.getLine().includes("DropDownMenu")&&a.unmountAndDestroy()});return Promise.resolve()};AbstractAppChisel.prototype.renderApp=function(){this.render(this.getWillowDocument().getBodyStump());return this};AbstractAppChisel.prototype.appendBlockCommand=function(a,b){this._appendBlocks(a,b).forEach(function(a){return a.executeLoadData()});return this.getMountedProgram().autosaveAndRender()};
AbstractAppChisel.prototype._getAvailablePermalink=function(a){var b=this;return Util.getAvailablePermalink(a,function(a){return b.doesFileExistSync(a)})};AbstractAppChisel.prototype._appendBlocks=function(a,b){return this.getNodeCursors().map(function(c){return c.append(a,b)})};AbstractAppChisel.prototype.appendBlockAndSelectCommand=function(a,b){var c=this._appendBlocks(a,b);c.forEach(function(a){return a.executeLoadData()});a=this.getMountedProgram();a.clearSelection();return a.autosaveAndRender().then(function(){c.forEach(function(a){return a.selectBlock()})})};
AbstractAppChisel.prototype.insertMorphBlockCommand=function(){var a=this.getMountedProgram(),b=this.getMouseEvent();this.getNodeCursors().forEach(function(c){c.append(">morph",BlockConstants.pin+" "+a.makePin(b))});return a.autosaveAndRender()};AbstractAppChisel.prototype.getNodeCursors=function(){var a=this.getMountedProgram().getSelectedBlocks();return a.length?a:[this.getMountedProgram()]};
AbstractAppChisel.prototype.deleteAllCardsInTargetBlockCommand=function(){var a=this,b=this.getTargetNode().getInputBinder();return Promise.all(b.getCards().map(function(a){return a.destroyCardCommand()})).then(function(){a.renderApp()})};AbstractAppChisel.prototype.openOhayoProgramCommand=function(a){var b=this;return Promise.all(a.split(" ").map(function(a){return b._openOhayoProgramCommand(a)}))};
AbstractAppChisel.prototype._openOhayoProgramCommand=function(a){var b=(new TreeNotation(DemoTemplates)).getNode(a).getBeamWithChildren(),c=this.getFocusedPanel(),d=c.getOpenTabByUrl(a);return d?c.setMountedProgram(d):this.createAndOpen(b,a)};AbstractAppChisel.prototype.makeDataBlock=function(a){var b=(new CardParser).inferEncoding(a),b=new TreeNotation(">data\n format "+b+"\n slang");b.getNode(">data slang").setBeamWithChildren(a);return b.toString()};
AbstractAppChisel.prototype.onProgramsChange=function(){};AbstractAppChisel.prototype.getFocusedPanel=function(){return this.getNode("panel")};AbstractAppChisel.prototype.getMountedProgram=function(){return this.getFocusedPanel().getMountedProgram()};AbstractAppChisel.prototype.getMenuChisel=function(){return this.getNode("menu")};
AbstractAppChisel.prototype.createNewBlankProgramCommand=function(a){var b=this;return this.createAndOpen("",void 0===a?"untitled.flow":a).then(function(a){return b.logMessage("Created '"+a.getUrl()+"'")})};AbstractAppChisel.prototype.openUrlPromptCommand=function(){var a=this;this.prompt("Enter a url to open","").then(function(b){b&&a.openUrlInNewSpaceAndFocus(b)})};
AbstractAppChisel.prototype.openManyPrompt=function(){var a=this;return this.prompt("Enter a regex to open multiple matching files","").then(function(b){if(b)return a.openManyCommand(b)})};AbstractAppChisel.prototype.openManyCommand=function(a){var b=this,c=new RegExp(a,"i");a=this.getCaddies().filter(function(a){return a.getCaddyLink().match(c)});return Promise.all(a.map(function(a){return b.openUrlInNewSpace(a.getCaddyLink())}))};
AbstractAppChisel.prototype.openUrlInNewSpace=function(a){var b=this.getFocusedPanel().getOpenTabByUrl(a);return b?Promise.resolve(b):this.getFocusedPanel().openUrlInNewSpace(a)};AbstractAppChisel.prototype.openUrlInNewSpaceAndFocus=function(a){var b=this;return this.openUrlInNewSpace(a).then(function(a){return b.getFocusedPanel().setMountedProgram(a)})};AbstractAppChisel.prototype.mountTabByIndexCommand=function(a){return this.getFocusedPanel().mountTabByIndex(a)};
AbstractAppChisel.prototype.closeTabByIndexCommand=function(a){return this.getFocusedPanel().closeTabByIndex(a)};AbstractAppChisel.prototype.tabDidOpen=function(){};AbstractAppChisel.prototype.isAutoSaveEnabled=function(){return"false"!==this.getFromStore(StorageKeys.autoSave)};AbstractAppChisel.prototype.toggleAutoSaveCommand=function(){var a=!this.isAutoSaveEnabled();a?this.removeValue(StorageKeys.autoSave):this.storeValue(StorageKeys.autoSave,"false");this.logMessage("Autosave is "+a);return Promise.resolve()};
AbstractAppChisel.prototype.saveCompiledCommand=function(){var a=this.getMountedProgram(),b=a.compilesTo(),c=Format.permalink(Format.removeFileExtension(a.getFileName()))+"."+b,a=a.buildProgram();this.getWillowDocument().downloadFile(a,c,"text/"+b);return Promise.resolve()};AbstractAppChisel.prototype.getLanguageBestGuess=function(a){var b=this.getETNs(),b=Object.values(b).map(function(b){return(new b(a)).getGuess()});b.sort(Util.sortByAccessor(function(a){return a.guess}));return b[0].name};
AbstractAppChisel.prototype.generateProgram=function(a,b){return new (this.getProgramClass(b))(a)};AbstractAppChisel.prototype.executeProgramCommand=function(){var a=this;return this.getMountedProgram().getProgramOfInterest().execute().then(function(b){a.logMessage(b)})};AbstractAppChisel.prototype.toggleThemeCommand=function(){return this._toggleTheme()};AbstractAppChisel.prototype._getThemeName=function(){return this.getFromStore(StorageKeys.theme)};
AbstractAppChisel.prototype.getTheme=function(){return Themes[this._getThemeName()]||Themes.glass};AbstractAppChisel.prototype._toggleTheme=function(){var a=Util.toggle(this._getThemeName(),Object.keys(Themes));this.logMessage("Switched to "+a+" theme");this.storeValue(StorageKeys.theme,a);this.getApp().makeAllDirty();this.renderApp();return Promise.resolve()};
AbstractAppChisel.prototype.confirmAndDeleteFile=function(a){var b=this;return this.confirm("Are you sure you want to delete "+a+"?").then(function(c){return c?b.deleteFileCommand(a):Promise.resolve(!1)})};AbstractAppChisel.prototype.promptToRenameFile=function(a,b){var c=this;return this.prompt("Enter new name for file",a).then(function(d){return d&&d!==a?(d=Format.permalink(d))?c.renameFileCommand(a,d,b).then(function(a){c.logMessage("Renamed");return a}):Promise.resolve():Promise.resolve()})};
AbstractAppChisel.prototype.deleteAllProgramsPrompt=function(){var a=this,b=this.getFocusedPanel().getPrograms();return this.confirm("Are you sure you want to delete "+b.length+" programs?").then(function(c){return c?Promise.all(b.map(function(b){return a.deleteFileCommand(b.getFileName())})):Promise.resolve(!1)})};AbstractAppChisel.prototype.getFolderPath=function(){return""};
AbstractAppChisel.prototype.showTabRenamePromptCommand=function(){var a=this,b=this.getMountedProgram();this.promptToRenameFile(b.getFileName()).then(function(c){if(!c)return!1;a.openUrlInNewSpaceAndFocus(""+a.getFolderPath()+c).then(function(c){a.getFocusedPanel().closeProgram(b)})});return Promise.resolve()};AbstractAppChisel.prototype.toggleHelpCommand=function(){return this.toggleAndRender("helpModal")};AbstractAppChisel.prototype.toggleSourceEditorCommand=function(){return this.toggleAndRender("sourceEditorModal")};
AbstractAppChisel.prototype.toggleLayoutCommand=function(){return this.getMountedProgram().toggleLayout()};AbstractAppChisel.prototype.closeMountedProgramCommand=function(){return this.getFocusedPanel().closeProgram(this.getMountedProgram())};AbstractAppChisel.prototype.fetchAndReloadFocusedProgramCommand=function(){return this.getFocusedPanel().fetchAndReloadProgram(this.getMountedProgram())};AbstractAppChisel.prototype.selectAllCommand=function(){this.getMountedProgram().selectAll();return Promise.resolve()};
AbstractAppChisel.prototype.selectBlocksByShadowClassCommand=function(a){this.logCommand("app selectBlocksByShadowClassCommand");this.getMountedProgram().selectBlocksByShadowClass(a);return Promise.resolve()};AbstractAppChisel.prototype.clearSelectionCommand=function(){this.logCommand("app clearSelectionCommand");this.getMountedProgram().clearSelection();return Promise.resolve()};AbstractAppChisel.prototype.deleteSelectionCommand=function(){return this.getMountedProgram().deleteSelection()};
AbstractAppChisel.prototype.duplicateSelectionCommand=function(){return this.getMountedProgram().duplicateSelection()};AbstractAppChisel.prototype.cancelConfirmCommand=function(){return this._confirmModal._resolveCommand("0")};AbstractAppChisel.prototype.acceptConfirmCommand=function(){return this._confirmModal._resolveCommand("1")};AbstractAppChisel.prototype.submitPromptCommand=function(){return this._promptModal._resolveCommand()};
AbstractAppChisel.prototype.showDeleteFileConfirmDialogCommand=function(){var a=this,b=this.getMountedProgram();return this.confirmAndDeleteFile(b.getFileName()).then(function(c){!1!==c&&a.getFocusedPanel().closeProgram(b)})};AbstractAppChisel.prototype.mountPreviousProgramCommand=function(){return this.getFocusedPanel().mountPreviousProgram()};AbstractAppChisel.prototype.mountNextProgramCommand=function(){return this.getFocusedPanel().mountNextProgram()};
AbstractAppChisel.prototype.closeAllProgramsCommand=function(){return this.getFocusedPanel().closeAllPrograms()};AbstractAppChisel.prototype.toggleFullScreenCommand=function(){this.getWillowDocument().toggleFullScreen();return Promise.resolve()};AbstractAppChisel.prototype.toggleFocusedModeCommand=function(){this.toggle("menu");this.getFocusedPanel().toggle("programs");return this.toggleFullScreenCommand()};
AbstractAppChisel.prototype.toggleGutterCommand=function(){this.makeAllDirty();var a=this.getFocusedPanel(),b=a.getNode("gutter");b?b.unmountAndDestroy():(a=a.touchNode("gutter"),a.insert("terminal"),a.insert("console"));this.renderApp();return Promise.resolve()};AbstractAppChisel.prototype.getKeyboardShortcuts=function(){this._shortcuts||(this._shortcuts=new Drums(this._getDrumsProgram()));return this._shortcuts};AbstractAppChisel.prototype.selectNextCommand=function(){return this.getMountedProgram().selectNext()};
AbstractAppChisel.prototype.selectPreviousCommand=function(){return this.getMountedProgram().selectPrevious()};AbstractAppChisel.prototype.createNewFlowVisProgramCommand=function(){var a=this,b=this.getMountedProgram(),c=b.childrenToString();return this.createAndOpen(FlowCodeEditorTemplate(c,"fire"),b.getFileName()+".editor.flow").then(function(b){return a.logMessage("Created '"+b.getUrl()+"'")})};
AbstractAppChisel.prototype.createMiniMapCommand=function(){var a=this;return this.createAndOpen(MiniTemplate,"myPrograms.flow").then(function(b){return a.logMessage("Created '"+b.getUrl()+"'")})};AbstractAppChisel.prototype.clearProgramMessagesCommand=function(){var a=this;return this.getMountedProgram().clearCommand().then(function(){a.renderApp()})};AbstractAppChisel.prototype._getDrumsProgram=function(){return"panel new createNewBlankProgramCommand ctrl+n New Flow Program\nmounted new cloneProgramCommand ctrl+shift+n Clone program\npanel new createMiniMapCommand shift+m Mini Map\nmounted new createNewFlowVisProgramCommand shift+v Flow Code Editor\nmounted file saveProgramAndNotifyCommand command+s Save Program\nmounted file showTabRenamePromptCommand ctrl+shift+r Rename File\nmounted file showDeleteFileConfirmDialogCommand shift+backspace Delete Program\npanel file deleteAllProgramsPrompt command+shift+d Delete all open programs\nmounted navigation closeMountedProgramCommand ctrl+w Close focused program\npanel navigation closeAllProgramsCommand ctrl+shift+w Close all programs\nmounted navigation mountPreviousProgramCommand shift+left Previous program\nmounted navigation mountNextProgramCommand shift+right Next program\npanel navigation openUrlPromptCommand shift+o Open program from url\npanel navigation openManyPrompt command+shift+o Open multiple programs from regex\nmounted selection selectAllCommand command+a Select All\nmounted selection selectNextCommand shift+down Select next\nmounted selection selectPreviousCommand shift+up Select previous\nmounted selection deleteSelectionCommand backspace Delete Selection\nmounted selection duplicateSelectionCommand command+d Duplicate Selection\npanel window toggleThemeCommand shift+t Toggle Theme\npanel window toggleGutterCommand shift+u Toggle Source Editor Gutter\npanel window toggleFullScreenCommand shift+f Toggle Full Screen\npanel window toggleFocusedModeCommand command+shift+f Toggle Focused Mode\npanel window toggleSourceEditorCommand ctrl+u Toggle Source Editor Modal\npanel window closeModalCommand escape Close any open modal\nmounted window clearProgramMessagesCommand shift+c Clear program messages\npanel window toggleAutoSaveCommand shift+s Toggle autosave\nmounted window fetchAndReloadFocusedProgramCommand shift+r Re-download and refresh program\nmounted window toggleNodePickerCommand shift+p Edit node\nmounted code saveCompiledCommand command+b Save compiled code\nmounted code executeProgramCommand shift+e Execute Code\nmounted edit toggleLayoutCommand shift+l Toggle layout\nmounted edit undoFocusedProgramCommand command+z Undo\nmounted edit redoFocusedProgramCommand command+shift+z Redo\npanel ohayo toggleHelpCommand ? Help\npanel test _runSpeedTestCommand ctrl+shift+m"};
AbstractAppChisel.prototype.toggleNodePickerCommand=function(){return this.toggleAndRender("nodePickerModal")};AbstractAppChisel.prototype.undoFocusedProgramCommand=function(){return this.getMountedProgram().undoCommand()};AbstractAppChisel.prototype.redoFocusedProgramCommand=function(){return this.getMountedProgram().redoCommand()};AbstractAppChisel.prototype._getMousetrap=function(){return this.getWillowDocument().getMousetrap()};
AbstractAppChisel.prototype.closeModalCommand=function(){this.closeModal();return Promise.resolve()};
AbstractAppChisel.prototype._bindKeyboardShortcuts=function(){var a=this._getMousetrap(),b=this.getWillowDocument();a._originalStopCallback=a.prototype.stopCallback;a.prototype.stopCallback=function(c,e,f){var d=b.getStumpFromElement(e);return d&&"command+s"===f&&d.stumpHasClass("savable")?(d.getShadow().triggerShadowEvent(ShadowEvents.change),c.preventDefault(),!0):a._pause?!0:a._originalStopCallback.call(this,c,e)};var c=this;this.getKeyboardShortcuts().getChildren().forEach(function(b){a.bind(b.getKeyCombo(),
function(a){b.execute(c);a.preventDefault&&a.preventDefault();return!1})})};AbstractAppChisel.prototype.executeCommandLine=function(a){this.logCommand(a.join(" "));return this[a[0]].apply(this,a.slice(1))};AbstractAppChisel.prototype.pauseShortcutListener=function(){this._getMousetrap()._pause=!0};AbstractAppChisel.prototype.resumeShortcutListener=function(){this._getMousetrap()._pause=!1};AbstractAppChisel.prototype.getStore=function(){return this.getWillowDocument().getStore()};
AbstractAppChisel.prototype.getStoreKeys=function(){var a=this.constructor.name,b=a.length,c=[];this.getStore().each(function(d,e){e.startsWith(a)&&c.push(e.substr(b))});return c};AbstractAppChisel.prototype.getFromStore=function(a){return this.getStore().get(this.constructor.name+a)};AbstractAppChisel.prototype.storeValue=function(a,b){return this.getStore().set(this.constructor.name+a,b)};AbstractAppChisel.prototype.removeValue=function(a){return this.getStore().remove(this.constructor.name+a)};
AbstractAppChisel.prototype.clearStoreCommand=function(){if(this.getStore().disabled)return Promise.resolve();this.getStore().clearAll();return Promise.resolve()};AbstractAppChisel.prototype._makeDocumentCopyableAndCuttable=function(){var a=this;a.getWillowDocument().setCopyHandler(function(b){return a.copySelectionCommand(b)}).setCutHandler(function(b){return a.cutSelectionCommand(b)})};
AbstractAppChisel.prototype.copySelectionCommand=function(a){var b=this.getMountedProgram();return b?b.copySelection(a):!0};AbstractAppChisel.prototype.cutSelectionCommand=function(a){return this.getMountedProgram().cutSelection(a)};AbstractAppChisel.prototype._handleLinkClick=function(a,b){var c=a.getStumpAttr("href");if(c&&!a.getStumpAttr("target")&&(b.preventDefault(),this.getWillowDocument().isExternalLink(c)))return this.openExternalLink(c),!1};
AbstractAppChisel.prototype.echoCommand=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this.logMessage(b.join(" "));return Promise.resolve()};AbstractAppChisel.prototype.saveProgramAndNotifyCommand=function(){var a=this,b=this.getMountedProgram();b.forceSaveToDisk().then(function(){b.logMessage("Saved "+b.getUrl());a.renderApp()}).catch(function(a){console.error(a)})};AbstractAppChisel.prototype.prompt=function(a,b){return Promise.resolve(prompt(a,b))};
AbstractAppChisel.prototype.confirm=function(a){return Promise.resolve(confirm(a))};AbstractAppChisel.prototype.openExternalLink=function(a){this.getWillowDocument().openUrl(a)};AbstractAppChisel.prototype.cloneProgramCommand=function(){var a=this.getMountedProgram();return this.createAndOpen(a.childrenToString(),a.getFileName())};
AbstractAppChisel.prototype._makeWindowDroppable=function(){var a=this,b=this,c=b.getWillowDocument(),d=function(a,c){c=lodash.upperFirst(Format.toTitleCase(Format.removeFileExtension(c)));c=Format.permalink(c);a=(new TreeNotation(a)).toString();return b.createAndOpen(">data\n slang "+a+"\n >table\n >scatter",c)},e=function(b,c,d){c=c||"";b.isFile?b.file(function(b){a.logMessage("File:",c+b.name);f(c,b,d)}):b.isDirectory&&b.createReader().readEntries(function(a){for(var d=0;d<a.length;d++)e(a[d],
c+b.name+"/")})},f=function(b,c,d){var e=c.name.match(/\.([^\.]+)$/);if(!e)return!1;e=e[1].toLowerCase();e.match(/(csv|json|tree|txt|tsv|ssv)/)?(b=new FileReader,b.onload=function(b){b=(new CardParser).parse(b.target.result,e);a.logMessage("Processed "+b.length+" cards");d&&d(b,c.name)},b.onerror=function(a){return console.error("error: ",a)},b.readAsText(c)):a.logMessage("No matching file extension found")},g=function(a,c){for(var f=0;f<a.length;f++){var g=a[f].webkitGetAsEntry();c?e(g,null,function(a){var c=
b.getMountedProgram();c&&(c.concat(b.makeDataBlock(a)),c.autosaveProgram(),b.renderApp())}):g&&e(g,null,d)}};(function(){var a=c.getBodyStump(),b=a.getShadow(),d=function(a){a=a.originalEvent;var b=a.dataTransfer.effectAllowed;a.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy"},e=function(c){c.preventDefault();c.stopPropagation();a.removeClassFromStump("dragOver");a.findStumpByChild("id dragOverHelp").removeStump();b.offShadowEvent(ShadowEvents.dragleave,e)};b.onShadowEvent(ShadowEvents.dragover,
function(c){d(c);c.preventDefault();c.stopPropagation();a.stumpHasClass("dragOver")||(a.insertChildNode("@ div\n id dragOverHelp\n bern Drop to create a new program. Hold shift key to insert cards into current program."),a.addClassToStump("dragOver"),setTimeout(function(){b.onShadowEvent(ShadowEvents.dragleave,e)},50))});b.onShadowEvent(ShadowEvents.drop,function(b){b.preventDefault();b.stopPropagation();a.removeClassFromStump("dragOver");a.findStumpByChild("id dragOverHelp").removeStump();g(b.originalEvent.dataTransfer.items,
b.shiftKey)});b.onShadowEvent(ShadowEvents.dragenter,function(a){a.preventDefault();a.stopPropagation()})})()};AbstractAppChisel.prototype.getRenderedBlocks=function(){return this.getMountedProgram().getProgramBlocks().filter(function(a){return a.isMounted()})};AbstractAppChisel.prototype._createProgramFromPaste=function(a){return this.createAndOpen(a,"untitled.flow")};AbstractAppChisel.prototype.pasteCommand=function(a){var b=this.getMountedProgram();return b?b.appendFromPaste(a):this._createProgramFromPaste(a)};
AbstractAppChisel.prototype._makeWindowResizable=function(){var a=this;a.getWillowDocument().setResizeEndHandler(function(b){a.renderApp()})};AbstractAppChisel.prototype._makeWindowPastable=function(){var a=this,b=a.getWillowDocument();b.setPasteHandler(function(c){if(b.someInputHasFocus())return!0;c.clipboardData&&c.clipboardData.getData&&a.pasteCommand(c.clipboardData.getData("text/plain"))})};AbstractAppChisel.prototype.setMouseEvent=function(a){this._mouseEvent=a;return this};
AbstractAppChisel.prototype.getMouseEvent=function(){return this._mouseEvent};
AbstractAppChisel.prototype._runSpeedTestCommand=function(){var a=this,b=this.getCaddies().map(function(a){return a.getCaddyLink()}),c=Date.now(),d=Util.pLimit(7),e=this.getFocusedPanel(),b=b.map(function(b){return d(function(){return a.openUrlInNewSpace(b).then(function(a){var b=e.getMountedProgram();e.setMountedProgram(a);b&&e.closeProgram(b);return a.getProgramStats()})})});return Promise.all(b).then(function(b){e.getMountedProgram()&&a.closeMountedProgramCommand();b=new TreeNotation(b);var d=
Date.now()-c,d="Program Load Times "+moment().format("MM/DD/YYYY")+" version "+a.getVersion()+". Run time: "+d;return a.createAndOpen(SpeedTestTemplate(d,b.toCsv()),"program-load-times")})};AbstractAppChisel.prototype.executeCommandOnFirstSelectedBlock=function(a,b,c){return this.getMountedProgram().getFirstSelectedBlock()[a](b,c)};AbstractAppChisel.prototype.toggleShadowById=function(a){this.getWillowDocument().findStumpByChild("id "+a).getShadow().toggleShadow()};
AbstractAppChisel.prototype.getStumpString=function(){return this.getWillowDocument().getHtmlStump().toString()};AbstractAppChisel.prototype._makeProgramLinksOpenImmediately=function(){var a=this,b=this.getWillowDocument();b.getBodyStump().getShadow().onShadowEvent(ShadowEvents.click,"a",function(c){a._handleLinkClick(b.getStumpFromElement(this),c)})};
AbstractAppChisel.prototype.executeStumpCommand=function(a,b){var c=a.getStumpChisel(),d=a.getShadow(),d=a.isStumpCheckbox()?d.isShadowChecked()?!0:!1:a.getStumpAttr("contenteditable")?d.getShadowHtml():d.getShadowValue()?d.getShadowValue():a.getStumpAttr("value");a=a.getStumpAttr("name");this.logCommand([b,d,a].filter(function(a){return a}).join(" "));this.closeAllContextMenus();this.closeAllDropDownMenusCommand();var e=b.split(" ");b=e.shift();var e=e.shift(),f;"block"===b?f=c.getChildBlock():"context"===
b?f=this.getTargetNode():"app"===b?f=this:"chisel"===b&&(f=c);return f[e](d,a)};AbstractAppChisel.prototype.executeStumpCommandByStumpId=function(a,b){return this._executeStumpCommandByStumpChild(a,"id "+b)};AbstractAppChisel.prototype.executeStumpCommandByStumpClass=function(a,b){return this._executeStumpCommandByStumpChild(a,"class "+b)};AbstractAppChisel.prototype._executeStumpCommandByStumpChild=function(a,b){b=this.getWillowDocument().findStumpByChild(b);return this.executeStumpCommand(b,b.getStumpAttr(a))};
AbstractAppChisel.prototype._setBodyShadowHandlers=function(){var a=this,b=this.getWillowDocument(),c=b.getBodyStump().getShadow(),d=function(c,d,g){c=b.getStumpFromElement(c);g.preventDefault();g.stopImmediatePropagation();a.executeStumpCommand(c,c.getStumpAttr(d));return!1};c.onShadowEvent(ShadowEvents.contextmenu,"[data-onContextMenuCommand]",function(b){if(b.ctrlKey)return!0;a.setMouseEvent(b);return d(this,"data-onContextMenuCommand",b)});c.onShadowEvent(ShadowEvents.change,"[data-onChangeCommand]",
function(a){return d(this,"data-onChangeCommand",a)});c.onShadowEvent(ShadowEvents.blur,"[data-onBlurCommand]",function(a){return d(this,"data-onBlurCommand",a)});c.onShadowEvent(ShadowEvents.click,"[data-onClickCommand]",function(a){return d(this,"data-onClickCommand",a)});c.onShadowEvent(ShadowEvents.dblclick,"[data-onDblClickCommand]",function(b){if(b.target!==b.currentTarget)return!0;a.setMouseEvent(b);return d(this,"data-onDblClickCommand",b)})};window.AbstractAppChisel=AbstractAppChisel;
var AbstractDropDownMenuChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractDropDownMenuChisel,AbstractChisel);AbstractDropDownMenuChisel._mountedChisels=AbstractChisel._mountedChisels;
AbstractDropDownMenuChisel.prototype.getHakon=function(){var a=this.getTheme();return"\n.subdued\n color "+a.midGray+"\n\n.dropdownMenu\n min-width 200px\n position absolute\n top 0\n left 0\n z-index 100\n padding 7px 0\n background "+a.contextMenuBackground+"\n border 1px solid "+a.borderColor+"\n box-shadow 0 1px 3px 0 "+a.boxShadow+"\n .message\n  line-height 30px\n  padding 0 10px\n a\n  color "+a.foregroundColor+"\n  display block\n  line-height 30px\n  padding 0 10px\n  &:hover\n   background "+
a.hoverBackground+"\n   color "+a.white};AbstractDropDownMenuChisel.prototype.chiselDidMount=function(){var a=this.getApp(),b=a.getWillowDocument().getBodyStump().getShadow(),c=function(){b.offShadowEvent(ShadowEvents.click,c);a.closeAllDropDownMenusCommand()};setTimeout(function(){return b.onShadowEvent(ShadowEvents.click,c)},100)};
AbstractDropDownMenuChisel.prototype.getBray=function(){var a=this.getDropDownBray(),b=this.getAnchorId();return"@ div\n style top: 30px; left: "+this.getParent().getStump().findStumpByChild("id "+b).getShadow().getShadowPosition().left+"px;\n class dropdownMenu"+TreeNotation.nest(a,1)};window.AbstractDropDownMenuChisel=AbstractDropDownMenuChisel;var BlockToolbarChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(BlockToolbarChisel,AbstractChisel);
BlockToolbarChisel._mountedChisels=AbstractChisel._mountedChisels;BlockToolbarChisel.prototype.getHakon=function(){var a=this.getTheme();return".BlockToolbarChisel\n background "+a.contextMenuBackground+"\n border 1px solid "+a.lineColor+"\n font-size 12px\n position absolute\n padding 8px\n z-index 991\n min-width 300px\n top 100%\n left 0\n cursor pointer\n svg\n  fill "+a.greyish+"\n  padding 1px 3px 3px 3px\n  &:hover\n   fill "+a.foregroundColor};BlockToolbarChisel.prototype.getChildBlock=function(){return this.getParent()};
BlockToolbarChisel.prototype.getBray=function(){var a=this._getFormBray();return"@ div\n class BlockToolbarChisel\n @ span\n  data-onClickCommand block openBlockSourceEditorModalCommand\n  bern "+Icons("coding",20)+"\n @ span\n  data-onClickCommand block cloneBlockCommand\n  bern "+Icons("copy",20)+"\n @ span\n  data-onClickCommand block destroyBlockCommand\n  bern "+Icons("trash",20)+"\n @ span\n  data-onClickCommand block openBlockInspectorCommand\n  bern "+Icons("inspector",20)+TreeNotation.nest(a,
1)};BlockToolbarChisel.prototype._getTypeDropdownBray=function(){var a=this.getChildBlock(),b=a.getDictionary().getBlockNames();b.sort();var c=a.getBase();return"@ select\n data-onChangeCommand block changeTypeCommand\n @ option\n"+b.map(function(a){return" @ option\n  value "+a+"\n  bern "+a+"\n  "+(c===a?"selected":"notselected")}).join("\n")};
BlockToolbarChisel.prototype._getParentDropdownBray=function(){var a=this.getChildBlock(),b=a.getPathVector().join(" ");return"@ select\n data-onChangeCommand block changeParentCommand\n @ option\n"+a.getProgram().getProgramBlocks().map(function(a){return{name:a.getBasePath(),value:a.getPathVector().join(" ")}}).map(function(a){return" @ option\n  value "+a.value+"\n  bern "+a.name+"\n  "+(b===a.value?"selected":"notselected")}).join("\n")};
BlockToolbarChisel.prototype._getFormBray=function(){var a=this.getChildBlock(),b=a.getStruct(),c=a.getDefinition().getDefinitionTuples().map(function(c){var d=c.getTupleName();return[d,c.toFormBray(b[d]||"",a)]});c.unshift(["parent",this._getParentDropdownBray()]);c.unshift(["type",this._getTypeDropdownBray()]);return"@ form\n @ table\n"+c.map(function(a){return"  @ tr\n   @ td\n    bern "+a[0]+"\n   @ td"+TreeNotation.nest(a[1],4)}).join("\n")};window.BlockToolbarChisel=BlockToolbarChisel;
var ConsoleChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(ConsoleChisel,AbstractChisel);ConsoleChisel._mountedChisels=AbstractChisel._mountedChisels;ConsoleChisel.prototype._getConsoleOutput=function(){var a=this._getMessageBuffer().getChildren().map(function(a){return a.childrenToString()});a.reverse();return a.join("\n")};ConsoleChisel.prototype.getHakon=function(){return".sourcePre\n overflow scroll"};
ConsoleChisel.prototype._getMessageBuffer=function(){var a=this.getParent().getParent().getMountedProgram();return a?a.getMessageBuffer():new TreeNotation};ConsoleChisel.prototype.getDependencyTimestamps=function(){var a=this.getParent().getGutterDependencies(),b=this._getMessageBuffer();b.length?a.push(b.nodeAt(-1).getMTime()):a.push(this._getNow());return a};ConsoleChisel.prototype.getBray=function(){var a=this._getConsoleOutput();return"@ pre\n class sourcePre\n bern"+TreeNotation.nest(a,2)};
window.ConsoleChisel=ConsoleChisel;var DummyChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(DummyChisel,AbstractChisel);DummyChisel._mountedChisels=AbstractChisel._mountedChisels;DummyChisel.prototype.getHakon=function(){return".DummyChisel\n display none"};window.DummyChisel=DummyChisel;var GutterChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(GutterChisel,AbstractChisel);GutterChisel._mountedChisels=AbstractChisel._mountedChisels;
GutterChisel.prototype.parseNodeType=function(a){return a.startsWith("console")?ConsoleChisel:TerminalChisel};GutterChisel.prototype.getHakon=function(){var a=this.getTheme(),b=this.getGutterWidth();return AbstractChisel.prototype.getHakon.call(this)+"\n.Gutter\n width "+b+"px\n left 0\n background "+a.backgroundColor+"\n border-color "+a.borderColor+"\n position absolute\n border-right-width 1px\n border-right-style solid\n box-sizing border-box\n top 0\n bottom 0\n padding 20px"};
GutterChisel.prototype.getGutterDependencies=function(){return[this.getParent().getNode("programs").getMTime()]};GutterChisel.prototype.getBray=function(){return"@ div\n class Gutter"};GutterChisel.prototype.hasChanges=function(){return this.getNode("terminal").hasChanges()};GutterChisel.prototype.getGutterWidth=function(){return 400};window.GutterChisel=GutterChisel;var MenuChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(MenuChisel,AbstractChisel);
MenuChisel._mountedChisels=AbstractChisel._mountedChisels;MenuChisel.prototype.getNodeTypes=function(){return{newDropDownMenu:NewDropDownMenuChisel}};MenuChisel.prototype.parseNodeType=function(a){return this.getNodeTypes()[a]};
MenuChisel.prototype.getHakon=function(){var a=this.getTheme();return".MenuChisel\n "+a.disableTextSelect(1)+"\n font-size 14px\n padding-left 5px\n box-sizing border-box\n right 0\n left 0\n position relative\n height 30px\n z-index 92\n white-space nowrap\n background "+a.menuBackground+"\n color "+a.darkBlack+"\n display flex\n >a\n  padding-right 5px\n  line-height 30px\n  display inline-block\n  color "+a.menuChiselColor};
MenuChisel.prototype.getBray=function(){return"@ div\n class MenuChisel "+this.constructor.name+"\n @ a\n  data-onClickCommand app toggleHelpCommand\n  bern ohayo\n @ a\n  id newToggle\n  data-onClickCommand chisel toggleAndRender\n  value newDropDownMenu\n  bern New \u25be"};window.MenuChisel=MenuChisel;var NewDropDownMenuChisel=function(a){return AbstractDropDownMenuChisel.apply(this,arguments)||this};$jscomp.inherits(NewDropDownMenuChisel,AbstractDropDownMenuChisel);
NewDropDownMenuChisel._mountedChisels=AbstractDropDownMenuChisel._mountedChisels;NewDropDownMenuChisel.prototype.getDropDownBray=function(){return this.getApp().getMountedProgram()?"@ a\n data-onClickCommand app createNewBlankProgramCommand\n value untitled.flow\n bern New Flow Program\n@ a\n data-onClickCommand app createNewBlankProgramCommand\n value untitled.fire\n bern New Fire Program\n@ div  divider\n@ a\n data-onClickCommand app cloneProgramCommand\n bern Clone Program":"@ a\n data-onClickCommand app createNewBlankProgramCommand\n value untitled.flow\n bern New Flow Program\n@ a\n data-onClickCommand app createNewBlankProgramCommand\n value untitled.fire\n bern New Fire Program"};
NewDropDownMenuChisel.prototype.getAnchorId=function(){return"newToggle"};window.NewDropDownMenuChisel=NewDropDownMenuChisel;var PanelChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(PanelChisel,AbstractChisel);PanelChisel._mountedChisels=AbstractChisel._mountedChisels;PanelChisel.prototype.parseNodeType=function(a){var b=this.getApp(),c=a.split(" ")[0];return"program"===c?b.getProgramClass(Util.getFileExtension(a)):{programs:ProgramSwitcherChisel,gutter:GutterChisel}[c]};
PanelChisel.prototype.getHakon=function(){var a=this.getParent().getMenuChisel()?"30":"0";this.getTheme();return".PanelChisel\n left 0\n position relative\n right 0\n bottom 0\n height calc(100% - "+a+"px)"};PanelChisel.prototype.getGutterWidth=function(){var a=this.getChildrenByNodeType(GutterChisel)[0];return a?a.getGutterWidth():0};PanelChisel.prototype.mountTabByIndex=function(a){return this.setMountedProgram(this.getPrograms()[a])};PanelChisel.prototype.getMountedProgram=function(){return this._mountedProgram};
PanelChisel.prototype.fetchAndReloadProgram=function(a){var b=this;a.unmount();return this._executeFetchProgram(a).then(function(){b.getApp().renderApp()})};PanelChisel.prototype._executeFetchProgram=function(a){var b=this.getApp();this._updateProgramSwitcherChisel();return b.fetchProgram(a).then(function(){return a.executeLoadProgramCodeAndData()}).then(function(){b.tabDidOpen(a);b.renderApp();return a})};
PanelChisel.prototype.getOpenTabByUrl=function(a){return this.getPrograms().find(function(b){return b.getUrl()===a})};PanelChisel.prototype.setMountedProgram=function(a){var b=this.getMountedProgram();if(b===a)return Promise.resolve(a);b&&b.unmount();this._mountedProgram=a;this._updateProgramSwitcherChisel();this.getApp().renderApp();return Promise.resolve(a)};PanelChisel.prototype.openUrlInNewSpace=function(a){return this._executeFetchProgram(this.append("program "+a))};
PanelChisel.prototype.closeTabByIndex=function(a){return this.closeProgram(this.getPrograms()[a])};PanelChisel.prototype.closeProgram=function(a){if(a.isMounted()){var b=a.getNextOrPrevious(this.getPrograms());a.unmountAndDestroy();if(b&&b!==a)return this.setMountedProgram(b);delete this._mountedProgram}else a.destroy();this._updateProgramSwitcherChisel();this.getApp().renderApp();return Promise.resolve()};
PanelChisel.prototype.getOpenProgramsString=function(){var a=this.getMountedProgram();return this.getPrograms().map(function(b){return""+(b===a?"!":"")+b.getUrl()}).join(" ")};PanelChisel.prototype._updateProgramSwitcherChisel=function(){var a=this.getOpenProgramsString();this.touchNode("programs").setBeam(a);this._openPrograms!==a&&(this.getApp().storeValue(StorageKeys.openPrograms,a),this._openPrograms=a,this._updateLocationForRestoreOnRefresh())};
PanelChisel.prototype._updateLocationForRestoreOnRefresh=function(){var a=this.getApp(),b=this.getMountedProgram();b?a.storeValue(StorageKeys.mountedProgram,b.getUrl()):a.removeValue(StorageKeys.mountedProgram)};PanelChisel.prototype.closeAllPrograms=function(){var a=this.getMountedProgram();a&&a.unmount();this.getPrograms().forEach(function(a){return a.destroy()});delete this._mountedProgram;this._updateProgramSwitcherChisel();this.getApp().renderApp();return Promise.resolve()};
PanelChisel.prototype.mountPreviousProgram=function(){var a=this.getPrograms(),b=this.getMountedProgram();if(2>a.length||!b)return Promise.resolve();b=a.indexOf(b);return this.mountTabByIndex(0===b?a.length-1:b-1)};PanelChisel.prototype.mountNextProgram=function(){var a=this.getPrograms(),b=this.getMountedProgram();if(2>a.length||!b)return Promise.resolve();b=a.indexOf(b);return this.mountTabByIndex(b===a.length-1?0:b+1)};PanelChisel.prototype.getPrograms=function(){return this.findNodes("program")};
window.PanelChisel=PanelChisel;var ProgramSwitcherChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(ProgramSwitcherChisel,AbstractChisel);ProgramSwitcherChisel._mountedChisels=AbstractChisel._mountedChisels;ProgramSwitcherChisel.prototype.getDependencyTimestamps=function(){return[this.getParent().getMTime()]};
ProgramSwitcherChisel.prototype.getHakon=function(){var a=this.getTheme(),b=this._getPrograms().length;return".ProgramSwitcherChisel\n height 30px\n box-sizing border-box\n left "+this.getParent().getGutterWidth()+"px\n right 0\n position relative\n white-space nowrap\n overflow-y hidden\n overflow-x "+(10<b?"scroll":"auto")+"\n border-bottom "+(b?"1px solid "+a.borderColor:"0")+"\n background "+a.programsBackground+"\n a\n  span\n   position absolute\n   top 10px\n   right 5px\n   display block\n   font-size 12px\n   line-height 10px\n   text-align center\n   opacity .25\n   &:hover\n    opacity 1\n  background "+
a.tabBackground+"\n  height 30px\n  display inline-block\n  box-sizing border-box\n  position relative\n  font-size 14px\n  padding 0 20px\n  color "+a.foregroundColor+"\n  line-height 30px\n  border-right 1px solid "+a.borderColor+"\n  border-bottom 1px solid "+a.borderColor+"\n  &.mountedProgram\n   background "+a.surfaceBackground+"\n   border-bottom 0"};ProgramSwitcherChisel.prototype._getPrograms=function(){var a=this.getBeam();return a?a.split(" "):[]};
ProgramSwitcherChisel.prototype.getBray=function(){var a=this._getPrograms().map(function(a,c){return"@! a\n data-onClickCommand app mountTabByIndexCommand\n value "+c+"\n class "+(a.startsWith("!")?"mountedProgram":"")+"\n bern "+a.replace("!","")+"\n @! span\n  data-onClickCommand app closeTabByIndexCommand\n  value "+c+"\n  class closeTabButton\n  bern x"}).join("\n");return"@ div\n class ProgramSwitcherChisel"+TreeNotation.nest(a,1)};window.ProgramSwitcherChisel=ProgramSwitcherChisel;
var TerminalChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(TerminalChisel,AbstractChisel);TerminalChisel._mountedChisels=AbstractChisel._mountedChisels;TerminalChisel.prototype.getHakon=function(){return".sourceTextarea\n height "+this._getHeight()+"px"};TerminalChisel.prototype._getProgramSource=function(){var a=this._getProgram();return a?a.childrenToString():""};TerminalChisel.prototype._getProgram=function(){return this.getParent().getParent().getMountedProgram()};
TerminalChisel.prototype.getBray=function(){var a=this._getProgramSource()||"";return"@ div\n style font-size: 14px;\n @ textarea\n  class sourceTextarea\n  bern"+TreeNotation.nest(a,3)};TerminalChisel.prototype._getHeight=function(){return 600};TerminalChisel.prototype._getTextarea=function(){return this.getStump().getNode("@").getShadow().getShadowElement()};
TerminalChisel.prototype._makeProgram=function(a){var b=new TreeNotation(this._getCode()),c=this._getProgram().constructor;a=b.getTopDownArray()[a];return new c(a.toString())};TerminalChisel.prototype._compileLine=function(a){a=this._makeProgram(a).buildProgram();this._getProgram().logMessage(a);this._updateConsole()};TerminalChisel.prototype._executeLine=function(a){var b=this;return this._makeProgram(a).execute(this.getApp()).then(function(a){b._getProgram().logMessage(a);b._updateConsole()})};
TerminalChisel.prototype._updateConsole=function(){this.getParent().getChildren()[1].render()};TerminalChisel.prototype.getDependencyTimestamps=function(){var a=this.getParent().getGutterDependencies(),b=this._getProgram();b&&this._getProgramSource()!==this._getCode()&&a.push(b.getTreeMTime());return a};TerminalChisel.prototype.chiselDidMount=function(){this._loadCodeMirror();AbstractChisel.prototype.chiselDidMount.call(this)};TerminalChisel.prototype.updateHtml=function(){};
TerminalChisel.prototype.chiselDidUpdate=function(){var a=this._getCodeMirror();a&&a.setValue(this._getProgramSource());AbstractChisel.prototype.chiselDidUpdate.call(this)};TerminalChisel.prototype._getCode=function(){return this.isNode()?"":this._getCodeMirror().getValue()};TerminalChisel.prototype._getCodeMirror=function(){return this._codeMirror};TerminalChisel.prototype.hasChanges=function(){var a=this._getProgram();return a&&this._getCode()!==a.childrenToString()};
TerminalChisel.prototype._makeFullProgram=function(){var a=this._getCode();return new (this._getProgram().constructor)(a,void 0,this.getApp())};
TerminalChisel.prototype._getAutoCompleteFn=function(){var a=this;return function(b,c){return new Promise(function(c){setTimeout(function(){for(var d=b.getCursor(),f=b.getLine(d.line),g=d.ch,h=d.ch;g&&/[^\s]/.test(f.charAt(g-1));)--g;for(;h<f.length&&/[^\s]/.test(f.charAt(h));)++h;f=f.slice(g,h).toLowerCase();f=a._makeFullProgram().getAutocompleteWords(f);d=f.length?{list:f,from:CodeMirror.Pos(d.line,g),to:CodeMirror.Pos(d.line,h)}:null;return c(d)},100)})}};
TerminalChisel.prototype._loadCodeMirror=function(){var a=this;if(!this.isNode()){var b=this._getTextarea(),c={lineNumbers:!0,tabSize:1,indentUnit:1,extraKeys:{"Ctrl-Space":"autocomplete"},hintOptions:{hint:this._getAutoCompleteFn()}},d=CodeMirror.fromTextArea(b,c);d.setSize(void 0,this._getHeight());d.on("gutterClick",function(b,c,d,h){a._executeLine(c)});d.on("blur",function(){a._saveChangesCommand()});d.addKeyMap({"Cmd-Enter":function(){var b=d.listSelections()[0].head.line;a._executeLine(b)},
"Shift-Cmd-Enter":function(){var b=d.listSelections()[0].head.line;a._compileLine(b)},"Cmd-S":function(){a._saveChangesCommand();a._updateConsole()}});this._codeMirror=d}};TerminalChisel.prototype._saveChangesCommand=function(){return this._getProgram().autosaveAndReloadWith(this._getCode())};window.TerminalChisel=TerminalChisel;var ThemeChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(ThemeChisel,AbstractChisel);ThemeChisel._mountedChisels=AbstractChisel._mountedChisels;
ThemeChisel.prototype.getBray=function(){var a=this.getTheme();return"@ style\n bern "+CodeMirrorCss+" .CodeMirror{background: transparent; color: "+a.bodyColor+";} .CodeMirror-gutters { background: transparent;}"};
ThemeChisel.prototype.getHakon=function(){var a=this.getTheme();return"html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,audio,video\n margin 0\n padding 0\n border 0\n font-size 100%\n font inherit\n vertical-align baseline\narticle,aside,figcaption,figure,footer,header,hgroup,menu,nav,section\n display block\nbody\n line-height 1.3\nol,ul\n list-style none\ntable\n border-collapse collapse\n border-spacing 0\n\nhtml,body\n width 100%\n height 100%\n margin 0\n padding 0\n font-family "+a.fonts+
"\n color "+a.bodyColor+"\n\nhtml\n background "+a.bodyBackground+"\n\ntable\n padding 0\n margin 0\n border-collapse collapse\n border-spacing 0\n table-layout fixed\n tr,td\n  padding 0\n  margin 0\n\n.ThemeChisel\n display none\n\nh1\n font-size 200%\n\nh2\n font-size 166%\n\nh3\n font-size 133%\n\nh4\n font-size 120%\n\np\n margin 1em 0\n\na\n cursor pointer\n text-decoration none\n color "+a.linkColor+"\n\n::-webkit-scrollbar\n display none\n\n.ui-resizable-handle\n position absolute\n font-size 0.1px\n display block\n -ms-touch-action none\n touch-action none\n\n.ui-resizable-disabled\n .ui-resizable-handle\n  display none\n\n.ui-resizable-autohide\n .ui-resizable-handle\n  display none\n\n.leftButton,.rightButton\n background transparent\n border 0\n\n.BlockTextArea\n padding 5px\n width 100%\n height 100%\n box-sizing border-box\n outline 0\n border 0\n font-size 14px\n font-family "+
a.fonts+"\n resize none\n\n.rightButton\n float right\n\n.bigInput\n display block\n width 100%\n height 34px\n padding 6px 12px\n font-size 14px\n line-height 1.428571429\n vertical-align middle\n border-radius 4px\n box-sizing border-box\n color "+a.mediumBlack+"\n background "+a.backgroundColor+"\n border 1px solid "+a.greyish+"\n box-shadow inset 0 1px 1px "+a.boxShadow+"\n\ntextarea.bigInput\n height auto\n\n.dragOver\n opacity 0.5\n\n#dragOverHelp\n position absolute\n font-size 36px\n width 100%\n height 100%\n z-index 300\n display flex\n align-items center\n justify-content center\n top 0\n left 0\n\n.noTransition\n transition none\n\n.SVGIcon\n fill "+
a.foregroundColor+"\n cursor pointer\n\n.buttonPrimary\n border-radius 2px\n cursor pointer\n border none\n padding 15px 32px\n text-align center\n text-decoration none\n font-size 16px\n color white\n background "+a.successColor+"\n\n.divider\n background "+a.lineColor+"\n height 1px\n margin 10px 0\n width 100%\n\ninput,textarea\n background transparent\n color "+a.foregroundColor+"\n\n.BlockChisel\n position absolute\n background "+a.blockBackgroundColor+"\n border 1px solid "+a.borderColor+"\n z-index 1\n "+
a.disableTextSelect(1)+"\n .BlockPencilButton\n  svg\n   opacity 0\n .ui-resizable-se\n  cursor se-resize\n  width 36px\n  height 36px\n  box-sizing border-box\n  right 1px\n  bottom 1px\n  opacity 0\n  border-right 4px solid "+a.darkerBackground+"\n  border-bottom 4px solid "+a.darkerBackground+"\n  &:hover\n   opacity 1\n &:hover\n  background "+a.backgroundColor+"\n  z-index 2\n  .ui-resizable-se\n   opacity .5\n  .BlockPencilButton\n   svg\n    opacity 1\n    cursor pointer\n    fill "+a.greyish+
"\n    &:hover\n     fill "+a.foregroundColor+"\n .BlockPage\n  overflow hidden\n  width 100%\n  height 100%\n  position relative\n .BlockHeader,.BlockFooter\n  font-size 12px\n  height 30px\n  line-height 30px\n  padding-left 5px\n .BlockBody\n  padding 5px\n  width 100%\n  height calc(100% - 80px)\n  box-sizing border-box\n  &.HeaderLess\n   height calc(100% - 50px)\n .BlockGrabber\n  width 100%\n  height 10px\n  cursor move\n .BlockHeader\n  text-transform uppercase\n  text-align center\n  border-bottom 1px solid "+
a.borderColor+"\n .BlockFooter\n  border-top 1px solid "+a.borderColor+"\n iframe\n  width 100%\n  height 100%\n  border 0"};window.ThemeChisel=ThemeChisel;var CodeMirrorCss=".CodeMirror{font-family:monospace;height:300px;color:#000}.CodeMirror-lines{padding:4px 0}.CodeMirror pre{padding:0 4px}.CodeMirror-scrollbar-filler,.CodeMirror-gutter-filler{background-color:#fff}.CodeMirror-gutters{border-right:0;background-color:#f7f7f7;white-space:nowrap}.CodeMirror-linenumber{padding:0 3px 0 5px;min-width:20px;text-align:right;color:#999;white-space:nowrap}.CodeMirror-guttermarker{color:#000}.CodeMirror-guttermarker-subtle{color:#999}.CodeMirror-cursor{border-left:1px solid #000;border-right:none;width:0}.CodeMirror div.CodeMirror-secondarycursor{border-left:1px solid silver}.cm-fat-cursor .CodeMirror-cursor{width:auto;border:0!important;background:#7e7}.cm-fat-cursor div.CodeMirror-cursors{z-index:1}.cm-animate-fat-cursor{width:auto;border:0;-webkit-animation:blink 1.06s steps(1) infinite;-moz-animation:blink 1.06s steps(1) infinite;animation:blink 1.06s steps(1) infinite;background-color:#7e7}@-moz-keyframes blink{50%{background-color:transparent}}@-webkit-keyframes blink{50%{background-color:transparent}}@keyframes blink{50%{background-color:transparent}}.cm-tab{display:inline-block;text-decoration:inherit}.CodeMirror-rulers{position:absolute;left:0;right:0;top:-50px;bottom:-20px;overflow:hidden}.CodeMirror-ruler{border-left:1px solid #ccc;top:0;bottom:0;position:absolute}.cm-s-default .cm-header{color:blue}.cm-s-default .cm-quote{color:#090}.cm-negative{color:#d44}.cm-positive{color:#292}.cm-header,.cm-strong{font-weight:700}.cm-em{font-style:italic}.cm-link{text-decoration:underline}.cm-strikethrough{text-decoration:line-through}.cm-s-default .cm-keyword{color:#708}.cm-s-default .cm-atom{color:#219}.cm-s-default .cm-number{color:#164}.cm-s-default .cm-def{color:#00f}.cm-s-default .cm-variable-2{color:#05a}.cm-s-default .cm-variable-3,.cm-s-default .cm-type{color:#085}.cm-s-default .cm-comment{color:#a50}.cm-s-default .cm-string{color:#a11}.cm-s-default .cm-string-2{color:#f50}.cm-s-default .cm-meta{color:#555}.cm-s-default .cm-qualifier{color:#555}.cm-s-default .cm-builtin{color:#30a}.cm-s-default .cm-bracket{color:#997}.cm-s-default .cm-tag{color:#170}.cm-s-default .cm-attribute{color:#00c}.cm-s-default .cm-hr{color:#999}.cm-s-default .cm-link{color:#00c}.cm-s-default .cm-error{color:red}.cm-invalidchar{color:red}.CodeMirror-composing{border-bottom:2px solid}div.CodeMirror span.CodeMirror-matchingbracket{color:#0f0}div.CodeMirror span.CodeMirror-nonmatchingbracket{color:#f22}.CodeMirror-matchingtag{background:rgba(255,150,0,.3)}.CodeMirror-activeline-background{background:#e8f2ff}.CodeMirror{position:relative;overflow:hidden;background:#fff}.CodeMirror-scroll{overflow:scroll!important;margin-bottom:-30px;margin-right:-30px;padding-bottom:30px;height:100%;outline:none;position:relative}.CodeMirror-sizer{position:relative;border-right:30px solid transparent}.CodeMirror-vscrollbar,.CodeMirror-hscrollbar,.CodeMirror-scrollbar-filler,.CodeMirror-gutter-filler{position:absolute;z-index:6;display:none}.CodeMirror-vscrollbar{right:0;top:0;overflow-x:hidden;overflow-y:scroll}.CodeMirror-hscrollbar{bottom:0;left:0;overflow-y:hidden;overflow-x:scroll}.CodeMirror-scrollbar-filler{right:0;bottom:0}.CodeMirror-gutter-filler{left:0;bottom:0}.CodeMirror-gutters{position:absolute;left:0;top:0;min-height:100%;z-index:3}.CodeMirror-gutter{white-space:normal;height:100%;display:inline-block;vertical-align:top;margin-bottom:-30px}.CodeMirror-gutter-wrapper{position:absolute;z-index:4;background:none!important;border:none!important}.CodeMirror-gutter-background{position:absolute;top:0;bottom:0;z-index:4}.CodeMirror-gutter-elt{position:absolute;cursor:default;z-index:4}.CodeMirror-gutter-wrapper ::selection{background-color:transparent}.CodeMirror-gutter-wrapper ::-moz-selection{background-color:transparent}.CodeMirror-lines{cursor:text;min-height:1px}.CodeMirror pre{-moz-border-radius:0;-webkit-border-radius:0;border-radius:0;border-width:0;background:transparent;font-family:inherit;font-size:inherit;margin:0;white-space:pre;word-wrap:normal;line-height:inherit;color:inherit;z-index:2;position:relative;overflow:visible;-webkit-tap-highlight-color:transparent;-webkit-font-variant-ligatures:contextual;font-variant-ligatures:contextual}.CodeMirror-wrap pre{word-wrap:break-word;white-space:pre-wrap;word-break:normal}.CodeMirror-linebackground{position:absolute;left:0;right:0;top:0;bottom:0;z-index:0}.CodeMirror-linewidget{position:relative;z-index:2;overflow:auto}.CodeMirror-rtl pre{direction:rtl}.CodeMirror-code{outline:none}.CodeMirror-scroll,.CodeMirror-sizer,.CodeMirror-gutter,.CodeMirror-gutters,.CodeMirror-linenumber{-moz-box-sizing:content-box;box-sizing:content-box}.CodeMirror-measure{position:absolute;width:100%;height:0;overflow:hidden;visibility:hidden}.CodeMirror-cursor{position:absolute;pointer-events:none}.CodeMirror-measure pre{position:static}div.CodeMirror-cursors{visibility:hidden;position:relative;z-index:3}div.CodeMirror-dragcursors{visibility:visible}.CodeMirror-focused div.CodeMirror-cursors{visibility:visible}.CodeMirror-selected{background:#d9d9d9}.CodeMirror-focused .CodeMirror-selected{background:#d7d4f0}.CodeMirror-crosshair{cursor:crosshair}.CodeMirror-line::selection,.CodeMirror-line > span::selection,.CodeMirror-line > span > span::selection{background:#d7d4f0}.CodeMirror-line::-moz-selection,.CodeMirror-line > span::-moz-selection,.CodeMirror-line > span > span::-moz-selection{background:#d7d4f0}.cm-searching{background:#ffa;background:rgba(255,255,0,.4)}.cm-force-border{padding-right:.1px}@media print{.CodeMirror div.CodeMirror-cursors{visibility:hidden}}.cm-tab-wrap-hack:after{content:''}span.CodeMirror-selectedtext{background:none}.CodeMirror-hints{position:absolute;z-index:10;overflow:hidden;list-style:none;margin:0;padding:2px;-webkit-box-shadow:2px 3px 5px rgba(0,0,0,.2);-moz-box-shadow:2px 3px 5px rgba(0,0,0,.2);box-shadow:2px 3px 5px rgba(0,0,0,.2);border-radius:3px;border:1px solid silver;background:#fff;font-size:90%;font-family:monospace;max-height:20em;overflow-y:auto}.CodeMirror-hint{margin:0;padding:0 4px;border-radius:2px;white-space:pre;color:#000;cursor:pointer}li.CodeMirror-hint-active{background:#08f;color:#fff}";
window.CodeMirrorCss=CodeMirrorCss;var Column=function(a,b){this._obj=a;this._rawVector=b;this._sampleSet=lodash.sampleSize(b,30)};Column.prototype.getColumnName=function(){return this._obj.name};Column.prototype.isInvalidValue=function(a){return this.getType().isInvalidValue(a)};Column.prototype._getSample=function(){if(void 0===this._sample){var a=this._getSampleSet();this._sample=a.length?a[0]:""}return this._sample};Column.prototype._getObject=function(){return this._obj};
Column.prototype.getType=function(){this._type||(this._type=this._inferType());return this._type};Column.prototype.isNumericMS=function(){return this.getType().isNumericMS()};Column.prototype.isInt=function(){return this.getType().isInt()};Column.prototype.isTemporal=function(){return this.getType().isTemporal()};Column.prototype.toDisplayString=function(a){return this.getType().toDisplayString(a,this.getFormat())};Column.prototype.isString=function(){return this.getType().isString()};
Column.prototype.isHash=function(){return this.isString()&&!1};Column.prototype.getEntropy=function(){if(void 0!==this._entropy)return this._entropy;var a={},b=1;this.getColumnName();this._getSampleSet().forEach(function(c){a[c]||(b++,a[c]=!0)});return this._entropy=b};Column.prototype.isLink=function(){if(void 0!==this._isLink)return this._isLink;var a=this._getSample();this.isString()&&a&&a.match?this._isLink=a.match(/^(http\:|\/)/)?1:0:this._isLink=!1;return this._isLink};
Column.prototype._getBinder=function(){return this._binder};Column.prototype._getSampleSet=function(){return this._sampleSet};Column.prototype.isUnique=function(){return this.getEntropy()-1===this._getSampleSet().length};Column.prototype.setRank=function(a){this._rank=a};Column.prototype.getRank=function(){return this._rank};
Column.prototype.getTitlePotential=function(){if(this._obj.title)return 1;if(void 0!==this._titlePotential)return this._titlePotential;var a={title:.99,name:.98,label:.97,category:.96},b=this.getColumnName();a[b]?this._titlePotential=a[b]:150<this.getEstimatedTextLength()?this._titlePotential=.01:this.isString()&&!this.isLink()&&this.isUnique()&&!this.isHash()?this._titlePotential=.75:this._titlePotential=0;return this._titlePotential};
Column.prototype.getEstimatedTextLength=function(){if(!this.isString())return 0;if(void 0!==this._estimatedTextLength)return this._estimatedTextLength;this.getColumnName();var a=this._getSampleSet(),b=a.map(function(a){return a&&a.length}).reduce(function(a,b){return a+b},0);return this._estimatedTextLength=Math.floor(b/a.length)};Column.prototype.getAlias=function(){return this._obj.alias?this._obj.alias:this.getColumnName()};
Column.prototype.getFormat=function(){return this._obj.format?this._obj.format:this.getType().getDefaultFormat(this.getColumnName(),this._getSample())};Column.prototype.getMissingDataPercentage=function(){var a=0;this.getColumnName();var b=this._getSampleSet();b.forEach(function(b){void 0!==b&&""!==b||a++});return a/(b.length||1)};Column.prototype.getMap=function(){var a=this._map;return a?a:this._map=this._getVector().set};
Column.prototype._getVector=function(){this._vector||(this._vector=this._createVector());return this._vector};Column.prototype._createVector=function(){var a=this,b=[];this.getColumnName();var c={},d=0,e=0;this._rawVector.forEach(function(f){if(a.isInvalidValue(f))return d++,!0;c[f]?c[f].count++:(c[f]={count:0,index:0},e++);b.push(f)});return{set:c,values:b,incompleteCount:d,uniqueValues:e}};
Column.prototype.getQuintiles=function(){var a=this.getReductions().deciles;return[20,40,60,80,100].map(function(b){return{value:a[b],percent:b/100}})};Column.prototype.getTypeName=function(){return this.getType().getColumnTypeName()};
Column.prototype.toObject=function(){return{name:this.getColumnName(),type:this.getTypeName(),rank:this.getRank(),reduction:this._getObject().reduction,titlePotential:this.getTitlePotential(),isString:this.isString(),isTemporal:this.isTemporal(),isLink:this.isLink(),estimatedTextLength:this.getEstimatedTextLength()}};Column.prototype._getNumericallySortedValuesInIncreasingOrder=function(){var a=this._getVector().values.slice();a.sort(function(a,c){return a>c?1:a<c?-1:0});return a};
Column.prototype.getReductions=function(){this._reductions||(this._reductions=this._getReductionResult(this._getVector(),this));return this._reductions};Column.prototype.getMin=function(){return this.getReductions().min};Column.prototype.getMax=function(){return this.getReductions().max};Column.roundTo=function(a,b){return parseFloat(a.toFixed(b))};
Column.prototype._getReductionResult=function(a,b){var c=a.values,d=c.length,e={};e.incompleteCount=a.incompleteCount;e.uniqueValues=a.uniqueValues;if(!d)return e;a=function(a,b){return a>b?1:a<b?-1:0};var f=c.slice();b.isString()?f.sort():f.sort(a);c=f[0];a=f[0];for(var g=0,h=void 0,k=0,l=void 0,n=0,p=0;p<d;p++){var m=f[p],g=g+m;m>a&&(a=m);m<c&&(c=m);m===l?n++:(l=m,n=1);n>k&&(k=n,h=l)}l=Math.floor(d/2);e.count=d;e.sum=g;e.median=f[l];e.average=g/d;e.min=c;e.max=a;e.range=a-c;e.mode=h;e.modeSize=
k;b.isString()?(e.sum=void 0,e.average=void 0):b.isTemporal()&&(e.sum=void 0);e.deciles={};[10,20,30,40,50,60,70,80,90,99,100].forEach(function(a){var b=Math.floor(a/100*d),b=b===d?b-1:b;e.deciles[a]=f[b]});return e};
Column.prototype._inferType=function(){var a=this._getObject(),b=this.getColumnName(),c=this._getSample();if(a&&a.type&&ColumnTypes[a.type])return ColumnTypes[a.type];var a={number:.5,date:.25,string:.75,feet:.01,object:.1,boolean:.02},d=!isNaN(parseFloat(c))||ColumnTypes.usd.getProbForColumnSpecimen(c),e=ColumnTypes.date.getProbForColumnSpecimen(c);"object"===typeof c&&(a.object=.9);if(!0===c||!1===c)a.boolean=.96;b.match(/(team|name|link|image|description|permalink|title|label|status|thumb|ip|useragent)/i)&&
(a.string=.95);b.match(/(gender|region|category|group|section|sector|field)/i)&&(a.string=.95);b.match(/(height|length)/i)&&c.toString().match(/[0-9]+(\'|\-)[0-9\.]+/)&&ColumnTypes.feet.getProbForColumnSpecimen(c)&&(a.feet=.97);a.number=d?.8:.1;if(ColumnTypes.usd.getProbForColumnSpecimen(c)||!isNaN(c)&&b.match(/^(price|income|cost|revenue|budget|profit|amount|balance)$/i))a.usd=.99;d&&b.match(/(year|born)/i)&&4===c.length&&(a.year=.99);d&&b.match(/(time|second|created|edited)/i)&&10===c.length&&(a.second=
.99);d&&b.match(/(time|second)/i)&&13===c.length&&(a.microsecond=.99);b.match(/(year|date|dob|birthday|day|month|time|birthdate)/i)&&e&&(a.date=.98);"string"===typeof c&&100<c.length&&(a.string=.98);var b=0,d=null,f;for(f in a)a[f]>b&&(b=a[f],d=f);"number"===d&&"string"===typeof c&&c.match(",")&&(d="numberString");"date"===d&&"string"===typeof c&&ColumnTypes.day.getProbForColumnSpecimen(c)&&(d="day");return ColumnTypes[d]};window.Column=Column;var ColumnSpecimen=function(){};
window.ColumnSpecimen=ColumnSpecimen;moment.createFromInputFallback=function(a){a._d=new Date(a._i)};var AbstractColType=function(){};AbstractColType.prototype.toDisplayString=function(a){return a};AbstractColType.prototype.fromStringToNumeric=function(a){return a};AbstractColType.prototype.getDefaultFormat=function(){};AbstractColType.prototype.isTemporal=function(){return!1};AbstractColType.prototype.isString=function(){return!1};AbstractColType.prototype.isInt=function(){return!1};
AbstractColType.prototype._setName=function(a){this._name=a;return this};AbstractColType.prototype.getColumnTypeName=function(){return this._name};AbstractColType.prototype.isNumericMS=function(){return!1};AbstractColType.prototype.isInvalidValue=function(a){return void 0===a||""===a?!0:!1};var AbstractNumeric=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(AbstractNumeric,AbstractColType);AbstractNumeric.prototype.fromStringToNumeric=function(a){return parseFloat(a)};
AbstractNumeric.prototype.isInvalidValue=function(a){return AbstractColType.prototype.isInvalidValue.call(this,a)||isNaN(a)};var AbstractTemporal=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(AbstractTemporal,AbstractColType);AbstractTemporal.prototype.fromStringToMoment=function(a){return moment(parseInt(a))};AbstractTemporal.prototype.isTemporal=function(){return!0};var AbstractCurrency=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(AbstractCurrency,AbstractColType);
var DateCol=function(a){AbstractTemporal.apply(this,arguments)};$jscomp.inherits(DateCol,AbstractTemporal);DateCol.prototype.toDisplayString=function(a,b){b||(b="MM/DD/YY");return"fromNow"===b?moment(parseFloat(a)).fromNow():moment(a).format(b)};DateCol.prototype.fromStringToNumeric=function(a){return 1E3*GetDate.getDate(a).unix()};DateCol.prototype.isNumericMS=function(){return!0};DateCol.prototype.fromStringToMoment=function(a){return GetDate.getDate(a)};
DateCol.prototype.getProbForColumnSpecimen=function(a){return GetDate.getDate(a).isValid()};var AbstractInt=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(AbstractInt,AbstractColType);AbstractInt.prototype.isInt=function(){return!0};AbstractInt.prototype.fromStringToNumeric=function(a){return parseInt(a)};var Int=function(a){AbstractInt.apply(this,arguments)};$jscomp.inherits(Int,AbstractInt);var AbstractTemporalInt=function(a){AbstractInt.apply(this,arguments)};
$jscomp.inherits(AbstractTemporalInt,AbstractInt);var AbstractMicrosecond=function(a){AbstractTemporalInt.apply(this,arguments)};$jscomp.inherits(AbstractMicrosecond,AbstractTemporalInt);AbstractMicrosecond.prototype.toDisplayString=function(a,b){return"fromNow"===b?moment(parseFloat(a)).fromNow():a};AbstractMicrosecond.prototype.isNumericMS=function(){return!0};AbstractMicrosecond.prototype.getDefaultFormat=function(){return"fromNow"};var Microsecond=function(a){AbstractMicrosecond.apply(this,arguments)};
$jscomp.inherits(Microsecond,AbstractMicrosecond);var Second=function(a){AbstractMicrosecond.apply(this,arguments)};$jscomp.inherits(Second,AbstractMicrosecond);Second.prototype.fromStringToNumeric=function(a){return 1E3*parseInt(a)};var Day=function(a){AbstractTemporal.apply(this,arguments)};$jscomp.inherits(Day,AbstractTemporal);Day.prototype.toDisplayString=function(a,b){return moment(a).format(b||"MM/DD/YYYY")};Day.prototype.fromStringToNumeric=function(a){return 1E3*GetDate.getDate(a).startOf("day").unix()};
Day.prototype.fromStringToMoment=function(a){return GetDate.getDate(a).startOf("day")};Day.prototype.fromMomentToNumeric=function(a){return 1E3*a.startOf("day").unix()};Day.prototype.getProbForColumnSpecimen=function(a){a=moment.parseFormat?moment.parseFormat(a):parseFormat;return"MM/DD/YY"===a||"MM/DD/YYYY"===a||"M/D/YYYY"===a};var Week=function(a){AbstractTemporalInt.apply(this,arguments)};$jscomp.inherits(Week,AbstractTemporalInt);Week.prototype.toDisplayString=function(a,b){return moment(a).format("MM/DD/YYYY - WW")};
Week.prototype.fromMomentToNumeric=function(a){return 1E3*a.startOf("week").unix()};Week.prototype.isNumericMS=function(){return!0};var Month=function(a){AbstractTemporalInt.apply(this,arguments)};$jscomp.inherits(Month,AbstractTemporalInt);Month.prototype.toDisplayString=function(a,b){return moment(a).format(b||"MMMM")};Month.prototype.fromMomentToNumeric=function(a){return 1E3*a.startOf("month").unix()};Month.prototype.isNumericMS=function(){return!0};
var Hour=function(a){AbstractTemporalInt.apply(this,arguments)};$jscomp.inherits(Hour,AbstractTemporalInt);Hour.prototype.toDisplayString=function(a,b){return a};Hour.prototype.fromMomentToNumeric=function(a){return parseInt(a.startOf("hour").format("H"))};var HourMinute=function(a){AbstractTemporal.apply(this,arguments)};$jscomp.inherits(HourMinute,AbstractTemporal);HourMinute.prototype.toDisplayString=function(a){return a};HourMinute.prototype.fromStringToNumeric=function(a){return parseFloat(GetDate.getDate(a).format("H.m"))};
var Minute=function(a){AbstractTemporal.apply(this,arguments)};$jscomp.inherits(Minute,AbstractTemporal);Minute.prototype.toDisplayString=function(a,b){return moment(a).format("m")};Minute.prototype.fromStringToNumeric=function(a){return 1E3*GetDate.getDate(a).startOf("minute").unix()};var Year=function(a){AbstractTemporalInt.apply(this,arguments)};$jscomp.inherits(Year,AbstractTemporalInt);Year.prototype.fromMomentToNumeric=function(a){return parseInt(a.format("YYYY"))};
var Feet=function(a){AbstractNumeric.apply(this,arguments)};$jscomp.inherits(Feet,AbstractNumeric);Feet.prototype.getProbForColumnSpecimen=function(a){return!isNaN(FeetToInches(a))};Feet.prototype.fromStringToNumeric=function(a){return FeetToInches(a)};Feet.prototype.toDisplayString=function(a,b){a=parseFloat(a);return Math.floor(a/12)+"'"+Math.round(a%12)+'"'};var USD=function(a){AbstractCurrency.apply(this,arguments)};$jscomp.inherits(USD,AbstractCurrency);
USD.prototype.toDisplayString=function(a,b){return b?numeral(a).format(b):a};USD.prototype.fromStringToNumeric=function(a){return parseFloat(a.toString().replace(/[\$\, \%]/g,""))};USD.prototype.getProbForColumnSpecimen=function(a){return a&&a.match&&!!a.match(/^\$[0-9\.\,]+$/)};USD.prototype.getDefaultFormat=function(){return"$(0a)"};var NumberCol=function(a){AbstractNumeric.apply(this,arguments)};$jscomp.inherits(NumberCol,AbstractNumeric);
NumberCol.prototype.toDisplayString=function(a,b){return"percent"===b?numeral(parseFloat(a)).format("0.00")+"%":b&&!isNaN(a)&&Infinity!==a?numeral(a).format(b):a};NumberCol.prototype.getDefaultFormat=function(a,b){if(a.match(/^(mile|pound|inch|feet)s?$/i))return"0.0";if(a.match(/^(calorie|steps)s?$/i)||b&&!b.toString().includes("."))return"0,0"};var NumberString=function(a){AbstractNumeric.apply(this,arguments)};$jscomp.inherits(NumberString,AbstractNumeric);
NumberString.prototype.toDisplayString=function(a,b){return b?numeral(a).format(b):a};NumberString.prototype.getDefaultFormat=function(){return"0,0"};NumberString.prototype.fromStringToNumeric=function(a){return parseFloat(a.toString().replace(/[\$\, \%]/g,""))};var AbstractStringCol=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(AbstractStringCol,AbstractColType);AbstractStringCol.prototype.isString=function(){return!0};
var StringCol=function(a){AbstractStringCol.apply(this,arguments)};$jscomp.inherits(StringCol,AbstractStringCol);var UrlCol=function(a){AbstractStringCol.apply(this,arguments)};$jscomp.inherits(UrlCol,AbstractStringCol);var TextCol=function(a){AbstractStringCol.apply(this,arguments)};$jscomp.inherits(TextCol,AbstractStringCol);var AbstractCodeCol=function(a){AbstractStringCol.apply(this,arguments)};$jscomp.inherits(AbstractCodeCol,AbstractStringCol);
var CodeCol=function(a){AbstractCodeCol.apply(this,arguments)};$jscomp.inherits(CodeCol,AbstractCodeCol);var HTMLCol=function(a){AbstractCodeCol.apply(this,arguments)};$jscomp.inherits(HTMLCol,AbstractCodeCol);var AbstractPathCol=function(a){AbstractStringCol.apply(this,arguments)};$jscomp.inherits(AbstractPathCol,AbstractStringCol);var PathCol=function(a){AbstractPathCol.apply(this,arguments)};$jscomp.inherits(PathCol,AbstractPathCol);var DirCol=function(a){AbstractPathCol.apply(this,arguments)};
$jscomp.inherits(DirCol,AbstractPathCol);var ObjectCol=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(ObjectCol,AbstractColType);var BooleanCol=function(a){AbstractColType.apply(this,arguments)};$jscomp.inherits(BooleanCol,AbstractColType);BooleanCol.prototype.fromStringToNumeric=function(a){return"true"===a.toString()?1:0};
var ColumnTypes={microsecond:Microsecond,second:Second,date:DateCol,day:Day,week:Week,month:Month,hour:Hour,hourMinute:HourMinute,minute:Minute,year:Year,feet:Feet,usd:USD,number:NumberCol,numberString:NumberString,string:StringCol,text:TextCol,path:PathCol,dir:DirCol,code:CodeCol,html:HTMLCol,url:UrlCol,object:ObjectCol,boolean:BooleanCol,int:Int};Object.keys(ColumnTypes).forEach(function(a){ColumnTypes[a]=new ColumnTypes[a];ColumnTypes[a]._setName(a)});window.ColumnTypes=ColumnTypes;
var FeetToInches=function(a){if("number"===typeof a)return a;if(!a)return null;var b=0,c=a.search(/[^0-9\.]/);if(1>c)return b=parseFloat(a.replace(/[^0-9\.]/g,"")),isNaN(b)?null:12*b;var d=parseFloat(a.substr(0,c).replace(/[^0-9\.]/g,""));a=parseFloat(a.substr(c).replace(/[^0-9\.]/g,""));isNaN(d)||(b+=12*d);isNaN(a)||(b+=a);return b};window.FeetToInches=FeetToInches;moment.createFromInputFallback=function(a){a._d=new Date(a._i)};
var GetDate={getDateAsUnix:function(a){return GetDate.getDate(a).unix()},getDateAsUnixUtx:function(a){return GetDate.getDate(a,moment.utc).unix()},getDate:function(a,b){b=void 0===b?moment:b;var c=b(a);if(c.isValid())return c;if("string"===typeof a&&a.match(/^[0-9]{8}$/)){var c=parseInt(a.substr(0,2)),d=parseInt(a.substr(2,2)),e=parseInt(a.substr(4,2)),f=parseInt(a.substr(6,2)),g=parseInt(a.substr(0,4)),h=parseInt(a.substr(4,4)),e=13>e,k=32>f,f=13>f,g=1E3<g&&2100>g;return c=13>c&&32>d&&1E3<h&&2100>
h?b(a,"MMDDYYYY"):g&&e&&k?b(a,"YYYYMMDD"):g&&f?b(a,"YYYYDDMM"):b(a,"DDMMYYYY")}return"string"===typeof a&&a.match(/^[0-9]{2}\/[0-9]{4}$/)?b(a,"MM/YYYY"):!a.match||a.match(/[^0-9]/)||(d=parseFloat(a),isNaN(d))?c:10===a.length?b(1E3*d):b(d)}};window.GetDate=GetDate;var AbstractContextMenuChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractContextMenuChisel,AbstractChisel);AbstractContextMenuChisel._mountedChisels=AbstractChisel._mountedChisels;
AbstractContextMenuChisel.prototype.getHakon=function(){var a=this.getTheme();return".AbstractContextMenuChisel\n position fixed\n overflow scroll\n max-height 100%\n z-index 221\n background "+a.contextMenuBackground+"\n border 1px solid "+a.borderColor+"\n box-shadow 0 1px 3px 0 "+a.boxShadow+"\n font-size 14px\n a\n  display block\n  padding 3px\n  font-size 14px\n  text-decoration none\n  color "+a.darkBlack+"\n  &:hover\n   color "+a.white+"\n   background "+a.hoverBackground};
AbstractContextMenuChisel.prototype.getBray=function(){return"@ div\n class AbstractContextMenuChisel "+this.constructor.name+TreeNotation.nest(this.getContextMenuBodyBray(),1)};
AbstractContextMenuChisel.prototype.chiselDidMount=function(){var a=this.getStump(),b=this.getApp(),c=b.getWillowDocument(),d=c.getBodyStump().getShadow(),e=function(){d.offShadowEvent(ShadowEvents.click,e);b.closeAllContextMenus()};setTimeout(function(){return d.onShadowEvent(ShadowEvents.click,e)},100);var f=b.getMouseEvent(),c=c.getWindowSize();a.setStumpCss(this._getContextMenuPosition(c.width,c.height,f.clientX,f.clientY,a.getShadow()))};
AbstractContextMenuChisel.prototype._getContextMenuPosition=function(a,b,c,d,e){var f=c,g=e.getShadowOuterWidth();b=e.getShadowOuterHeight()+d-b;0<b&&(d-=b);0<g+f-a&&(f=c-g-5);0>d&&(d=0);return{left:f,top:d}};window.AbstractContextMenuChisel=AbstractContextMenuChisel;var BlockContextMenuChisel=function(a){return AbstractContextMenuChisel.apply(this,arguments)||this};$jscomp.inherits(BlockContextMenuChisel,AbstractContextMenuChisel);BlockContextMenuChisel._mountedChisels=AbstractContextMenuChisel._mountedChisels;
BlockContextMenuChisel.prototype.getContextMenuBodyBray=function(){return"@ a\n data-onClickCommand app fetchAndReloadFocusedProgramCommand\n bern Reload\n@ a\n tabindex -1\n data-onClickCommand context copyBlockCommand\n bern Copy block with inputs\n@ a\n data-onClickCommand context copyDataCommand\n value \t\n bern Copy data as tsv\n@ a\n data-onClickCommand context _exportDataCommand\n bern Export data to csv file\n"+this.getApp().getTargetNode().getContextMenuBray()};
window.BlockContextMenuChisel=BlockContextMenuChisel;var ProgramContextMenuChisel=function(a){return AbstractContextMenuChisel.apply(this,arguments)||this};$jscomp.inherits(ProgramContextMenuChisel,AbstractContextMenuChisel);ProgramContextMenuChisel._mountedChisels=AbstractContextMenuChisel._mountedChisels;ProgramContextMenuChisel.prototype.getContextMenuBodyBray=function(){return this.getApp().getMountedProgram().getContextMenuCommandsBray()};window.ProgramContextMenuChisel=ProgramContextMenuChisel;
var CrystalProgram=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(CrystalProgram,TreeNotation);CrystalProgram.prototype.parseNodeType=function(a){return CrystalCommandNode};var CrystalArgNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(CrystalArgNode,TreeNotation);var CrystalCommandNode=function(a){return CrystalProgram.apply(this,arguments)||this};$jscomp.inherits(CrystalCommandNode,CrystalProgram);
CrystalCommandNode.prototype.parseNodeType=function(a){return a.startsWith("%%")?CrystalArgNode:CrystalProgram.prototype.parseNodeType.call(this,a)};CrystalCommandNode.prototype.getArgs=function(){var a=this.getChildren().filter(function(a){return a instanceof CrystalArgNode}).map(function(a){return a.getBeamWithChildren()}),b=this.getWord(0)+"Command",a=a.length?a:this.getWords(1);a.unshift(b);return a};
CrystalCommandNode.prototype.execute=function(a){var b=this;return a.executeCommandLine(this.getArgs()).then(function(){return CrystalProgram.prototype.execute.call(b,a)})};window.CrystalProgram=CrystalProgram;var SubTuple=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(SubTuple,TreeNotation);SubTuple.prototype.getParseErrorCount=function(){return 0};SubTuple.prototype.getTypeLine=function(){return"instruction"};
var AbstractTuple=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(AbstractTuple,TreeNotation);AbstractTuple.prototype.getTupleName=function(){return this.getWord(1)};AbstractTuple.prototype.getProbability=function(){var a=this.findBeam(BlockConstants.percentage);return a?parseFloat(a):.01};AbstractTuple.prototype.getTypeLine=function(){return"instruction"};
AbstractTuple.prototype._getBlockCommandDropdownBray=function(a,b){a=a.map(function(a){return" @ option\n  value "+a+"\n  bern "+a+"\n  "+(b===a?"selected":"notselected")}).join("\n");return"@ select\n data-onChangeCommand block changeTupleCommand\n name "+this.getTupleName()+"\n @ option\n"+a};AbstractTuple.prototype.getTupleTypeName=function(){return this.getWord(0).substr(1)};AbstractTuple.prototype.getDescription=function(){return this.findBeam("description")||""};
AbstractTuple.prototype.parseNodeType=function(a){return SubTuple};AbstractTuple.prototype._getDefaultValue=function(){var a=this.getWords(2),a=a.length?a.join(" "):"";return this.has("default")?this.getNode("default").getBeamWithChildren():a};AbstractTuple.prototype._parseValue=function(a){return a};AbstractTuple.prototype.isMonad=function(){return this.has("monad")};
AbstractTuple.prototype._getUserValue=function(a){var b=this._getDefaultValue();if(this.has("const"))return b;var c=a.getNode(this.getTupleName()),d=this.isMonad()&&a.getBeam(),c=c&&c.getBeamWithChildren()||d||void 0;return void 0===c&&void 0!==b?b:c?this.has("templateString")&&c.includes("{")?a.getProgram().format(c):c:c};AbstractTuple.prototype.toFormBray=function(a){return"@ input\n data-onChangeCommand block changeTupleCommand\n name "+this.getTupleName()+"\n value "+a};window.AbstractTuple=AbstractTuple;
var AlphaNumericTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(AlphaNumericTuple,AbstractTuple);AlphaNumericTuple.prototype._parseValue=function(a){return(void 0===a?"":a).replace(/[^a-z0-9A-Z]/g,"")};window.AlphaNumericTuple=AlphaNumericTuple;var BooleanTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(BooleanTuple,AbstractTuple);BooleanTuple.prototype._parseValue=function(a){return"true"===a?!0:!1};
BooleanTuple.prototype.toFormBray=function(a){return"@ input\n data-onChangeCommand block changeTupleCommand\n name "+this.getTupleName()+"\n type checkbox\n "+(!0===a?"checked":"unchecked")};window.BooleanTuple=BooleanTuple;var ColumnDependentTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(ColumnDependentTuple,AbstractTuple);
ColumnDependentTuple.prototype._parseValue=function(a,b){var c=b.getInputBinder(),d=c.getColumnsMap(),e=this.getNode("auto");if(d[a])return a;if(e){if(e.getBeam())return this._getAutoColumn(b,e.getBeam());a=c.getColumnsByImportance();if(a=a.length&&a[0].getColumnName())return a}};ColumnDependentTuple.prototype.toFormBray=function(a,b){b=b.getInputBinder().getColumnNames();return this._getBlockCommandDropdownBray(b,a)};
ColumnDependentTuple.prototype._getAutoColumn=function(a,b){a=a.getInputBinder();b=b.split(",");var c=b.filter(function(a){return a.includes("=")}).map(function(a){return a.split("=")}),d=function(a){return c.every(function(b){return void 0!==a[b[0]]&&a[b[0]]().toString()===b[1]})};a=a.getColumnsArray().filter(function(a){return d(a)});var e=b.find(function(a){return!a.includes("=")});b=a;e&&(b=lodash.sortBy(b,function(a){return a[e]()}).reverse());if(b.length)return b[0].getColumnName()};
window.ColumnDependentTuple=ColumnDependentTuple;var Definition=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(Definition,TreeNotation);Definition.prototype.parseNodeType=function(a){if(a.startsWith("&")){var b={boolean:BooleanTuple,int:IntTuple,prob:ProbTuple,format:FormatTuple,alphanumeric:AlphaNumericTuple,plaintext:PlainTextTuple,quick:QuickTuple,slang:SlangTuple,column:ColumnDependentTuple,enum:EnumTuple};a=a.split(" ")[0].substr(1);return b[a]||OtherTuple}return TreeNotation};
Definition.prototype.getDoc=function(){return this.getBase()};Definition.prototype.getMonadName=function(){return this.getDefinitionTuples().filter(function(a){return a.isMonad()}).map(function(a){return a.getTupleName()}).join("")};Definition.prototype.getBeamPattern=function(){return this._getExtended().findBeam("beamPattern")};Definition.prototype.getDescription=function(){return this.findBeam("description")||""};
Definition.prototype.getSvg=function(){return this._getExtended().findBeam("svg")||"table"};Definition.prototype._getExtended=function(){this._extended||(this._extended=this._makeExtended());return this._extended};Definition.prototype._makeExtended=function(){var a=this.getGraph(),b=new Definition;a.forEach(function(a){b.extend(a)});return b};
Definition.prototype._loadCss=function(a){var b=this._getExtended().findBeam("css");if(b){var c=a.getServerPath();a.getWillowDocument().getBodyStump().insertChildNode(b.split(" ").map(function(a){return"@ link\n rel stylesheet\n media screen\n href "+(c+a)}).join("\n"))}};Definition.prototype.executeLoadDefinitionCodeOrGetLoadingPromise=function(a){this._loadCss(a);var b=this.getDefinitionJSClass(),c=this._getExtended().findBeam("script"),d=a.getServerPath(),c=c?c.match(/^https\:/)?c:d+c:void 0;return a.getWillowDocument().appendScript(c).then(function(){return b.loadCode()})};
Definition.prototype.getSuggestedSize=function(){var a=(this._getExtended().findBeam("size")||"280 220").split(" ").map(function(a){return parseInt(a)});return{width:a[0],height:a[1]}};Definition.prototype.getDefinitionTuples=function(){var a=[];this.getGraph().forEach(function(b){b.getChildrenByNodeType(AbstractTuple).forEach(function(b){a.push(b)})});return a};
Definition.prototype.computeStruct=function(a){var b={};this.getDefinitionTuples().forEach(function(c){var d=c._getUserValue(a);b[c.getTupleName()]=c._parseValue(d,a)});return b};Definition.prototype.getDefinitionJSClass=function(){if(this._class)return this._class;var a=this._getExtended().findBeam("require").split(" "),b=a[0],c=a[1],d="undefined"!==typeof require,a=d?process:window;d&&!a[b]&&(c=require(c),a[c.name]=c);return this._class=a[b]};
Definition.prototype.getPercentage=function(){var a=this.findBeam(BlockConstants.percentage);return a?parseFloat(a):0};window.Definition=Definition;var DictionaryProgram=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(DictionaryProgram,TreeNotation);DictionaryProgram.prototype.parseNodeType=function(a){return Definition};
DictionaryProgram.prototype.getTopNodeTypes=function(){var a=this.getChildren().slice(0);a.sort(Util.sortByAccessor(function(a){return a.getPercentage()}));a.reverse();return a.map(function(a){return a.getBase()})};DictionaryProgram.prototype.parseNodeTypeFromDictionary=function(a,b){a=b.split(" ")[0];return(a=(a=this._getDefinitionMap()[a])&&a.getDefinitionJSClass())||b.trim().length?a:BlankLine};DictionaryProgram.prototype.getDocs=function(){return this.toString()};
DictionaryProgram.prototype._getDefinitionMap=function(){if(this._definitionMap)return this._definitionMap;var a={};this.getChildren().forEach(function(b){a[b.getBase()]=b});return this._definitionMap=a};DictionaryProgram.prototype.getDefinitionByName=function(a){return this._getDefinitionMap()[a.toLowerCase()]||this.getDidYouMeanDefinition()};DictionaryProgram.prototype.getBlockNames=function(){return Object.keys(this._getDefinitionMap())};DictionaryProgram.prototype.getDidYouMeanDefinition=function(){return this.getDefinitionByName(">didyoumean")};
DictionaryProgram.prototype.loadDefinitionCode=function(a,b){this._loadedDefinitions||(this._loadedDefinitions={});this._loadedDefinitions[a]||(this._loadedDefinitions[a]=this.getDefinitionByName(a).executeLoadDefinitionCodeOrGetLoadingPromise(b));return this._loadedDefinitions[a]};window.DictionaryProgram=DictionaryProgram;var EnumTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(EnumTuple,AbstractTuple);
EnumTuple.prototype.getChoices=function(){var a=this.getNode("options"),b={};a.length?a.getChildren().forEach(function(a){b[a.getBase()]=a.getBeam()}):a.getBeam().split(" ").forEach(function(a){b[a]=a});return b};EnumTuple.prototype._parseValue=function(a){return this.getChoices()[a]?a:void 0};EnumTuple.prototype.toFormBray=function(a){var b=Object.keys(this.getChoices());return this._getBlockCommandDropdownBray(b,a)};window.EnumTuple=EnumTuple;
var FormatTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(FormatTuple,AbstractTuple);FormatTuple.prototype.toFormBray=function(a){var b=(new CardParser).getEncodingNames();return this._getBlockCommandDropdownBray(b,a)};window.FormatTuple=FormatTuple;var IntTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(IntTuple,AbstractTuple);IntTuple.prototype._parseValue=function(a){return parseInt(a)};
IntTuple.prototype.toFormBray=function(a){return"@ input\n data-onChangeCommand block changeTupleCommand\n name "+this.getTupleName()+"\n type number\n value "+a};window.IntTuple=IntTuple;var OtherTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(OtherTuple,AbstractTuple);OtherTuple.prototype.getParseErrorCount=function(){return this.getTopDownArray().length};window.OtherTuple=OtherTuple;
var PlainTextTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(PlainTextTuple,AbstractTuple);PlainTextTuple.prototype._parseValue=function(a){return Format.stripHtml(void 0===a?"":a)};window.PlainTextTuple=PlainTextTuple;var ProbTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(ProbTuple,AbstractTuple);ProbTuple.prototype._parseValue=function(a){return parseFloat(a)};window.ProbTuple=ProbTuple;
var QuickTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(QuickTuple,AbstractTuple);QuickTuple.prototype._parseValue=function(a){return Format.linkify(Format.stripHtml(void 0===a?"":a))};window.QuickTuple=QuickTuple;var SlangTuple=function(a){return AbstractTuple.apply(this,arguments)||this};$jscomp.inherits(SlangTuple,AbstractTuple);
SlangTuple.prototype.toFormBray=function(a){return"@ textarea\n data-onChangeCommand block changeTupleCommand\n name "+this.getTupleName()+"\n bern"+TreeNotation.nest(a,2)};window.SlangTuple=SlangTuple;var GlobalShortcutNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(GlobalShortcutNode,TreeNotation);GlobalShortcutNode.prototype.getKeyCombo=function(){return this.getWord(3)};GlobalShortcutNode.prototype.getFn=function(){return this.getWord(2)};
GlobalShortcutNode.prototype.getCategory=function(){return this.getWord(1)};GlobalShortcutNode.prototype.getDescription=function(){return this.getWords(4).join(" ")};GlobalShortcutNode.prototype.isEnabled=function(){return!0};GlobalShortcutNode.prototype.execute=function(a){if(!this.isEnabled(a))return!1;var b=this.getFn();a.logCommand("app "+b);a[b]()};var MountedShortcutNode=function(a){return GlobalShortcutNode.apply(this,arguments)||this};$jscomp.inherits(MountedShortcutNode,GlobalShortcutNode);
MountedShortcutNode.prototype.isEnabled=function(a){return!!a.getMountedProgram()};var DrumsErrorNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(DrumsErrorNode,TreeNotation);var Drums=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(Drums,TreeNotation);Drums.prototype.parseNodeType=function(a){return a.startsWith("panel")?GlobalShortcutNode:a.startsWith("mounted")?MountedShortcutNode:DrumsErrorNode};window.Drums=Drums;
var AbstractFireBlock=function(a){return AbstractBlockChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractFireBlock,AbstractBlockChisel);AbstractFireBlock._mountedChisels=AbstractBlockChisel._mountedChisels;AbstractFireBlock.loadCode=AbstractBlockChisel.loadCode;AbstractFireBlock.prototype.getHakon=function(){return".AbstractFireBlock\n input\n  border 0\n  font-size 16px"};AbstractFireBlock.prototype.getDependencyTimestamps=function(){return[]};
AbstractFireBlock.prototype.getBlockBodyBray=function(){var a=this,b=this.getDefinition(),c=Icons(b.getSvg(),14),d=this.getBeamPatternWords(),e=d.length-1,d=d.map(function(b,c){var d=c+1;c=(e===c?a.getWords(d).join(" "):a.getWord(d))||"";return" @ input\n  placeholder "+b+"\n  value "+c+"\n  name "+d+"\n  data-onChangeCommand chisel changeWordCommand"}).join("\n");return"@ div\n bern "+c+" "+b.getDescription()+"\n@ div\n"+d};
AbstractFireBlock.prototype.toJavascript=function(a){a=void 0===a?0:a;var b=this.getDefinition()._getExtended(),c=b.findBeam("toJS")||"",d=this.getBeamPatternWords(),e=this.getWords(1),f={},g=d.length-1,h=b.findBeam("joinLastBy")||" ";d.forEach(function(a,b){f[a]=b===g?e.slice(b).join(h):e[b]});var c=(new TreeNotation(f)).format(c),b=b.getNode("hasBlock"),k=" ".repeat(a);return b?k+c+" {\n"+this.getChildrenByNodeType(AbstractBlockChisel).map(function(b){return k+b.toJavascript(a+2)}).join("\n")+"\n"+
k+"}\n":k+c};window.AbstractFireBlock=AbstractFireBlock;var FireDictionary='>block\n &outputPoint pin\n  percentage .2\n require AbstractBlockChisel /aientist/client/blocks/AbstractBlockChisel.js\n &boolean visible true\n>settings >block\n &boolean visible false\n &enum layout custom\n  percentage .1\n  options custom tree bin\n require SettingsBlock /aientist/client/blocks/SettingsBlock.js\njs >block\n require AbstractFireBlock /aientist/client/fire/AbstractFireBlock.js\n size 280 160\nassignment js\n>command >block\n>didyoumean >command\n require DidYouMeanBlock /aientist/client/blocks/DidYouMeanBlock.js\n>morph >command\n size 420 400\n require MorphBlock /aientist/client/blocks/MorphBlock.js\n:: js\n description Print a variable to the console\n beamPattern identifier+\n toJS console.log({identifier+})\n percentage .5\n svg printer\n joinLastBy , \n::$ js\n description Print a string to the console\n beamPattern word+\n toJS console.log("{word+}")\n percentage .1\n svg printer\nrequire js\n description Require Something\n svg import\n beamPattern identifier path\n toJS const {identifier} = require("{path}")\n percentage .1\nexport js\n description Export This\n svg export\n beamPattern identifier\n toJS module.exports = {identifier}\n percentage .1\n=# assignment\n description Number Assignment\n beamPattern identifier number\n toJS const {identifier} = {number}\n percentage .3\n svg hashtag\n=$ assignment\n description String Assignment\n beamPattern identifier word+\n toJS const {identifier} = "{word+}"\n percentage .2\n svg font-1\n=+ assignment\n description Add Numbers\n beamPattern identifier number+\n joinLastBy  + \n svg add\n toJS const {identifier} = {number+}\n percentage .1\n=< assignment\n description Less than test\n beamPattern identifier number number\n toJS const {identifier} = {number} < {number}\n percentage .1\n svg lt\n=<= assignment\n description Less than or equal to test\n beamPattern identifier number number\n toJS const {identifier} = {number} <= {number}\n percentage .1\n svg lt-eq\n=> assignment\n description Greater than test\n beamPattern identifier number number\n toJS const {identifier} = {number} > {number}\n percentage .1\n=- =+\n description Subtract Numbers\n joinLastBy  - \n svg minus\n=/ =+\n description Divide Numbers\n joinLastBy  / \n=% =+\n description Modulo Numbers\n joinLastBy %\n=* =+\n description Multiply Numbers\n joinLastBy  * \n svg multiply\n=~ assignment\n description Mutable Number Assignment\n beamPattern identifier number\n toJS let {identifier} = {number}\n-- js\n description Decrement\n beamPattern identifier\n toJS {identifier}--\n percentage .1\n++ js\n description Increment\n percentage .3\n beamPattern identifier\n toJS {identifier}++\n=#+ assignment\n description Number Array Assignment\n beamPattern identifier number+\n percentage .4\n toJS const {identifier} = [{number+}]\n joinLastBy , \n=>> assignment\n description Function Call\n percentage .5\n svg call\n beamPattern identifier functionIdentifier parameter+\n toJS const {identifier} = {functionIdentifier}({parameter+})\n joinLastBy , \n>> js\n description Function call ignore result.\n percentage .1\n svg call\n beamPattern functionIdentifier parameter+\n toJS {functionIdentifier}({parameter+})\n joinLastBy , \n=.>> assignment\n description Method Call\n percentage .5\n beamPattern identifier instanceIdentifier methodName parameter+\n toJS const {identifier} = {instanceIdentifier}.{methodName}({parameter+})\n joinLastBy , \nreturn js\n beamPattern identifier\n toJS return {identifier}\n percentage .1\n svg nw\n=fn assignment\n description Function Assignment\n beamPattern functionIdentifier parameter+\n toJS const {functionIdentifier} = ({parameter+}) =>\n percentage .1\n svg function\n hasBlock\n joinLastBy , \n## js\n hasBlock\n description Block of code\n svg fork\n beamPattern identifier\n percentage .2\n toJS /* {identifier} */\nif js\n hasBlock\n description If block\n svg fork\n beamPattern identifier\n percentage .2\n toJS if ({identifier})\nwhile js\n hasBlock\n description While block\n beamPattern identifier\n percentage .1\n toJS while ({identifier})\nclass js\n hasBlock\n description Class Assignment\n beamPattern identifier\n percentage .2\n toJS class {identifier}\nsubclass class\n percentage .2\n description Subclass Assignment\n beamPattern identifier parentIdentifier\n toJS class {identifier} extends {parentIdentifier}';
window.FireDictionary=FireDictionary;var FireProgram=function(a){return AbstractProgramChisel.apply(this,arguments)||this};$jscomp.inherits(FireProgram,AbstractProgramChisel);FireProgram._mountedChisels=AbstractProgramChisel._mountedChisels;FireProgram.prototype.getDictionaryString=function(){return FireDictionary};FireProgram.prototype.getExtensionName=function(){return"fire"};FireProgram.prototype.compilesTo=function(){return"js"};FireProgram.prototype.buildProgram=function(){return this.getChildrenByNodeType(AbstractBlockChisel).map(function(a){return a.toJavascript()}).filter(function(a){return a}).join("\n")};
FireProgram.prototype.execute=function(){var a=[],b=console.log;console.log=function(b){for(var c=[],e=0;e<arguments.length;++e)c[e-0]=arguments[e];return a.push(c)};eval(this.buildProgram());console.log=b;b=a.join("\n");console.log(b);return Promise.resolve(b)};window.FireProgram=FireProgram;var AbstractFlowBlock=function(a){return AbstractBlockChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractFlowBlock,AbstractBlockChisel);AbstractFlowBlock._mountedChisels=AbstractBlockChisel._mountedChisels;
AbstractFlowBlock.loadCode=AbstractBlockChisel.loadCode;AbstractFlowBlock.prototype.getCardClass=function(){return ObjectBackedCard};AbstractFlowBlock.prototype.getPipishInput=function(){return this.getStruct().slang||this.getInputBinder().getFirstColumnAsString()||""};AbstractFlowBlock.prototype.openCardEditorByIndexCommand=function(a){return this._openCardEditor(this.getInputBinder().getCards()[a])};AbstractFlowBlock.prototype.openCardEditorByPuidCommand=function(a){return this._openCardEditor(this._getCardByPuid(a))};
AbstractFlowBlock.prototype._openCardEditor=function(a){var b=this.getApp();b.setTargetNode(a);return b.toggleAndRender("cardEditorModal")};AbstractFlowBlock.prototype._getCardByPuid=function(a){a=parseInt(a);return this.getInputBinder().getCards().find(function(b){return b.getPuid()===a})};
AbstractFlowBlock.prototype.getRequiredTable=function(a){a=this.mapTupleNamesToColumnNames(a);var b=this.getOutputBinder();return a.map(function(a){return b.getBinderColumnByName(a)}).some(function(a){return!a})?[]:this.getCardsAsCsvArray(a)};AbstractFlowBlock.prototype.getCardsWithStructQuery=function(){var a=this.getLimit(),b=this.getStruct().orderBy;return this.getOutputBinder().getSortedCardsWithLimit(b,a)};
AbstractFlowBlock.prototype.getCardsAsCsvArray=function(a){var b=this.getCardsWithStructQuery().map(function(b){return b.getAsArray(a)});b.unshift(a);return b};AbstractFlowBlock.prototype.copyDataCommand=function(a){this.getApp().getWillowDocument().copyTextToClipboard(this.getOutputBinder().toDelimited(a));return Promise.resolve()};
AbstractFlowBlock.prototype._exportDataCommand=function(){this.getApp().getWillowDocument().downloadFile(this.getOutputBinder().toDelimited(","),this.getBase()+".csv","text/csv")};
AbstractFlowBlock.prototype.getRequiredTableWithDates=function(a){var b=this.getOutputBinder(),c=this.mapTupleNamesToColumnNames(a).map(function(a){return b.getBinderColumnByName(a)}),d=this.getRequiredTable(a);if(!d.length)return d;a=c.map(function(a,b){return a.isNumericMS()?b:-1}).filter(function(a){return-1<a});if(!a.length)return d;for(var c=d.length,e={dataIndex:1};e.dataIndex<c;e={dataIndex:e.dataIndex},e.dataIndex++)a.forEach(function(a){return function(b){d[a.dataIndex][b]=new Date(d[a.dataIndex][b])}}(e));
return d};AbstractFlowBlock.prototype.getTTL=function(){return this._ttl||0};AbstractFlowBlock.prototype.openInsertCardModalCommand=function(){var a=this.getApp();a.setTargetNode(this);return a.toggleAndRender("insertCardModal")};AbstractFlowBlock.prototype.openInsertCardsModalCommand=function(){return this.getApp().setTargetNode(this).toggleAndRender("insertCardsModal")};AbstractFlowBlock.prototype.createCardsFromTNCommand=function(a){return this.createCards((new CardParser).parse(a,"tree"))};
AbstractFlowBlock.prototype.createCards=function(a){return Promise.resolve()};AbstractFlowBlock.prototype.fetchCards=function(){return Promise.resolve([])};AbstractFlowBlock.prototype.getDependencyTimestamps=function(){return[this.getInputBinder().getCTime()]};
AbstractFlowBlock.prototype.executeLoadData=function(){var a=this,b=this._getNow();this._timeLastLoadStarted=b;var c=this.fetchCards();c instanceof Promise||console.error("promise error");return c.then(function(c){if(a._timeLastLoadStarted!==b)return Promise.resolve();var d=lodash.flatten(a.getStructColumns(),a.getBlockClassColumns()),f=a.getCardClass();a._outputBinder=new Binder(a,c,d,f);a._ttl=a._getNow()-b;return Promise.all(a.getChildBlocks().map(function(a){return a.executeLoadData()})).then(function(b){return a})}).catch(function(b){a.handleBlockError(b)})};
AbstractFlowBlock.prototype.getInspection=function(){var a=this.getInputBinder(),b=this.getOutputBinder(),c=b.getColumnsArrayOfObjects(),d=a.getColumnsArrayOfObjects(),e=a.getCardCount(),f=b.getCardCount();return AbstractBlockChisel.prototype.getInspection.call(this)+"\n@ div\n bern Input cards: "+e+" Output cards: "+f+"\n@ div\n bern Load time: "+this.getTTL()+" Render time: "+this.getNewestTimeToRender()+"\n@ div\n bern Input Columns:\n@ pre\n bern"+TreeNotation.nest((new TreeNotation(d)).toFixedWidthTable(),
2)+"\n@ div\n bern Output Columns\n@ pre\n bern"+TreeNotation.nest((new TreeNotation(c)).toFixedWidthTable(),2)+"\n@ div\n bern Output Numeric Values:\n@ pre\n bern"+TreeNotation.nest((new TreeNotation(b.getNumericValues())).toFixedWidthTable(),2)+"\n@ div\n bern TypeScript Interface:\n@ pre\n bern"+TreeNotation.nest(b.toTypeScriptInterface(),2)+"\n@ div\n bern Input Numeric Values:\n@ pre\n bern"+TreeNotation.nest((new TreeNotation(a.getNumericValues())).toFixedWidthTable(),2)};
window.AbstractFlowBlock=AbstractFlowBlock;var AbstractProviderBlock=function(a){return AbstractFlowBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractProviderBlock,AbstractFlowBlock);AbstractProviderBlock._mountedChisels=AbstractFlowBlock._mountedChisels;AbstractProviderBlock.loadCode=AbstractFlowBlock.loadCode;
AbstractProviderBlock.prototype.getBlockFooterBray=function(){var a=this.getOutputBinder().getCardCount(),b=lodash.round(this.getTTL()/1E3,1);return this.getBlockToolbarButtonBray()+"\n@ span\n bern Out: "+a+" Time: "+b+"s "};AbstractProviderBlock.prototype.isProvider=function(){return!0};window.AbstractProviderBlock=AbstractProviderBlock;var AbstractTransformerBlock=function(a){return AbstractProviderBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractTransformerBlock,AbstractProviderBlock);
AbstractTransformerBlock._mountedChisels=AbstractProviderBlock._mountedChisels;AbstractTransformerBlock.loadCode=AbstractProviderBlock.loadCode;AbstractTransformerBlock.prototype.getBlockFooterBray=function(){var a=this.getInputBinder().getCardCount(),b=this.getOutputBinder().getCardCount();return this.getBlockToolbarButtonBray()+"\n@ span\n bern In: "+a+" Out: "+b};AbstractTransformerBlock.prototype.getOutputColumnsTree=function(){return this.getNode("columns")||new TreeNotation};
AbstractTransformerBlock.prototype.fetchCards=function(){return Promise.resolve(this.transformCards())};window.AbstractTransformerBlock=AbstractTransformerBlock;var FlowDictionary=">block\n percentage 0\n &int limit 10000\n  percentage .5\n  description Maximum number of cards to show.\n &orderByExpression orderBy\n  percentage .5\n &outputPoint pin\n  percentage .2\n &boolean visible true\n  insert 1\n require AbstractFlowBlock /aientist/client/flow/AbstractFlowBlock.js\n>settings >block\n &enum layout custom\n  percentage .2\n  options custom tree bin\n &boolean visible false\n size 140 120\n require SettingsBlock /aientist/client/blocks/SettingsBlock.js\n>chart >block\n>mini >chart\n &plaintext title\n size 1080 600\n require MiniBlock /aientist/client/flow/charts/MiniBlock.js\n>list >chart\n &plaintext title\n &column label\n  auto getTitlePotential\n require ListChart /aientist/client/flow/charts/List.js\n>kpi >chart\n percentage .02\n svg score\n &column column\n  percentage .90\n  auto\n &plaintext title\n &enum reduction count\n  percentage .70\n  options count sum average min max median\n require KpiChart /aientist/client/flow/charts/KpiChart.js\n size 140 120\n>html >chart\n &html slang\n script /lib/sanitize-html.min.js\n require HTMLBlock /aientist/client/flow/charts/HTMLBlock.js\n &string allowedTags img\n  const\n &string allowedAttributes\n  const\n  default a href name target\n   img src\n>heatcal >chart\n &column count\n  description Column which contains the day's measurement value.\n  auto getTypeName=number\n &column day\n  description Column which contains the day the measurement was taken.\n  auto getTypeName=day\n &plaintext title\n size 750 200\n require HeatCalendarChart /aientist/client/flow/charts/HeatCalendar.js\n>table >chart\n percentage .2\n size 750 300\n svg table\n &boolean pretty\n  percentage .30\n  description Set to true to show formatted values in cell.\n &columnNames showColumns\n  percentage .20\n  description Column names to show\n &columnNames hideColumns\n  percentage .20\n  description Column names to hide\n &plaintext title\n &int limit 100\n  percentage .10\n &enum columnOrder importance\n  percentage .20\n  options default importance alphabetical\n require TableBlock /aientist/client/flow/charts/TableBlock.js\n>element >chart\n &plaintext style\n &boolean editable true\n &plaintext slang\n  percentage .9\n  description Text to show and/or emit.\n  monad\n require BrayBlock /aientist/client/flow/charts/BrayBlock.js\n>title >element\n percentage .1\n &htmlTag element h1\n  const\n size 250 90\n>dump >chart\n require DumpChart /aientist/client/flow/charts/DumpChart.js\n>header >element\n size 600 60\n>pre >element\n>h1 >header\n>h2 >header\n>labzero >element\n &htmlTag element div\n  const\n &plaintext slang LabZero is a product development firm in San Francisco. LZ hosted the first ever ohayo and ETN demo on 6/16/2017.\n  const\n>h3 >header\n>h4 >header\n>h5 >header\n>h6 >header\n>wordcloud >chart\n &column name\n  auto isString=true\n &column count\n  auto isString=false\n script /lib/wordcloud2.js\n require WordCloudChart /aientist/client/flow/charts/WordCloud.js\n>google >chart\n &int limit 10\n  percentage .10\n &plaintext title\n script https://www.gstatic.com/charts/loader.js\n require AbstractGoogleBase /aientist/client/flow/charts/google/AbstractGoogleBase.js\n>googleLabel >google\n &column label\n  description Column to use for the label\n  auto isString=true\n &column value\n  description Column to use for the value\n  auto isString=false\n>google.core >googleLabel\n &enum legendPosition right\n  percentage .5\n  options bottom labeled left none right top\n require AbstractGoogleCore /aientist/client/flow/charts/google/AbstractGoogleCore.js\n>square >google.core\n require GoogleSquare /aientist/client/flow/charts/google/GoogleSquare.js\n>google.geo >google.core\n &region region\n &enum resolution countries\n  percentage .30\n  options countries provinces metros\n require GoogleGeo /aientist/client/flow/charts/google/GoogleGeo.js\n>google.pie >google.core\n &boolean is3D false\n  percentage .10\n &prob pieHole\n &number pieStartAngle\n &prob sliceVisibilityThreshold\n &string googleClassName PieChart\n  const\n>pie >google.pie\n>google.histogram >google.core\n &string googleClassName Histogram\n  const\n>histogram >google.histogram\n>google.column >google.core\n &column x\n &column y\n  auto isString=false\n &column series\n  auto isString=true\n &column row\n  auto isString=false\n &column cell\n  auto isString=false\n &boolean isStacked true\n  percentage .10\n require GoogleColumn /aientist/client/flow/charts/google/GoogleColumn.js\n>line >google.core\n &column x\n &column y\n  auto isString=false\n require GoogleLine /aientist/client/flow/charts/google/GoogleLine.js\n>google.area >line\n require GoogleArea /aientist/client/flow/charts/google/GoogleArea.js\n>scatter >google.core\n percentage .05\n &column x\n  auto isString=false\n &column y\n  auto isString=false\n &object trendlines\n &number hMax\n &number hMin\n &number vMax\n &number vMin\n require GoogleScatter /aientist/client/flow/charts/google/GoogleScatter.js\n>google.gauge >googleLabel\n &int min 0\n  percentage .10\n &int max 100\n  percentage .10\n &int redFrom 90\n  percentage .10\n &int redFrom 100\n  percentage .10\n &int yellowFrom 75\n  percentage .10\n &int yellowTo 90\n  percentage .10\n &int minorTicks 5\n  percentage .10\n require GoogleGauge /aientist/client/flow/charts/google/GoogleGauge.js\n>google.timeline >google\n &column label\n  auto getTitlePotential\n require GoogleTimeline /aientist/client/flow/charts/google/GoogleTimeline.js\n>tree >google\n &boolean allowCollapse false\n  percentage .10\n &enum size medium\n  percentage .10\n  options small medium large\n require GoogleOrg /aientist/client/flow/charts/google/GoogleOrg.js\n>bar >google\n &int limit 10\n  percentage .1\n &column x\n  auto\n &column y\n  auto isString=false\n require GoogleBar /aientist/client/flow/charts/google/GoogleBar.js\n>provider >block\n size 140 120\n &columnsObject columns\n  percentage .5\n outputSuggestions >filter >group\n>data >provider\n percentage .2\n svg folder\n &text slang\n  percentage .9\n  description The actual data.\n &format format\n  percentage .40\n  description CSV, TSV, JSON, etc.\n size 280 220\n require DataBlock /aientist/client/flow/providers/DataBlock.js\n>text >provider\n percentage .01\n require TextBlock /aientist/client/flow/providers/TextBlock.js\n size 750 200\n svg text\n &slang slang\n  percentage .99\n  description Text to show and/or emit.\n  monad\n>editor >data\n size 280 440\n percentage .01\n &text etn\n  percentage .9\n  description Name of the ETN the code is written in.\n>store >data\n percentage .01\n require StoreBlock /aientist/client/flow/providers/StoreBlock.js\n &string key\n  percentage .3\n  monad\n  description Name of local storage key.\n>programs >provider\n size 140 120\n require ProgramsBlock /aientist/client/flow/providers/ProgramsBlock.js\n>url >provider\n percentage .1\n svg www\n size 140 120\n &url url\n  percentage .90\n  templateString\n  monad\n &text extract\n  percentage .5\n  description If the url points to JSON, you can specify a field to extract\n &format format\n  percentage .10\n require AbstractUrlProvider /aientist/client/flow/providers/AbstractUrlProvider.js\n>hn >url\n percentage .01\n &url url https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty\n  percentage .10\n>reddit >url\n percentage .05\n svg reddit\n &text subreddit\n  description Subreddit to download top stories for\n  monad\n &enum get .json\n  percentage .10\n  options\n   .json Homepage\n   reddits.json Top Subreddits\n require RedditBlock /aientist/client/flow/providers/RedditBlock.js\n>query >provider\n &sql query\n  percentage .99\n  monad\n require QueryBlock /aientist/client/flow/providers/QueryBlock.js\n>presidents >url\n percentage .01\n svg whitehouse\n &url url /samples/presidents.csv\n  const\n>top >provider\n &string query\n  monad\n requre TopBlock /aientist/client/flow/providers/TopBlock.js\n size 250 90\n>transformer >block\n outputSuggestions >table\n size 160 100\n>date >transformer\n &column column\n  auto isTemporal=true\n requre DateBlock /aientist/client/flow/transformers/ExtendDate.js\n>datefilter >transformer\n &column column\n  percentage .90\n  auto isTemporal=true\n &enum days\n  options\n   0.0416 Last hour\n   1 Last 24 hours\n   3 Last 3 days\n   7 Last 7 days\n   30 Last 30 days\n   180 Last 6 months\n   365 Last 12 months\n require DateFilter /aientist/client/flow/transformers/DateFilter.js\n>extend >transformer\n require AbstractExtendBlock /aientist/client/flow/transformers/AbstractExtendBlock.js\n>filter >transformer\n percentage .01\n svg filter\n size 250 90\n &text filter\n  percentage .90\n  description The filter string to search for\n  monad\n require FilterBlock /aientist/client/flow/transformers/FilterBlock.js\n>morph >command\n size 420 200\n require MorphBlock /aientist/client/blocks/MorphBlock.js\n>didyoumean >command\n require DidYouMeanBlock /aientist/client/blocks/DidYouMeanBlock.js\n>group >transformer\n percentage .01\n svg tree\n &column by\n  percentage .90\n  monad\n &columnNames advanced\n  percentage .10\n  description If you want to group by multiple columns\n require GroupBlock /aientist/client/flow/transformers/Group.js\n>interpolate >transformer\n &column column\n require InterpolateBlock /aientist/client/flow/transformers/InterpolateBlock.js\n>join >transformer\n &column on\n  monad\n require JoinBlock /aientist/client/flow/transformers/JoinBlock.js\n>convert >transformer\n &format to\n  percentage .99\n require ConvertBlock /aientist/client/flow/transformers/ConvertBlock.js\n>parse >transformer\n &column column\n  description Name of the column to parse data from.\n  auto getTypeName=text\n &format format\n  percentage .40\n  description CSV, TSV, JSON, etc.\n require ParseBlock /aientist/client/flow/transformers/ParseBlock.js\n>types >transformer\n &etn etn\n  percentage .40\n require TypesBlock /aientist/client/flow/transformers/TypesBlock.js\n>wordcount >transformer\n require WordCount /aientist/client/flow/transformers/WordCount.js\n>wc >wordcount\n>command >block\n>replacer >transformer\n &map map\n  percentage .99\n  description Words to replace with their replacements.\n require ReplacerBlock /aientist/client/flow/transformers/ReplacerBlock.js\n>commands >provider\n &string method getCommandsBuffer\n  const\n require AbstractRunTimeProvider /aientist/client/flow/providers/AbstractRunTimeProvider.js\n>grid >chart\n require GridBlock /aientist/client/flow/charts/GridBlock.js\n script /node_modules/handsontable/dist/handsontable.full.js\n css /node_modules/handsontable/dist/handsontable.min.css\n>markdown >chart\n &markdown slang\n require MarkdownChart /aientist/client/flow/charts/MarkdownChart.js\n size 700 600\n>youtube >chart\n &alphanumeric video\n  monad\n require YouTubeBlock /aientist/client/flow/charts/YouTubeBlock.js\n size 800 500\n>outline >chart\n &boolean dots\n  description Whether to just show dots\n require TreeOutline /aientist/client/flow/charts/TreeOutline.js\n>3d >chart\n &string slang\n script /node_modules/vis/dist/vis.min.js\n require ThreeDChart /aientist/client/flow/charts/ThreeDChart.js\n size 800 500\n>fhtml >html\n &string allowedTags img script\n  const\n &string allowedAttributes 0\n  const\n  default a href name target\n   img src\n   script src\n>input >command\n &string path\n require InputBlock /aientist/client/flow/clay/InputBlock.js\n>picker >command\n &string path\n  description The program path to update when user picks something.\n &column column\n  description The column to use for the values\n require PickerBlock /aientist/client/flow/clay/PickerBlock.js\n>eval >transformer\n &javascript javascript\n require EvalBlock /aientist/client/flow/transformers/Eval.js\n>stats >transformer\n require StatsBlock /aientist/client/flow/transformers/StatsBlock.js";
window.FlowDictionary=FlowDictionary;var FlowProgram=function(a){return AbstractProgramChisel.apply(this,arguments)||this};$jscomp.inherits(FlowProgram,AbstractProgramChisel);FlowProgram._mountedChisels=AbstractProgramChisel._mountedChisels;FlowProgram.prototype.getDictionaryString=function(){return FlowDictionary};FlowProgram.prototype.getExtensionName=function(){return"flow"};FlowProgram.prototype.isProvider=function(){return!0};
FlowProgram.prototype.getProgramStats=function(){var a=AbstractProgramChisel.prototype.getProgramStats.call(this);a.cards=this._getProgramCardCount();a.timeToLoad=this._getLongestLoadTime();a.timeToRender=this._getLongestRenderTime();return a};FlowProgram.prototype._getLongestLoadTime=function(){return this.getProgramBlocks().map(function(a){return a.getTTL()}).sort().reverse()[0]};FlowProgram.prototype._getLongestRenderTime=function(){return this.getProgramBlocks().map(function(a){return a.getNewestTimeToRender()}).sort().reverse()[0]};
FlowProgram.prototype._getProgramCardCount=function(){return this.getAllCards().reduce(function(a,b){return a+b.length},0)};FlowProgram.prototype.getAllCards=function(){return lodash.flatten(this.getProgramBlocks().map(function(a){return a.isProvider()?a.getOutputBinder().getCards():[]}))};
FlowProgram.prototype.getProgramOfInterest=function(){var a=this.getProgramBlocks().find(function(a){return">editor"===a.getBase()});if(a){var b=a.getStruct().etn;return this.getApp().generateProgram(a.getDataSlang(),b)}return this};FlowProgram.prototype.compilesTo=function(){return"html"};FlowProgram.prototype.buildProgram=function(){return this.getProgramBlocks().filter(function(a){return!(a instanceof AbstractTuple)}).map(function(a){return a.getBlockBodyBray()}).join("\n")};
window.FlowProgram=FlowProgram;var AbstractChartBlock=function(a){return AbstractFlowBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractChartBlock,AbstractFlowBlock);AbstractChartBlock._mountedChisels=AbstractFlowBlock._mountedChisels;AbstractChartBlock.loadCode=AbstractFlowBlock.loadCode;AbstractChartBlock.prototype.getBlockHeaderBern=function(){return this.getStruct().title||""};
AbstractChartBlock.prototype.getBlockFooterBray=function(){var a=this.getInputBinder().getCardCount();return this.getBlockToolbarButtonBray()+"\n@ span\n bern In: "+a};AbstractChartBlock.prototype.toDisplayString=function(a,b){return void 0===a?"":this.getInputBinder().getBinderColumnByName(b).toDisplayString(a)};window.AbstractChartBlock=AbstractChartBlock;var AbstractHeaderlessChartBlock=function(a){return AbstractChartBlock.apply(this,arguments)||this};
$jscomp.inherits(AbstractHeaderlessChartBlock,AbstractChartBlock);AbstractHeaderlessChartBlock._mountedChisels=AbstractChartBlock._mountedChisels;AbstractHeaderlessChartBlock.loadCode=AbstractChartBlock.loadCode;
AbstractHeaderlessChartBlock.prototype.getBray=function(){return"@ div\n class BlockPage BlockChisel "+this.constructor.name+"\n id "+this.getId()+"\n data-onContextMenuCommand chisel _openBlockContextMenuCommand\n @ div\n  class BlockGrabber\n @ div\n  class BlockBody HeaderLess"+TreeNotation.nest(this.getBlockBodyBray(),2)+"\n @ div\n  class BlockFooter"+TreeNotation.nest(this.getBlockFooterBray(),2)+"\n @ div\n  class BlockGrabber"};AbstractHeaderlessChartBlock.prototype.getHeaderHeight=function(){return 0};
window.AbstractHeaderlessChartBlock=AbstractHeaderlessChartBlock;var BrayBlock=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(BrayBlock,AbstractHeaderlessChartBlock);BrayBlock._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;BrayBlock.loadCode=AbstractHeaderlessChartBlock.loadCode;
BrayBlock.prototype._updateTextCommand=function(a){a=Format.stripHtml(a.replace(/\<br\>/g,"\n").replace(/\<div\>/g,"\n"));this.touchNode("slang").setBeamWithChildren(a);this.autosaveBlock();return this.getApp().render()};BrayBlock.prototype.getHakon=function(){return".BrayBlock\n overflow scroll\n p\n  padding 5px\n  width 100%\n  height 100%\n  box-sizing border-box\n  white-space pre\n  outline 0"};BrayBlock.prototype.getBlockFooterBray=function(){return this.getBlockToolbarButtonBray()};
BrayBlock.prototype.fetchCards=function(){return Promise.resolve([{text:this.getStruct().slang}])};BrayBlock.prototype.getBlockBodyBray=function(){var a=this.getStruct(),b=this.getPipishInput();return"@ "+(a.element||this.getBase().substr(1))+"\n style "+a.style+"\n data-onBlurCommand chisel _updateTextCommand\n contenteditable "+(a.editable?"true":"false")+"\n bern"+TreeNotation.nest(b,2)};window.BrayBlock=BrayBlock;
var DumpChart=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(DumpChart,AbstractHeaderlessChartBlock);DumpChart._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;DumpChart.loadCode=AbstractHeaderlessChartBlock.loadCode;DumpChart.prototype.getBlockBodyBray=function(){return"@ div\n style overflow: scroll; width: 100%; height: 100%;\n bern"+TreeNotation.nest(this.getPipishInput(),2)};window.DumpChart=DumpChart;
var GridBlock=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(GridBlock,AbstractHeaderlessChartBlock);GridBlock._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;GridBlock.loadCode=AbstractHeaderlessChartBlock.loadCode;GridBlock.prototype.getBlockBodyBray=function(){return"@ div\n class hot"};GridBlock.prototype.getHakon=function(){return".hot\n color black"};GridBlock.prototype.transformCards=function(){};
GridBlock.prototype.chiselWillUnmount=function(){this._hot&&this._hot.destroy();delete this._hot};
GridBlock.prototype.chiselDidUpdate=function(){AbstractHeaderlessChartBlock.prototype.chiselDidUpdate.call(this);var a=this.getInputBinder().getColumnsByImportance().map(function(a){return a.getColumnName()}),a=this.getCardsAsCsvArray(a),b=this.getBlockDimension(),c=b.width,b=b.height-30,d=this.getStump().findStumpByChild("class hot"),e=this.getApp();if(!this.isNode())return this._hot=new Handsontable(d[0],{data:a,rowHeaders:!0,colHeaders:!0,stretchH:"all",width:c,minSpareCols:10,minSpareRows:30,
afterSelection:function(){return e.pauseShortcutListener()},afterDeselect:function(){return e.startShortcutListener()},height:b})};GridBlock.prototype.chiselDidMount=function(){this.chiselDidUpdate()};window.GridBlock=GridBlock;var BaseBeamArray=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(BaseBeamArray,TreeNotation);BaseBeamArray.prototype.toArrayMap=function(){var a={};this.getChildren().forEach(function(b){a[b.getBase()]=b.getBeam().split(" ")});return a};
var HTMLBlock=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(HTMLBlock,AbstractHeaderlessChartBlock);HTMLBlock._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;HTMLBlock.loadCode=AbstractHeaderlessChartBlock.loadCode;
HTMLBlock.prototype.getBlockBodyBray=function(){var a=this.getStruct(),b=a.slang||"",c=a.allowedTags.split(" "),a=(new BaseBeamArray(a.allowedAttributes)).toArrayMap(),b=sanitizeHtml(b,{allowedTags:sanitizeHtml.defaults.allowedTags.concat(c),allowedSchemes:["http","https","file","mailto"],allowedAttributes:a});return"@ div\n bern"+TreeNotation.nest(b)};window.HTMLBlock=HTMLBlock;var HeatCalendarChart=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};
$jscomp.inherits(HeatCalendarChart,AbstractHeaderlessChartBlock);HeatCalendarChart._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;HeatCalendarChart.loadCode=AbstractHeaderlessChartBlock.loadCode;
HeatCalendarChart.prototype._getLegend=function(a,b,c){var d=this.getTheme();return'<g><text x="'+(c.left-25)+'" y="'+(c.top+10)+'">Less</text>'+a.map(function(a,f){f=c.left+b*f;return'<rect style="fill: '+d.getHeatColor(1-a.percent)+'" width="10" height="10" x="'+f+'" y="'+c.top+'"></rect>'}).join("")+('<text x="'+(c.left+70)+'" y="'+(c.top+10)+'">More</text></g>')};HeatCalendarChart.prototype.getHakon=function(){return".heatCal\n rect\n  fill "+this.getTheme().darkerBackground+"\n  shape-rendering crispedges\n text\n  font-size 10px\n  fill #ddd"};
HeatCalendarChart.prototype.getBlockBodyBray=function(){return"@ div\n class heatCal\n style padding: 30px 10px 10px;\n bern"+TreeNotation.nest(this.getSvg(),2)};
HeatCalendarChart.prototype.getSvg=function(){var a=this.getInputBinder(),b=a.getCards();if(!b.length)return"";var c=this.getStruct(),d=c.day,e=c.count;if(!d||!e)return"";a.getBinderColumnByName(d);var f=a.getBinderColumnByName(e),c=moment(Date.now()).clone().subtract(365,"days"),a=365/6*12,g=this.getTheme(),h=f.getQuintiles(),k={};b.forEach(function(a){var b=a.getCardNumeric(),c=moment(b[d]).format("MM/DD/YYYY");a:{for(var f=0;f<h.length;f++)if(b[e]<=h[f].value){b=h[f].percent;break a}b=void 0}k[c]=
{quintile:b,card:a}});for(var b=[],f=parseInt(c.format("e")),l=0;365>=l;l++){var n=c.clone().add(l,"days");b.push({day:n,row:parseInt(n.format("e")),col:Math.floor((f+l)/7)})}var c="<g>"+[{day:"Mon",row:2},{day:"Wed",row:4},{day:"Fri",row:6}].map(function(a){return'<text x="0" y="'+(20+12*a.row-3)+'">'+a.day+"</text>"}).join("")+"</g>",p={},f="<g>"+b.map(function(a){var b=a.day.format("MMM"),c=a.day.format("MM/YYYY");if(p[c])return"";p[c]=!0;return'<text x="'+(40+12*a.col)+'" y="10">'+b+"</text>"}).join("")+
"</g>",m=moment(Date.now()).format("MM/DD/YYYY"),b="<g>"+b.map(function(a){var b=a.day.format("MM/DD/YYYY"),c=20+12*a.row;a=40+12*a.col;var d=k[b],e=d?'id="t'+d.card.getPuid()+'"':"",f=b===m?"stroke-width:2;stroke:rgb(0,0,0);":"";return'<rect style="'+((d?"fill: "+g.getHeatColor(1-d.quintile):"")+";"+f)+'" '+e+' data-day="'+b+'" width="10" height="10" x="'+a+'" y="'+c+'"></rect>'}).join("")+"</g>",l=this._getLegend(h,12,{top:110,left:60});return'<svg width="'+a+'" height="184">'+(c+b+f+l)+"</svg>"};
window.HeatCalendarChart=HeatCalendarChart;var KpiChart=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(KpiChart,AbstractHeaderlessChartBlock);KpiChart._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;KpiChart.loadCode=AbstractHeaderlessChartBlock.loadCode;
KpiChart.prototype.getBlockBodyBray=function(){var a=this.getStruct(),b=a.column,c=a.reduction;if(!b)return"";var d=this.getInputBinder().getBinderColumnByName(b).getReductions()[c],d=this.toDisplayString(d,b);return"@ div\n style text-align: center;\n @ div\n  style padding-top: 10px;\n  @ a\n   data-property column\n   bern "+b+"\n  @ a\n   data-property reduction\n   bern "+c+"\n"+(a.title?"@ h2\n bern "+a.title:"")+"\n@ h1\n bern "+d};window.KpiChart=KpiChart;
var ListChart=function(a){return AbstractChartBlock.apply(this,arguments)||this};$jscomp.inherits(ListChart,AbstractChartBlock);ListChart._mountedChisels=AbstractChartBlock._mountedChisels;ListChart.loadCode=AbstractChartBlock.loadCode;ListChart.prototype.getHakon=function(){return".ListChart\n ol\n  height 100%\n  width 100%\n  overflow scroll\n  box-sizing border-box\n  margin 0"};
ListChart.prototype.getBlockBodyBray=function(){var a=this.getStruct(),b=a.link,c=a.label;return"@ ol\n"+this.getCardsWithStructQuery().map(function(a){var d=Format.stripHtml(a.getCardValue(c));return" @ li\n  @ a\n   "+(b?"href "+Format.stripHtml(a.getCardValue(b)):"")+"\n   bern "+d}).join("\n")};window.ListChart=ListChart;var MarkdownChart=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(MarkdownChart,AbstractHeaderlessChartBlock);
MarkdownChart._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;MarkdownChart.loadCode=AbstractHeaderlessChartBlock.loadCode;MarkdownChart.prototype.getHakon=function(){return".MarkdownChart\n div\n  overflow scroll"};MarkdownChart.prototype.getBlockBodyBray=function(){var a=this.getPipishInput(),a=marked(a);return"@ div\n bern"+TreeNotation.nest(a,2)};window.MarkdownChart=MarkdownChart;var MiniBlock=function(a){return AbstractChartBlock.apply(this,arguments)||this};
$jscomp.inherits(MiniBlock,AbstractChartBlock);MiniBlock._mountedChisels=AbstractChartBlock._mountedChisels;MiniBlock.loadCode=AbstractChartBlock.loadCode;
MiniBlock.prototype.getHakon=function(){var a=this.getTheme();return".MiniBlock\n .BlockBody\n  overflow scroll\n .miniMap\n  background "+a.backgroundColor+"\n  width 120px\n  height 90px\n  margin 6px\n  position relative\n  overflow hidden\n  display inline-block\n  .miniFooter\n   font-size 12px\n   position absolute\n   bottom 0\n   width 100%\n   height 15px\n   line-height 15px\n   text-align center\n  .miniPreview\n   position absolute\n   width 100%\n   height calc(100% - 15px)\n   top 0\n   overflow hidden\n   div\n    position absolute\n    background "+a.linkColor};
MiniBlock.prototype._getMiniBray=function(a,b,c,d){var e=a.getBlockDimensionMap(void 0===c?120:c,void 0===d?75:d);a=a.getProgramBlocks().filter(function(a){return a.isVisible()}).map(function(a){return"@ div\n style "+e.get(a).getScaledCss(.1)}).join("\n");return"@ a\n class miniMap\n data-onClickCommand app openUrlInNewSpaceAndFocus\n value "+b+"\n href "+b+"\n @ div\n  class miniPreview"+TreeNotation.nest(a,2)+"\n @ div\n  class miniFooter\n  bern "+b};
MiniBlock.prototype.getBlockBodyBray=function(){var a=this;this.getStruct();var b=this.getApp(),c=this.getCardsWithStructQuery().map(function(c){var d=c.getCardValue("bytes");c=c.getCardValue("link");var f=new FlowProgram(void 0,void 0,b);f.setChildrenAndDiskAndUndoStack(d);return a._getMiniBray(f,c)}).join("\n");return"@ div\n class MiniBlock"+TreeNotation.nest(c,1)};window.MiniBlock=MiniBlock;var TableBlock=function(a){return AbstractChartBlock.apply(this,arguments)||this};
$jscomp.inherits(TableBlock,AbstractChartBlock);TableBlock._mountedChisels=AbstractChartBlock._mountedChisels;TableBlock.loadCode=AbstractChartBlock.loadCode;
TableBlock.prototype.getHakon=function(){var a=this.getTheme();return".TableChisel\n overflow scroll\n font-size 12px\n box-sizing border-box\n width 100%\n height 100%\n "+a.enableTextSelect(1)+"\n top 34px\n tr\n  white-space nowrap\n  padding 0\n td:first-child,th:first-child\n  padding-left 5px\n td,th\n  padding-right 30px\n  overflow hidden\n  text-overflow ellipsis\n  max-width 250px\n td:hover,th:hover\n  overflow visible\n th\n  cursor pointer\n input,textarea\n  border 0\n  font-size 14px\n  box-sizing border-box\n  padding 0\n  font-family "+a.fonts};
TableBlock.prototype._getTrBray=function(a,b){return this.getCardsWithStructQuery().map(function(b,d){var c=b.getPuid();b.getCardNumeric();var f=a.map(function(a){var c=a.getColumnName(),c=b.getCardValue(c),d="";void 0!==c&&(d=Format.stripHtml(c).toString());return a.isLink()?"@ td\n @ a\n  href "+d+"\n  bern"+TreeNotation.nest(d,3):"@ td\n bern"+TreeNotation.nest(d,2)}).join("\n");return"@ tr\n class tableRow\n data-onContextMenuCommand chisel openCardEditorByPuidCommand\n value "+c+"\n @ td\n  bern "+
(d+1)+TreeNotation.nest(f,2)}).join("\n")};TableBlock.prototype.getContextMenuBray=function(){return"@ a\n data-onClickCommand app deleteAllCardsInTargetBlockCommand\n bern Delete all cards"};TableBlock.prototype._getHeaderBray=function(a,b){return"@ th\n"+a.map(function(a){return"@ th\n style "+(b===a||b==="-"+a?"font-style: italic;":"")+"\n value "+a+"\n @ span\n  tabindex -1\n  data-onClickCommand chisel _changeBlockOrderByCommand\n  value "+a+"\n  bern "+a}).join("\n")};
TableBlock.prototype.getBlockBodyBray=function(){var a=this.getStruct(),b=this.getInputBinder(),b="importance"===a.columnOrder?b.getColumnsByImportance():b.getColumnsArray();if(a.showColumns)var c=a.showColumns.split(" "),b=b.filter(function(a){return c.includes(a.getColumnName())});else if(a.hideColumns)var d=a.hideColumns.split(" "),b=b.filter(function(a){return!d.includes(a.getColumnName())});var b=b.slice(0,50),e=b.map(function(a){return a.getColumnName()}),e=this._getHeaderBray(e,a.orderBy),
a=this._getTrBray(b,a.pretty);return"@ div\n class TableChisel\n @ table\n  @ thead\n   @ tr\n    title Click to sort."+TreeNotation.nest(e,4)+"\n  @ tbody "+TreeNotation.nest(a,2)};window.TableBlock=TableBlock;var ThreeDChart=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(ThreeDChart,AbstractHeaderlessChartBlock);ThreeDChart._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;ThreeDChart.loadCode=AbstractHeaderlessChartBlock.loadCode;
ThreeDChart.prototype.getBlockBodyBray=function(){return"@ div\n class visjs"};ThreeDChart.prototype.chiselDidMount=function(){AbstractHeaderlessChartBlock.prototype.chiselDidMount.call(this);this.chiselDidUpdate()};ThreeDChart.prototype.chiselDidUpdate=function(){AbstractHeaderlessChartBlock.prototype.chiselDidUpdate.call(this);if(!this.isNode())try{this._tryVis()}catch(a){console.error(a)}};
ThreeDChart.prototype._tryVis=function(){this.getStruct();var a=this.getPipishInput(),b=this.getApp(),c=b.getLanguageBestGuess(a),a=b.generateProgram(a,c),a=this._treeTo3D(a),d=new vis.DataSet;a.forEach(function(a){return d.add(a)});a=this.getBlockDimension();a={width:a.width+"px",height:a.height-80+"px",style:"dot-color",showPerspective:!1,showLegend:!1,showShadow:!1,keepAspectRatio:!0,xStep:1,yStep:1,zStep:1,zMax:5,showGrid:!1,showZAxis:!0,showXAxis:!0,showYAxis:!0,dotSizeRatio:.02,dotSizeMinFraction:1,
cameraPosition:{horizontal:.1,vertical:1.5,distance:4},verticalRatio:1,tooltip:function(a){return a.data.line}};b=this.getStump().findStumpByChild("class visjs").getShadow().getShadowElement();new vis.Graph3d(b,d,a)};
ThreeDChart.prototype._treeTo3D=function(a){var b={},c=new TreeNotation(a.getProgramTypeString()),d=Util.makeSemiRandomFn(),e=[];a.getTopDownArray().forEach(function(f,g){var h=f.getPoint(a);g=f.getPathVector(a);var k=c.nodeAt(g);f.getWords().forEach(function(a,c){var f=k.getWord(c);b[f]||(b[f]=d());e.push({x:h.x,y:-h.y,line:a+" "+f,z:c,style:b[f]})})});return e};window.ThreeDChart=ThreeDChart;var TreeOutline=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};
$jscomp.inherits(TreeOutline,AbstractHeaderlessChartBlock);TreeOutline._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;TreeOutline.loadCode=AbstractHeaderlessChartBlock.loadCode;
TreeOutline.prototype.getBlockBodyBray=function(){var a=new TreeNotation(this.getPipishInput()),a=this.getStruct().dots?a.toOutline(function(a){return"o"+a.getLine().split(" ").map(function(a){return"\u00ba"}).join("")}):a.toOutline();return"@ pre\n style overflow: scroll; width: 100%; height: 100%; margin: 0; box-sizing: border-box;\n bern"+TreeNotation.nest(a,2)};window.TreeOutline=TreeOutline;var WordCloudChart=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};
$jscomp.inherits(WordCloudChart,AbstractHeaderlessChartBlock);WordCloudChart._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;WordCloudChart.loadCode=AbstractHeaderlessChartBlock.loadCode;WordCloudChart.prototype.getBlockBodyBray=function(){return"@ div\n class wordCloud\n style width: 100%; height: 100%;"};WordCloudChart.prototype._getWords=function(){return this.getRequiredTable(["name","count"])};WordCloudChart.prototype.chiselDidUpdate=function(){this._draw()};
WordCloudChart.prototype.chiselDidMount=function(){this._draw()};WordCloudChart.prototype._draw=function(){var a=this.getStruct(),b=this._getWords();b.length&&(b.shift(),b={list:b.map(function(a){return[a[0],a[1]]}),shuffle:!1,backgroundColor:"transparent",random:Util.makeSemiRandomFn(),wait:0},Object.assign(b,a),a=this.getStump().findStumpByChild("class wordCloud").getShadow().getShadowElement(),WordCloud(a,b))};window.WordCloudChart=WordCloudChart;
var YouTubeBlock=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(YouTubeBlock,AbstractHeaderlessChartBlock);YouTubeBlock._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;YouTubeBlock.loadCode=AbstractHeaderlessChartBlock.loadCode;YouTubeBlock.prototype.getBlockBodyBray=function(){var a=this.getBlockDimension().width,b=this.getStruct().video;return"@ iframe\n width "+a+"\n height "+a+"\n src https://www.youtube.com/embed/"+b+"\n frameborder 0\n allowfullscreen"};
window.YouTubeBlock=YouTubeBlock;var MockGoogle=function(){this.visualization={}},AbstractGoogleBase=function(a){return AbstractHeaderlessChartBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractGoogleBase,AbstractHeaderlessChartBlock);AbstractGoogleBase._mountedChisels=AbstractHeaderlessChartBlock._mountedChisels;AbstractGoogleBase.loadCode=AbstractHeaderlessChartBlock.loadCode;
AbstractGoogleBase.loadPackages=function(a){return"undefined"===typeof google?Promise.resolve():new Promise(function(b,c){return google.charts.load("current",{packages:a,callback:function(){return b()}})})};AbstractGoogleBase.prototype.getGoogle=function(){this._google||(this._google=this.isNode()?new MockGoogle:google);return this._google};AbstractGoogleBase.prototype.getBlockBodyBray=function(){return"@ div\n class goog"};AbstractGoogleBase.prototype.getHakon=function(){return".goog\n .BlockPage\n  overflow scroll"};
AbstractGoogleBase.prototype._getGoogElement=function(){return this.getStump().findStumpByChild("class goog").getShadow().getShadowElement()};AbstractGoogleBase.prototype._getGoogleOptions=function(){var a={},b=this.getStruct();Object.assign(a,b);b=this.getBlockBodyDimension();a.width=b.width;a.height=b.height;a.backgroundColor=this.getTheme().blockBackgroundColor;return a};
AbstractGoogleBase.prototype._draw=function(){if(!this.getInputBinder().getCardCount())return"";if(!this.isNode()){var a=this._getChartClass(),b=this._getGoogElement(),a=new a(b),b=this._getGoogleOptions(),c=this._getGoogleData();a.draw(c,b)}};AbstractGoogleBase.prototype.chiselDidUpdate=function(){this._draw()};AbstractGoogleBase.prototype.chiselDidMount=function(){this._draw()};AbstractGoogleBase.prototype.getLabelValue=function(){return this.getSomeData(["label","value"])};
AbstractGoogleBase.prototype.getSomeData=function(a){a=this.getRequiredTableWithDates(a);return this.getGoogle().visualization.arrayToDataTable(a)};AbstractGoogleBase.prototype.getGooglePivotTable=function(a,b,c,d){var e=this.getStruct(),f=Object.keys(b.getMap()),g=[];Object.keys(c.getMap()).forEach(function(b){var c=[b];f.forEach(function(b){var d=lodash.find(a,function(a){return a[e.series]==b&&a[e.card]==a});c.push(d?d[e.cell]:0)});g.push(c)});f.unshift(e.series);g.unshift(f);return g};
window.AbstractGoogleBase=AbstractGoogleBase;var AbstractGoogleCore=function(a){return AbstractGoogleBase.apply(this,arguments)||this};$jscomp.inherits(AbstractGoogleCore,AbstractGoogleBase);AbstractGoogleCore._mountedChisels=AbstractGoogleBase._mountedChisels;AbstractGoogleCore.loadPackages=AbstractGoogleBase.loadPackages;AbstractGoogleCore.loadCode=function(){return AbstractGoogleBase.loadPackages(["corechart"])};AbstractGoogleCore.prototype._getGoogleData=function(){return this.getLabelValue()};
AbstractGoogleCore.prototype._getGoogleOptions=function(){var a=AbstractGoogleBase.prototype._getGoogleOptions.call(this),b=this.getStruct();a.legend={};a.legend.position=b.legendPosition;return a};AbstractGoogleCore.prototype._getChartClass=function(){return this.getGoogle().visualization[this.getStruct().googleClassName]};window.AbstractGoogleCore=AbstractGoogleCore;var GoogleArea=function(a){return AbstractGoogleCore.apply(this,arguments)||this};$jscomp.inherits(GoogleArea,AbstractGoogleCore);
GoogleArea._mountedChisels=AbstractGoogleCore._mountedChisels;GoogleArea.loadPackages=AbstractGoogleCore.loadPackages;GoogleArea.loadCode=AbstractGoogleCore.loadCode;GoogleArea.prototype._getChartClass=function(){return this.getGoogle().visualization.AreaChart};GoogleArea.prototype._getGoogleData=function(){return this.getSomeData(["x","y"])};window.GoogleArea=GoogleArea;var GoogleBar=function(a){return AbstractGoogleCore.apply(this,arguments)||this};$jscomp.inherits(GoogleBar,AbstractGoogleCore);
GoogleBar._mountedChisels=AbstractGoogleCore._mountedChisels;GoogleBar.loadPackages=AbstractGoogleCore.loadPackages;GoogleBar.loadCode=AbstractGoogleCore.loadCode;GoogleBar.prototype._getChartClass=function(){return this.getGoogle().visualization.BarChart};GoogleBar.prototype._getGoogleData=function(){return this.getSomeData(["x","y"])};window.GoogleBar=GoogleBar;var GoogleColumn=function(a){return AbstractGoogleCore.apply(this,arguments)||this};$jscomp.inherits(GoogleColumn,AbstractGoogleCore);
GoogleColumn._mountedChisels=AbstractGoogleCore._mountedChisels;GoogleColumn.loadPackages=AbstractGoogleCore.loadPackages;GoogleColumn.loadCode=AbstractGoogleCore.loadCode;GoogleColumn.prototype._getChartClass=function(){return this.getGoogle().visualization.ColumnChart};
GoogleColumn.prototype._getGoogleData=function(){var a=this.getStruct(),b=this.getInputBinder(),c=b.getBinderColumnByName(a.series),d=b.getBinderColumnByName(a.card),a=b.getBinderColumnByName(a.cell),b=b.getCards().map(function(a){return a.getCardNumeric()});return this.getGoogle().visualization.arrayToDataTable(this.getGooglePivotTable(b,c,d,a))};window.GoogleColumn=GoogleColumn;var GoogleGauge=function(a){return AbstractGoogleBase.apply(this,arguments)||this};$jscomp.inherits(GoogleGauge,AbstractGoogleBase);
GoogleGauge._mountedChisels=AbstractGoogleBase._mountedChisels;GoogleGauge.loadPackages=AbstractGoogleBase.loadPackages;GoogleGauge.loadCode=function(){return AbstractGoogleBase.loadPackages(["gauge"])};GoogleGauge.prototype._getChartClass=function(){return this.getGoogle().visualization.Gauge};GoogleGauge.prototype._getGoogleData=function(){return this.getLabelValue()};window.GoogleGauge=GoogleGauge;var GoogleGeo=function(a){return AbstractGoogleCore.apply(this,arguments)||this};
$jscomp.inherits(GoogleGeo,AbstractGoogleCore);GoogleGeo._mountedChisels=AbstractGoogleCore._mountedChisels;GoogleGeo.loadPackages=AbstractGoogleCore.loadPackages;GoogleGeo.loadCode=function(){return AbstractGoogleCore.loadPackages(["geochart"])};GoogleGeo.prototype._getChartClass=function(){return this.getGoogle().visualization.GeoChart};window.GoogleGeo=GoogleGeo;var GoogleLine=function(a){return AbstractGoogleCore.apply(this,arguments)||this};$jscomp.inherits(GoogleLine,AbstractGoogleCore);
GoogleLine._mountedChisels=AbstractGoogleCore._mountedChisels;GoogleLine.loadPackages=AbstractGoogleCore.loadPackages;GoogleLine.loadCode=AbstractGoogleCore.loadCode;GoogleLine.prototype._getChartClass=function(){return this.getGoogle().visualization.LineChart};GoogleLine.prototype._getGoogleData=function(){return this.getSomeData(["x","y"])};window.GoogleLine=GoogleLine;var GoogleOrg=function(a){return AbstractGoogleBase.apply(this,arguments)||this};$jscomp.inherits(GoogleOrg,AbstractGoogleBase);
GoogleOrg._mountedChisels=AbstractGoogleBase._mountedChisels;GoogleOrg.loadPackages=AbstractGoogleBase.loadPackages;GoogleOrg.loadCode=function(){return AbstractGoogleBase.loadPackages(["orgchart"])};GoogleOrg.prototype._getChartClass=function(){return this.getGoogle().visualization.OrgChart};
GoogleOrg.prototype._getGoogleData=function(){var a=this.getInputBinder().getCards()[0];if(!a)return this.getGoogle().visualization.arrayToDataTable([]);a=(new TreeNotation(a.getCardSource())).getTopDownArray().map(function(a){return[{v:a.getPathVector().join(" "),f:a.getLine()},a.getParent().getPathVector().join(" ")]});return this.getGoogle().visualization.arrayToDataTable(a)};window.GoogleOrg=GoogleOrg;var GoogleScatter=function(a){return AbstractGoogleCore.apply(this,arguments)||this};
$jscomp.inherits(GoogleScatter,AbstractGoogleCore);GoogleScatter._mountedChisels=AbstractGoogleCore._mountedChisels;GoogleScatter.loadPackages=AbstractGoogleCore.loadPackages;GoogleScatter.loadCode=AbstractGoogleCore.loadCode;GoogleScatter.prototype._getChartClass=function(){return this.getGoogle().visualization.ScatterChart};
GoogleScatter.prototype._getGoogleOptions=function(){var a=AbstractGoogleCore.prototype._getGoogleOptions.call(this);this.getStruct();a.hAxis={};a.hAxis.maxValue=hMax;a.hAxis.minValue=hMin;a.vAxis={};a.vAxis.maxValue=vMax;a.vAxis.minValue=vMin;return a};GoogleScatter.prototype._getGoogleData=function(){return this.getSomeData(["x","y"])};window.GoogleScatter=GoogleScatter;var GoogleSquare=function(a){return AbstractGoogleBase.apply(this,arguments)||this};$jscomp.inherits(GoogleSquare,AbstractGoogleBase);
GoogleSquare._mountedChisels=AbstractGoogleBase._mountedChisels;GoogleSquare.loadPackages=AbstractGoogleBase.loadPackages;GoogleSquare.loadCode=function(){return AbstractGoogleBase.loadPackages(["treemap"])};
GoogleSquare.prototype._getGoogleOptions=function(){var a=this.getTheme(),b=AbstractGoogleBase.prototype._getGoogleOptions.call(this);b.highlightOnMouseOver=!1;b.headerHeight=0;b.minColor=tinycolor(a.selectionColor).lighten(40).toHexString();b.midColor=tinycolor(a.selectionColor).toHexString();b.maxColor=tinycolor(a.selectionColor).darken(20).toHexString();return b};
GoogleSquare.prototype._getGoogleData=function(){var a=this.getRequiredTable(["label","value"]).map(function(a){return[a[0],"All",a[1]]}),b=a.shift();a.unshift(["All",null,0]);a.unshift(b);return this.getGoogle().visualization.arrayToDataTable(a)};GoogleSquare.prototype._getChartClass=function(){return this.getGoogle().visualization.TreeMap};window.GoogleSquare=GoogleSquare;var GoogleTimeline=function(a){return AbstractGoogleBase.apply(this,arguments)||this};$jscomp.inherits(GoogleTimeline,AbstractGoogleBase);
GoogleTimeline._mountedChisels=AbstractGoogleBase._mountedChisels;GoogleTimeline.loadPackages=AbstractGoogleBase.loadPackages;GoogleTimeline.loadCode=function(){return AbstractGoogleBase.loadPackages(["timeline"])};GoogleTimeline.prototype._getChartClass=function(){return this.getGoogle().visualization.Timeline};
GoogleTimeline.prototype._getGoogleData=function(){var a=(new this.getGoogle).visualization.DataTable();a.addColumn({type:"string",id:"Title"});a.addColumn({type:"date",id:"Start"});a.addColumn({type:"date",id:"End"});var b=this._getTimelineCards();a.addCards(b);return a};
GoogleTimeline.prototype._getTimelineCards=function(){var a=this.getInputBinder().getCards(),b=this.getStruct().label;return a.map(function(a){var c=a.getCardNumeric();a=a.getCardValue(b);var e=moment(c.start).toDate(),c=moment(c.end).toDate();return[a,e,c]})};window.GoogleTimeline=GoogleTimeline;var AbstractClayBlock=function(a){return AbstractFlowBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractClayBlock,AbstractFlowBlock);AbstractClayBlock._mountedChisels=AbstractFlowBlock._mountedChisels;
AbstractClayBlock.loadCode=AbstractFlowBlock.loadCode;window.AbstractClayBlock=AbstractClayBlock;var InputBlock=function(a){return AbstractClayBlock.apply(this,arguments)||this};$jscomp.inherits(InputBlock,AbstractClayBlock);InputBlock._mountedChisels=AbstractClayBlock._mountedChisels;InputBlock.loadCode=AbstractClayBlock.loadCode;InputBlock.prototype._getPath=function(){return this.getStruct().path};
InputBlock.prototype._getValue=function(){var a=this.getProgram().getNode(this._getPath());return a?a.getBeamWithChildren():""};InputBlock.prototype._modifyNodeCommand=function(a){this.getProgram().touchNode(this._getPath()).setBeamWithChildren(a);this.getProgram().autosaveAndRender()};InputBlock.prototype.getBlockBodyBray=function(){var a=this._getValue();return"@ textarea\n data-onChangeCommand chisel _modifyNodeCommand\n bern"+TreeNotation.nest(a,2)};window.InputBlock=InputBlock;
var PickerBlock=function(a){return AbstractClayBlock.apply(this,arguments)||this};$jscomp.inherits(PickerBlock,AbstractClayBlock);PickerBlock._mountedChisels=AbstractClayBlock._mountedChisels;PickerBlock.loadCode=AbstractClayBlock.loadCode;PickerBlock.prototype._getPath=function(){return this.getStruct().path};PickerBlock.prototype._getValue=function(){var a=this.getProgram().getNode(this._getPath());return a?a.getBeamWithChildren():""};
PickerBlock.prototype._saveValueCommand=function(a){this.getProgram().touchNode(this._getPath()).setBeamWithChildren(a);this.getProgram().autosaveAndRender()};PickerBlock.prototype.getHakon=function(){return".PickerBlock\n font-size 12px\n height 100%\n width 100%\n overflow scroll\n padding 3px\n box-sizing border-box\n a\n  display block"};
PickerBlock.prototype.getBlockBodyBray=function(){var a=this.getStruct();this._getValue();var b=a.column,a=this.getInputBinder().getCards(),c=this.getLimit();return a.map(function(a,e){if(e>=c)return"";a=a.getCardNumeric()[b];return"@ a\n data-onClickCommand chisel _saveValueCommand\n value "+a+"\n bern "+a}).join("\n")};window.PickerBlock=PickerBlock;var AbstractConnectorBlock=function(a){return AbstractProviderBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractConnectorBlock,AbstractProviderBlock);
AbstractConnectorBlock._mountedChisels=AbstractProviderBlock._mountedChisels;AbstractConnectorBlock.loadCode=AbstractProviderBlock.loadCode;window.AbstractConnectorBlock=AbstractConnectorBlock;var AbstractRunTimeProvider=function(a){return AbstractProviderBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractRunTimeProvider,AbstractProviderBlock);AbstractRunTimeProvider._mountedChisels=AbstractProviderBlock._mountedChisels;AbstractRunTimeProvider.loadCode=AbstractProviderBlock.loadCode;
AbstractRunTimeProvider.prototype.fetchCards=function(){return Promise.resolve(this.getApp()[this.getStruct().method]())};window.AbstractRunTimeProvider=AbstractRunTimeProvider;var AbstractSourceBlock=function(a){return AbstractProviderBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractSourceBlock,AbstractProviderBlock);AbstractSourceBlock._mountedChisels=AbstractProviderBlock._mountedChisels;AbstractSourceBlock.loadCode=AbstractProviderBlock.loadCode;window.AbstractSourceBlock=AbstractSourceBlock;
var AbstractUrlProvider=function(a){return AbstractConnectorBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractUrlProvider,AbstractConnectorBlock);AbstractUrlProvider._mountedChisels=AbstractConnectorBlock._mountedChisels;AbstractUrlProvider.loadCode=AbstractConnectorBlock.loadCode;AbstractUrlProvider.prototype.getUrl=function(){return this.getStruct().url||""};AbstractUrlProvider.prototype._getFormat=function(a){a=Util.getFileExtension(a);if((new CardParser).getEncodingNames()[a])return a};
AbstractUrlProvider.prototype.fetchCards=function(){var a=this,b=this.getStruct(),c=this.getUrl();if(!c)return Promise.resolve([]);c=encodeURI(c);c.match(/\.json/);var d=b.format||this._getFormat(c);return this.getApp().getWillowDocument().get(c).then(function(a){b.extract&&(a=a[b.extract]);var c=new CardParser;return"string"===typeof a?c.parse(a,d):c.parseFromObject(a,d)}).catch(function(b){a.logMessage("Fetch error");return[]})};window.AbstractUrlProvider=AbstractUrlProvider;
var DataBlockCard=function(a){ObjectBackedCard.apply(this,arguments)};$jscomp.inherits(DataBlockCard,ObjectBackedCard);DataBlockCard._uniqueId=ObjectBackedCard._uniqueId;var DataBlock=function(a){return AbstractProviderBlock.apply(this,arguments)||this};$jscomp.inherits(DataBlock,AbstractProviderBlock);DataBlock._mountedChisels=AbstractProviderBlock._mountedChisels;DataBlock.loadCode=AbstractProviderBlock.loadCode;
DataBlock.prototype.getDataSlang=function(){var a=this.getNode("slang");return a?a.getBeamWithChildren():""};DataBlock.prototype.getBlockBodyBray=function(){var a=Format.stripHtml(this.getDataSlang());return"@ textarea\n data-onChangeCommand chisel _saveDataCommand\n class BlockTextArea savable\n bern"+TreeNotation.nest(a,2)};DataBlock.prototype._saveDataCommand=function(a){this.touchNode("slang").setBeamWithChildren(a);this.autosaveBlock();return this.executeLoadDataAndRender()};
DataBlock.prototype.getCardClass=function(){return DataBlockCard};DataBlock.prototype.fetchCards=function(){return Promise.resolve((new CardParser).parse(this.getDataSlang(),this.getStruct().format))};DataBlock.prototype._getFormatted=function(a,b){switch(b){case "tree":return(new TreeNotation(a)).toString();case "json":return(new TreeNotation(a)).toJson();default:return(new TreeNotation(a)).toCsv()}};
DataBlock.prototype.createCards=function(a){var b=this.getStruct().format,c=this.getDataSlang(),c=(new CardParser).parse(c,b);a=lodash.concat(c,a);b=this._getFormatted(a,b);return this._saveDataCommand(b)};DataBlock.prototype.updateCards=function(a){return this.autosaveBlock()};
DataBlock.prototype.deleteCards=function(a){var b=this.getOutputBinder().getCards();lodash.remove(b,function(b){return a.indexOf(b)});b=this._getFormatted(b.map(function(a){return a.getCardSource()}),this.getStruct().format);return this._saveDataCommand(b)};window.DataBlock=DataBlock;var OhayoProgramCard=function(a){ObjectBackedCard.apply(this,arguments)};$jscomp.inherits(OhayoProgramCard,ObjectBackedCard);OhayoProgramCard._uniqueId=ObjectBackedCard._uniqueId;
OhayoProgramCard.prototype.destroyCardCommand=function(){return this.getCardApp().deleteFileCommand(this.getCardValue("link"))};OhayoProgramCard.prototype.updateCardCommand=function(){};var ProgramsBlock=function(a){return AbstractProviderBlock.apply(this,arguments)||this};$jscomp.inherits(ProgramsBlock,AbstractProviderBlock);ProgramsBlock._mountedChisels=AbstractProviderBlock._mountedChisels;ProgramsBlock.loadCode=AbstractProviderBlock.loadCode;ProgramsBlock.prototype.getCardClass=function(){return OhayoProgramCard};
ProgramsBlock.prototype.fetchCards=function(){return Promise.resolve(this.getApp().getCaddies().map(function(a){return a.toCaddyObject()}))};window.ProgramsBlock=ProgramsBlock;var QueryBlock=function(a){return AbstractUrlProvider.apply(this,arguments)||this};$jscomp.inherits(QueryBlock,AbstractUrlProvider);QueryBlock._mountedChisels=AbstractUrlProvider._mountedChisels;QueryBlock.loadCode=AbstractUrlProvider.loadCode;QueryBlock.prototype.getUrl=function(){return"/sql?q="+this.getStruct().query};
QueryBlock.prototype.getBlockBodyBray=function(){return"@ textarea\n data-onChangeCommand chisel changeTupleCommand\n name query\n class BlockTextArea\n bern"+TreeNotation.nest(Format.stripHtml(this.getStruct().query))};window.QueryBlock=QueryBlock;var RedditBlock=function(a){return AbstractUrlProvider.apply(this,arguments)||this};$jscomp.inherits(RedditBlock,AbstractUrlProvider);RedditBlock._mountedChisels=AbstractUrlProvider._mountedChisels;RedditBlock.loadCode=AbstractUrlProvider.loadCode;
RedditBlock.prototype.getUrl=function(){var a=this.getStruct();return"https://www.reddit.com/"+((a.subreddit?"/r/"+a.subreddit+"/top/.json?sort=top&t=all":"")||a.get)};RedditBlock.prototype.fetchCards=function(){return AbstractUrlProvider.prototype.fetchCards.call(this).then(function(a){return a.length?a[0].data.children.map(function(a){return a.data}):[]})};window.RedditBlock=RedditBlock;var StoreBlock=function(a){return DataBlock.apply(this,arguments)||this};$jscomp.inherits(StoreBlock,DataBlock);
StoreBlock._mountedChisels=DataBlock._mountedChisels;StoreBlock.loadCode=DataBlock.loadCode;StoreBlock.prototype.getDataSlang=function(){return this.getApp().getStore().get(this._getKey())||""};StoreBlock.prototype._getKey=function(){return this.getStruct().key||this.getProgram().getUrl()};StoreBlock.prototype._saveDataCommand=function(a){this.getApp().getStore().set(this._getKey(),a)};window.StoreBlock=StoreBlock;var TextBlock=function(a){return AbstractProviderBlock.apply(this,arguments)||this};
$jscomp.inherits(TextBlock,AbstractProviderBlock);TextBlock._mountedChisels=AbstractProviderBlock._mountedChisels;TextBlock.loadCode=AbstractProviderBlock.loadCode;TextBlock.prototype.fetchCards=function(){return Promise.resolve([{text:this.getStruct().slang}])};window.TextBlock=TextBlock;var TopBlock=function(a){return AbstractUrlProvider.apply(this,arguments)||this};$jscomp.inherits(TopBlock,AbstractUrlProvider);TopBlock._mountedChisels=AbstractUrlProvider._mountedChisels;TopBlock.loadCode=AbstractUrlProvider.loadCode;
TopBlock.prototype.getUrl=function(){this.getStruct();return"/samples/presidents.csv"};window.TopBlock=TopBlock;var AbstractExtendBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(AbstractExtendBlock,AbstractTransformerBlock);AbstractExtendBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;AbstractExtendBlock.loadCode=AbstractTransformerBlock.loadCode;AbstractExtendBlock.prototype.getBlockClassColumns=function(){return this.getStructColumns().filter(function(a){return!!a.source})};
AbstractExtendBlock.prototype._convertValueToNumeric=function(a,b,c){if(void 0===a||!ColumnTypes[b]||""===a)return"";c=this._getConversionFn(c,b,a);return null!==c?c:ColumnTypes[b].fromStringToNumeric(a)};AbstractExtendBlock.prototype._getConversionFn=function(a,b,c){var d=ColumnTypes[a];b=ColumnTypes[b];return d&&b?b.from&&b.from[a]?b.from[a](c):b.fromMomentToNumeric&&d.fromStringToMoment?b.fromMomentToNumeric(d.fromStringToMoment(c)):null:null};
AbstractExtendBlock.prototype.transformCards=function(){var a=this,b=this.getBlockClassColumns(),c=this.getInputBinder().getColumnsMap();return this.getInputBinder().getCards().map(function(d){var e=d.getCardSourceAsObject(),f={};Object.assign(f,e);b.forEach(function(b){var d=e[b.source],g=c[b.source].getTypeName();f[b.name]=a._convertValueToNumeric(d,b.type,g)});return f})};window.AbstractExtendBlock=AbstractExtendBlock;
var ConvertBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(ConvertBlock,AbstractTransformerBlock);ConvertBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;ConvertBlock.loadCode=AbstractTransformerBlock.loadCode;ConvertBlock.prototype.transformCards=function(){var a=this.getPipishInput();return[{text:(new TreeNotation(a)).toJson()}]};window.ConvertBlock=ConvertBlock;
var DateFilter=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(DateFilter,AbstractTransformerBlock);DateFilter._mountedChisels=AbstractTransformerBlock._mountedChisels;DateFilter.loadCode=AbstractTransformerBlock.loadCode;DateFilter.prototype.transformCards=function(){var a=this.getInputBinder().getNumericValues(),b=this.getStruct();if(!b.column||!b.days)return a;var c=getTime(b.days);return a.filter(function(a){return a[b.column]>=c})};
DateFilter.prototype.getTime=function(a){return Date.now()-864E5*parseFloat(a)};window.DateFilter=DateFilter;var EvalBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(EvalBlock,AbstractTransformerBlock);EvalBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;EvalBlock.loadCode=AbstractTransformerBlock.loadCode;
EvalBlock.prototype.transformCards=function(){var a=this.getNode("javascript"),a=a&&a.getBeamWithChildren();try{var b=a&&eval(a)}catch(c){console.error(c)}a=this.getInputBinder().getCardSources();return b?b(a):a};window.EvalBlock=EvalBlock;var DateBlock=function(a){return AbstractExtendBlock.apply(this,arguments)||this};$jscomp.inherits(DateBlock,AbstractExtendBlock);DateBlock._mountedChisels=AbstractExtendBlock._mountedChisels;DateBlock.loadCode=AbstractExtendBlock.loadCode;
DateBlock.prototype.getBlockClassColumns=function(){var a=this.getStruct().column;return a?["day","month","year"].map(function(b){return{source:a,name:b,type:b}}):[]};window.DateBlock=DateBlock;var ExtractBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(ExtractBlock,AbstractTransformerBlock);ExtractBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;ExtractBlock.loadCode=AbstractTransformerBlock.loadCode;
ExtractBlock.prototype.transformCards=function(){var a=this.getInputBinder().getFirstCard().getFirstCell(),b={};ExtractBlock._extractTablesFromObject(b,a);a=Object.keys(b);return b[a[0]]};ExtractBlock._getColumnNamesFromObj=function(a){a=Object.keys(a);a.sort();return a};
ExtractBlock._extractTablesFromObject=function(a,b){var c=this;if(!(b instanceof Array)){var d=this._getColumnNamesFromObj(b).join(" ");a[d]||(a[d]=0);a[d]++}Object.keys(b).forEach(function(d){d=b[d];"object"===typeof d&&c._extractTablesFromObject(a,d)})};window.ExtractBlock=ExtractBlock;var FilterBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(FilterBlock,AbstractTransformerBlock);FilterBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;
FilterBlock.loadCode=AbstractTransformerBlock.loadCode;FilterBlock.prototype.transformCards=function(){var a=this.getStruct().filter,b=this.getInputBinder().getCards();if(!a)return b;var c=this._generateSearchFn(a);return b.filter(function(a){return c(a.cardToString())})};FilterBlock.prototype.getBlockClassColumns=function(){return this.getInputBinder().getColumnsArrayOfObjects()};
FilterBlock.prototype.getBlockBodyBray=function(){return"@textarea\n placeholder Enter a string to filter by.\n name filter\n data-onChangeCommand chisel changeTupleCommand\n class BlockTextArea\n bern "+(this.getStruct().filter||"")};
FilterBlock.prototype._generateSearchFn=function(a){var b=[];a.split(";").forEach(function(a){var c="!"===a[0];c&&(a=a.substr(1));try{var e=new RegExp(a,"i");c?b.push(function(a){return!a.match(e)}):b.push(function(a){return!!a.match(e)})}catch(f){c?b.push(function(b){return!b.includes(a)}):b.push(function(b){return b.includes(a)})}});return function(a){var c=!0;b.forEach(function(b){b(a)||(c=!1)});return c}};window.FilterBlock=FilterBlock;
var GroupBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(GroupBlock,AbstractTransformerBlock);GroupBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;GroupBlock.loadCode=AbstractTransformerBlock.loadCode;
GroupBlock.prototype._makePivotResult=function(){var a=this.getStruct(),b=a.advanced||a.by;if(!b)return{cards:[],columns:[]};var c=this.getInputBinder(),a=c.getColumnsArrayOfObjects(),d={};a.forEach(function(a){return d[a.name]=!0});b=b.split(/ /g).filter(function(a){return d[a]});c=c.getNumericValues();return(new PivotTable(c,a,this.getStructColumns())).getNewCards(b)};GroupBlock.prototype.transformCards=function(){return this._getPivotResult().cards};
GroupBlock.prototype._getPivotResult=function(){var a=this.getInputBinder().getCTime();this._pivotCTime!==a&&delete this._result;this._result||(this._result=this._makePivotResult(),this._pivotCTime=a);return this._result};GroupBlock.prototype.getBlockClassColumns=function(){return this._getPivotResult().columns};window.GroupBlock=GroupBlock;var InterpolateBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(InterpolateBlock,AbstractTransformerBlock);
InterpolateBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;InterpolateBlock.loadCode=AbstractTransformerBlock.loadCode;InterpolateBlock.prototype._interpolator=function(a,b){a=parseInt(a);b=parseInt(b);for(var c=[];a<=b&&!(c.push(a),a+=26784E5,1E3<c.length););return c};
InterpolateBlock.prototype.transformCards=function(){var a=this.getInputBinder(),b=a.getCardSources();this.getOutputBinder();var c=this.getStruct().column;if(!c)return b;var d=a.getBinderColumnByName(c),a=d.getMin(),d=d.getMax(),a=this._interpolator(a,d).map(function(a){var b={};b[c]=a;b.count=0;return b});return Util.joinArraysOn(c,[b,a])};window.InterpolateBlock=InterpolateBlock;var JoinBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(JoinBlock,AbstractTransformerBlock);
JoinBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;JoinBlock.loadCode=AbstractTransformerBlock.loadCode;
JoinBlock.prototype.transformCards=function(){var a=this.getParent();if(a.isProgram())return[];var b=a.getParent();if(b.isProgram())return a.getOutputBinder().getCardSources();var c=[a,b],a=c.map(function(a){return a.getOutputBinder().getCardSources()}),b=this.getStruct().on;if(!b)return lodash.flatten(a);c=c.map(function(a){return a.getOutputBinder().getColumnNames()});return Util.joinArraysOn(b,a,c)};window.JoinBlock=JoinBlock;
var ParseBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(ParseBlock,AbstractTransformerBlock);ParseBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;ParseBlock.loadCode=AbstractTransformerBlock.loadCode;ParseBlock.prototype.transformCards=function(){var a=this.getStruct(),b=this.getInputBinder().getCardSources(),c=a.format,d=a.column,e=new CardParser;return lodash.flatten(b.map(function(a){return e.parse(a[d],c)}))};window.ParseBlock=ParseBlock;
var ReplacerBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(ReplacerBlock,AbstractTransformerBlock);ReplacerBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;ReplacerBlock.loadCode=AbstractTransformerBlock.loadCode;ReplacerBlock.prototype.transformCards=function(){var a=this.getPipishInput(),b=this.getStruct(),c=(new TreeNotation(b.map.trim())).toObject(),d=a;Object.keys(c).forEach(function(a){d=d.replace(new RegExp(a,"g"),c[a])});return[{text:d}]};
window.ReplacerBlock=ReplacerBlock;var StatsBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(StatsBlock,AbstractTransformerBlock);StatsBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;StatsBlock.loadCode=AbstractTransformerBlock.loadCode;
StatsBlock.prototype.transformCards=function(){var a=this.getInputBinder(),b=a.getColumnsMap();return a.getColumnNames().map(function(a){var c=b[a];a={Column:a,Type:c.getTypeName()};Object.assign(a,c.getReductions());return a})};window.StatsBlock=StatsBlock;var TypesBlock=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(TypesBlock,AbstractTransformerBlock);TypesBlock._mountedChisels=AbstractTransformerBlock._mountedChisels;TypesBlock.loadCode=AbstractTransformerBlock.loadCode;
TypesBlock.prototype.transformCards=function(){var a=this.getPipishInput(),b=this.getApp(),c=b.getLanguageBestGuess(a);return[{text:b.generateProgram(a,c).getProgramTypeString()}]};window.TypesBlock=TypesBlock;var WordCount=function(a){return AbstractTransformerBlock.apply(this,arguments)||this};$jscomp.inherits(WordCount,AbstractTransformerBlock);WordCount._mountedChisels=AbstractTransformerBlock._mountedChisels;WordCount.loadCode=AbstractTransformerBlock.loadCode;
WordCount.prototype.transformCards=function(){return this._getWords(this.getPipishInput())};WordCount.prototype._getWords=function(a){var b=[];if(!a)return b;var c={};a.split(/\s/g).map(function(a){return a.replace(/[^a-z0-9\-]/gi,"")}).filter(function(a){return a}).forEach(function(a){c[a]?c[a]++:c[a]=1});Object.keys(c).forEach(function(a){(a=a.trim())&&b.push({name:a,count:c[a]})});return b};window.WordCount=WordCount;
var Format={toTitleCase:function(a){return a.length?a.replace(/(\s\w)/g,function(a){return a.toUpperCase().trim()}).replace(/_/g," ").replace(/\-/g," "):""},getRandomString:function(a){a=a||32;for(var b="",c,d=0;d<a;d++)c=Math.floor(61*Math.random()),b+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(c,c+1);return b},removeFileExtension:function(a){return a?a.replace(/\.[^\.]+$/,""):""},stripHtml:function(a){return a&&a.replace?a.replace(/<(?:.|\n)*?>/gm,""):a},_permalink:function(a,
b){return a.length?a.toLowerCase().replace(b,"").replace(/ /g,"-"):""},permalink:function(a){return Format._permalink(a,/[^a-z0-9- _\.]/gi)},roundTo:function(a,b){return parseFloat(a.toFixed(b))},linkify:function(a){a=a.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'<a href="$1" target="_blank">$1</a>');a=a.replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank">$2</a>');return a=a.replace(/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,
'<a href="mailto:$1">$1</a>')}};window.Format=Format;var HakonPropertyNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(HakonPropertyNode,TreeNotation);HakonPropertyNode.prototype.toCss=function(a){return""+a+this.getBase()+": "+this.getBeam()+";"};var HakonErrorNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(HakonErrorNode,TreeNotation);HakonErrorNode.prototype.toCss=function(){return""};
HakonErrorNode.prototype.getErrorMessage=function(){return"Hakon should not have semicolons."};var HakonSelectorNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(HakonSelectorNode,TreeNotation);HakonSelectorNode.prototype.parseNodeType=function(a){return a.includes(";")?HakonErrorNode:a.includes(" ")?HakonPropertyNode:HakonSelectorNode};
HakonSelectorNode.prototype.getSelector=function(){var a=this.getParent().getSelector();return this.getBase().split(",").map(function(b){return b.startsWith("&")?a+b.substr(1):a?a+" "+b:b}).join(",")};HakonSelectorNode.prototype.toCss=function(){var a=this.getChildrenByNodeType(HakonPropertyNode);return a.length?this.getSelector()+" {\n"+a.map(function(a){return a.toCss("  ")}).join("\n")+"\n}\n":""};var HakonProgram=function(a){return TreeNotation.apply(this,arguments)||this};
$jscomp.inherits(HakonProgram,TreeNotation);HakonProgram.prototype.parseNodeType=function(a){return a?HakonSelectorNode:TreeNotation};HakonProgram.prototype.getSelector=function(){return""};HakonProgram.prototype.toCss=function(){return this.getTopDownArray().filter(function(a){return a instanceof HakonSelectorNode}).map(function(a){return a.toCss()}).join("")};window.HakonProgram=HakonProgram;
function Icons(a,b){var c=SVGS[a];if(!c)return console.error("svg not found for "+a),"";a=c.substr(4);return'<svg width="'+b+'" height="'+b+'" class="SVGIcon" '+a}window.Icons=Icons;var LocalStorageCaddy=function(a){return AbstractCaddy.apply(this,arguments)||this};$jscomp.inherits(LocalStorageCaddy,AbstractCaddy);window.LocalStorageCaddy=LocalStorageCaddy;
var StorageKeys={openPrograms:"__openPrograms",autoSave:"__autoSave",theme:"__theme",visitCount:"__visitCount",newUser:"__newUser",mountedProgram:"__mountedProgram"},_storageKeysmap={};Object.values(StorageKeys).forEach(function(a){_storageKeysmap[a]=!0});StorageKeys.isKey=function(a){return _storageKeysmap[a]};window.StorageKeys=StorageKeys;var AbstractModalChisel=function(a){return AbstractChisel.apply(this,arguments)||this};$jscomp.inherits(AbstractModalChisel,AbstractChisel);
AbstractModalChisel._mountedChisels=AbstractChisel._mountedChisels;
AbstractModalChisel.prototype.getHakon=function(){var a=this.getTheme();return AbstractChisel.prototype.getHakon.call(this)+"\n.monospaceModal\n font-family Courier, monospace\n white-space pre\n "+a.enableTextSelect(2)+"\n >div\n  max-height 600px\n  overflow scroll\n input\n  display block\n  width 100%\n textarea\n  width 100%\n  display block\n  min-height 200px\n  font-size 14px\n  font-family Courier, monospace\n\n.modalBackground\n position fixed\n top 0\n left 0\n width 100%\n height 100%\n z-index 1000\n display flex\n padding-top 50px\n align-items baseline\n justify-content center\n box-sizing border-box\n background "+a.modalDimmerBackground+
"\n\n.modalContent\n background "+a.contextMenuBackground+"\n color "+a.foregroundColor+"\n box-shadow 0px 0px 2px "+a.boxShadow+"\n padding 20px\n position relative\n min-width 600px\n max-width 800px\n max-height 90%\n white-space nowrap\n text-overflow ellipsis\n overflow-x hidden\n overflow-y scroll\n textarea\n  margin-bottom 10px\n  white-space pre\n pre\n  "+a.enableTextSelect(1)+"\n\n.modalClose\n position absolute\n top 10px\n right 10px\n cursor pointer"};
AbstractModalChisel.prototype.getModalBray=function(){return""};AbstractModalChisel.prototype.getBray=function(){return"@ section\n data-onClickCommand chisel _confirmAndUnmountCommand\n class modalBackground\n @ section\n  data-onClickCommand chisel _stopPropagationCommand\n  class modalContent\n  @ a\n   data-onClickCommand chisel _confirmAndUnmountCommand\n   class modalClose\n   bern X"+TreeNotation.nest(this.getModalBray(),2)};AbstractModalChisel.prototype.hasChanges=function(){return!1};
window.AbstractModalChisel=AbstractModalChisel;var BlockInspectorModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(BlockInspectorModal,AbstractModalChisel);BlockInspectorModal._mountedChisels=AbstractModalChisel._mountedChisels;BlockInspectorModal.prototype._getChildBlock=function(){return this.getApp().getTargetNode()};BlockInspectorModal.prototype.chiselDidMount=function(){AbstractModalChisel.prototype.chiselDidMount.call(this);this._getChildBlock();this.getApp()};
BlockInspectorModal.prototype.getHakon=function(){return AbstractModalChisel.prototype.getHakon.call(this)+"\n.BlockInspectorModal\n ol\n  list-style decimal\n  padding 20px\n pre\n  width 600px\n  overflow-x scroll\n textarea\n  width 600px\n  height 200px"};BlockInspectorModal.prototype.getModalBray=function(){return this._getChildBlock().getInspection()};window.BlockInspectorModal=BlockInspectorModal;var CardEditorModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};
$jscomp.inherits(CardEditorModal,AbstractModalChisel);CardEditorModal._mountedChisels=AbstractModalChisel._mountedChisels;CardEditorModal.prototype.chiselDidMount=function(){AbstractModalChisel.prototype.chiselDidMount.call(this);this._getTextArea().getShadow().setShadowValue(this.getCard().cardToString())};CardEditorModal.prototype._getTextArea=function(){return this.getStump().findStumpByChild("id editCardTextarea")};
CardEditorModal.prototype._deleteCardCommand=function(){this.getApp().closeModal();var a=this.getCard().getCardBlock();return this.getCard().destroyCardCommand().then(function(){a.executeLoadDataAndRender()})};CardEditorModal.prototype._saveCardCommand=function(){var a=this.getCard();a.reloadFromStr(this._getTextArea().getShadow().getShadowValue());a.getCardBlock().updateCards([a]);this.getApp().closeModal()};
CardEditorModal.prototype.getModalBray=function(){return"@ h4\n bern Editing node\n@ textarea\n class bigInput\n rows 20\n id editCardTextarea\n@ button\n title Delete card\n class leftButton\n data-onClickCommand chisel _deleteCardCommand\n bern "+Icons("trash",30)+"\n@ button\n title Save\n class rightButton\n data-onClickCommand chisel _saveCardCommand\n bern "+Icons("check",30)};CardEditorModal.prototype.getCard=function(){return this.getApp().getTargetNode()};window.CardEditorModal=CardEditorModal;
var CustomConfirmModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(CustomConfirmModal,AbstractModalChisel);CustomConfirmModal._mountedChisels=AbstractModalChisel._mountedChisels;CustomConfirmModal.prototype.getModalBray=function(){return"@ h4\n bern "+this.getBeam()+"\n@ button\n value 0\n data-onClickCommand chisel _resolveCommand\n bern Cancel\n@ button\n value 1\n data-onClickCommand chisel _resolveCommand\n bern Ok"};
CustomConfirmModal.prototype._resolveCommand=function(a){this.resolve("1"===a);this.getApp().closeModal();return Promise.resolve()};CustomConfirmModal.prototype.getHakon=function(){return AbstractModalChisel.prototype.getHakon.call(this)+"\n.CustomConfirmModal\n h4\n  text-align left\n button\n  padding 7px 20px"};CustomConfirmModal.prototype.getConfirmPromise=function(){var a=this;return new Promise(function(b,c){a.resolve=b;a.reject=c})};window.CustomConfirmModal=CustomConfirmModal;
var CustomPromptModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(CustomPromptModal,AbstractModalChisel);CustomPromptModal._mountedChisels=AbstractModalChisel._mountedChisels;CustomPromptModal.prototype.getModalBray=function(){return"@ h4\n bern "+this.findBeam("message")+"\n@ input\n value "+this.findBeam("value")+"\n@ button\n data-onClickCommand chisel _resolveCommand\n bern Ok"};CustomPromptModal.prototype.parseNodeType=function(a){return TreeNotation};
CustomPromptModal.prototype._resolveCommand=function(){var a=this.getStump().findStumpByTag("input");this.resolve(a.getShadow().getShadowValue());this.getApp().closeModal();return Promise.resolve()};CustomPromptModal.prototype.chiselDidMount=function(){AbstractModalChisel.prototype.chiselDidMount.call(this);this.getStump().findStumpByTag("input").getShadow().focusShadow()};CustomPromptModal.prototype.getHakon=function(){return AbstractModalChisel.prototype.getHakon.call(this)+"\n.CustomPromptModal\n h4\n  text-align left\n input\n  width 100%\n  display block\n  margin-bottom 20px\n button\n  padding 7px 20px"};
CustomPromptModal.prototype.getPromptPromise=function(){var a=this;return new Promise(function(b,c){a.resolve=b;a.reject=c})};window.CustomPromptModal=CustomPromptModal;var HelpModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(HelpModal,AbstractModalChisel);HelpModal._mountedChisels=AbstractModalChisel._mountedChisels;
HelpModal.prototype.getMomentHelp=function(){return"Char;Example;Description{YYYY;2014;4 or 2 digit year{YY;14;2 digit year{Y;-25;Year with any number of digits and sign{Q;1..4;Quarter of year. Sets month to first month in quarter.{M MM;1..12;Month number{MMM MMMM;Jan..December;Month name in locale set by moment.locale(){D DD;1..31;Day of month{Do;1st..31st;Day of month with ordinal{DDD DDDD;1..365;Day of year{X;1410715640.579;Unix timestamp{x;1410715640579;Unix ms timestamp{H HH;0..23;24 hour time{h hh;1..12;12 hour time used with a A.{a/p A/P;am pm;Post or ante meridiem{m mm;0..59;Minutes{s ss;0..59;Seconds{S SS SSS;0..999;Fractional seconds{Z ZZ;+12:00;Offset from UTC as +-HH:mm, +-HHmm, or Z{w ww;1..53;Locale week of year{e;0..6;Locale day of week{ddd dddd;Mon...Sunday;Day name in locale set by moment.locale(){E;1..7;ISO day of week".split("{").map(function(a){a=a.split(";");
return"<tr><td>"+a[0]+"</td><td>"+a[1]+"</td><td>"+a[2]+"</td></tr>"}).join("")};HelpModal.prototype.getHakon=function(){return AbstractModalChisel.prototype.getHakon.call(this)+"\np\n width 100%\n white-space normal\n.helpToggle\n display block\n.helpSection\n display none\n#shortcutsHelp td\n padding-right 10px"};
HelpModal.prototype._getShortcutsHelpBray=function(){var a="",b=this.getApp();return"@ table\n id shortcutsHelp\n class helpSection\n"+b.getKeyboardShortcuts().getChildren().map(function(c){var d=c.getCategory(),e="";d!==a&&(e=" @ tr\n  @ td\n   bern <br>"+d+"\n  @ td\n",a=d);d=c.getDescription();return e+" @ tr\n  style "+(d?"":"display: none;")+"\n  @ td\n   bern "+c.getKeyCombo()+"\n  @ td\n   @ "+(c.isEnabled(b)?"a":"span")+"\n    data-onClickCommand app "+c.getFn()+"\n    bern "+d}).join("\n")};
HelpModal.prototype.getModalBray=function(){var a=this.getApp(),b=Object.values(a.getETNs()).map(function(a){return new a}),c=b.map(function(a){return a.getDictionary()}),d=c.map(function(a){return a.getDocs()}).join("<br><br>"),c=c.map(function(a){return a.getLine()}).join(", ");a.getMountedProgram();return"@ h4\n bern About ohayo\n@ p\n bern ohayo will be the fastest programming tool in the solar system.\n@ p\n @ a\n  data-onClickCommand app openOhayoProgramCommand\n  value ohayo.flow\n  bern Welcome Page\n @ span\n  bern |\n @ a\n  data-onClickCommand app openOhayoProgramCommand\n  value readme.flow\n  bern Read Me\n @ span\n  bern |\n @ a\n  data-onClickCommand app openOhayoProgramCommand\n  value faq.flow\n  bern FAQ\n @ span\n  bern |\n @ a\n  data-onClickCommand app openOhayoProgramCommand\n  value releasenotes.flow\n  bern Release Notes\n @ span\n  bern |\n @ a\n  data-onClickCommand app openOhayoProgramCommand\n  value helloWorld.fire\n  bern Fire Hello World\n @ span\n  bern |\n @ a\n  data-onClickCommand app openOhayoProgramCommand\n  value fib.fire\n  bern Fire Fibonacci\n@ a\n class helpToggle\n data-onClickCommand app toggleShadowById\n value shortcutsHelp\n bern Keyboard Shortcuts\n"+
this._getShortcutsHelpBray()+"\n@ a\n class helpToggle\n data-onClickCommand app toggleShadowById\n value etnHelpSection\n bern ETN help\n@ div\n class helpSection\n id etnHelpSection\n @ p\n  bern ohayo currently supports "+b.length+" ETNs ("+c+"). Here are the available blocks.\n @ pre\n  bern"+TreeNotation.nest(d,3)+"\n@ p\n bern Version "+a.getVersion()+" "+a.constructor.name};window.HelpModal=HelpModal;var InsertCardModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};
$jscomp.inherits(InsertCardModal,AbstractModalChisel);InsertCardModal._mountedChisels=AbstractModalChisel._mountedChisels;InsertCardModal.prototype.chiselDidMount=function(){AbstractModalChisel.prototype.chiselDidMount.call(this);var a=this._getChildBlock(),b=this._getTextArea();b.getShadow().setShadowValue(a.getOutputBinder().toBlankFormTemplate());b.getShadow().focusShadow()};InsertCardModal.prototype._getChildBlock=function(){return this.getApp().getTargetNode()};
InsertCardModal.prototype._getTextArea=function(){return this.getStump().findStumpByChild("id newCardTextarea")};InsertCardModal.prototype._submitCardCommand=function(){var a=new TreeNotation(this._getTextArea().getShadow().getShadowValue());this._getChildBlock().createCards([a]);this.getApp().closeModal()};
InsertCardModal.prototype.getModalBray=function(){return"\n@ h4\n bern Insert\n@ textarea\n rows 20\n wrap off\n class bigInput\n id newCardTextarea\n@ button\n title Save\n data-onClickCommand chisel _submitCardCommand\n class SVGIcon rightButton\n bern "+Icons("check",30)};window.InsertCardModal=InsertCardModal;var InsertCardsModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(InsertCardsModal,AbstractModalChisel);InsertCardsModal._mountedChisels=AbstractModalChisel._mountedChisels;
InsertCardsModal.prototype.chiselDidMount=function(){AbstractModalChisel.prototype.chiselDidMount.call(this);this._getBulkTextarea().getShadow().focusShadow()};InsertCardsModal.prototype._getChildBlock=function(){return this.getApp().getTargetNode()};InsertCardsModal.prototype._getBulkTextarea=function(){return this.getStump().findStumpByChild("id bulkTextarea")};InsertCardsModal.prototype._getBulkAdvanced=function(){return this.getStump().findStumpByChild("id bulkAdvanced")};
InsertCardsModal.prototype._getBulkType=function(){return this.getStump().findStumpByChild("id bulkType")};InsertCardsModal.prototype._updateBulkTextAreaPlaceholderCommand=function(){var a=this._getBulkType().getShadow().getShadowValue(),a=(new CardParser).getExample(a)||"";this._getBulkTextarea().setStumpAttr("placeholder","Example:\n"+a);this._updateBulkTextAreaAdvancedCommand()};
InsertCardsModal.prototype._updateBulkTextAreaAdvancedCommand=function(){var a=this._getBulkTextarea(),b=this._getBulkAdvanced(),c=this._getBulkType().getShadow().getShadowValue(),d="";""===c?d="Detected: "+(new CardParser).inferEncoding(a.getShadow().getShadowValue()):"advanced"===c&&(d='Delimiter: <input placeholder="," id="bulkDelimiter">\n        <br>Enclosing Char: <input placeholder=\'"\' id="bulkEnclosingChar">\n        <br>Has Headers: <input type="checkbox" id="bulkHasHeader" checked>');
b.getShadow().setShadowHtml(d)};
InsertCardsModal.prototype._submitBulkInsertCommand=function(){var a=this.getApp(),b=this._getChildBlock(),c=this._getBulkTextarea().getShadow().getShadowValue(),d=this._getBulkType().getShadow().getShadowValue(),e=this.getStump().findStumpByChild;if("advanced"===d){d=e("id bulkDelimiter").getShadow().getShadowValue()||",";var f=e("id bulkEnclosingChar").getShadow().getShadowValue()||'"';e=e("id bulkHasHeader").getShadow().isShadowChecked();c=(new CardParser).parseAdvancedDelimited(c,e,d,f)}else c=
(new CardParser).parse(c,d);a.logMessage("Adding...");b.createCards(c);a.closeModal()};InsertCardsModal.prototype.getModalBray=function(){return"\n@ div\n id bulkCardsPopup\n @ h4\n  bern Insert Nodes\n  @ p\n   bern Enter nodes in any format: csv, newlines, tsv, json, or tree.\n  @ div\n   class form-group\n   @ textarea\n    data-onChangeCommand chisel _updateBulkTextAreaAdvancedCommand\n    class bigInput\n    rows 15\n    id bulkTextarea\n    wrap off\n  @ div\n   class form-group\n   @ label\n    for bulkType\n    bern Format\n   @ select\n    data-onChangeCommand chisel _updateBulkTextAreaPlaceholderCommand\n    class bigInput\n    id bulkType\n    @ option\n     bern Detect\n     value \n    @ option\n     value csv\n     bern CSV\n    @ option\n     value tsv\n     bern TSV\n    @ option\n     value json\n     bern JSON\n    @ option\n     value ssv\n     bern SSV\n    @ option\n     value rss\n     bern RSS\n    @ option\n     value tree\n     bern Tree\n    @ option\n     value list\n     bern List\n    @ option\n     value spaced\n     bern Spaced Trees\n    @ option\n     value sections\n     bern Sections\n    @ option\n     value advanced\n     bern Advanced Delimited\n   @ div\n    id bulkAdvanced\n    bern &nbsp;\n   @ button\n    type button\n    class buttonPrimary\n    data-onClickCommand chisel _submitBulkInsertCommand\n    bern Insert"};
window.InsertCardsModal=InsertCardsModal;var NodeEditorModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(NodeEditorModal,AbstractModalChisel);NodeEditorModal._mountedChisels=AbstractModalChisel._mountedChisels;NodeEditorModal.prototype.hasChanges=function(){var a=this.getNode(),b=this._getLatest();return b.children!==a.childrenToString()||b.line!==a.getLine()};
NodeEditorModal.prototype._getLatest=function(){this.getStump();return{children:this._getTextarea().getShadow().getShadowValue(),line:this._getInput().getShadow().getShadowValue()}};NodeEditorModal.prototype._saveChangesCommand=function(){var a=this.getNode(),b=this._getLatest();a.setChildren(b.children||void 0);a.setLine(b.line);a=this.getApp();a.closeModal();a.getMountedProgram().autosaveAndRender()};NodeEditorModal.prototype._getTextarea=function(){return this.getStump().findStumpByTag("textarea")};
NodeEditorModal.prototype._getInput=function(){return this.getStump().findStumpByTag("input")};NodeEditorModal.prototype._deleteNodeCommand=function(){var a=this,b=this.getApp();return b.confirm("Delete. Are you sure?").then(function(c){if(!c)return!1;c=a.getNode();c.unmountAndDestroy?c.unmountAndDestroy():c.destroy();b.closeModal();b.getMountedProgram().autosaveAndRender();return!0})};
NodeEditorModal.prototype.chiselDidMount=function(){var a=this.getNode();this._getTextarea().getShadow().setShadowValue(a.childrenToString()||"");this._getInput().getShadow().setShadowValue(a.getLine()||"")};NodeEditorModal.prototype.getNode=function(){return this.getApp().getTargetNode()};
NodeEditorModal.prototype.getModalBray=function(){return"@ h4\n bern Editing '"+this.getNode().getBasePath()+"'\n @ div\n  class monospaceModal\n  @ input\n  @ textarea\n@ button\n title Delete\n data-onClickCommand chisel _deleteNodeCommand\n class leftButton\n bern "+Icons("trash",30)+"\n@ button\n title Save\n data-onClickCommand chisel _saveChangesCommand\n class SVGIcon rightButton\n bern "+Icons("check",30)};window.NodeEditorModal=NodeEditorModal;
var NodePickerModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};$jscomp.inherits(NodePickerModal,AbstractModalChisel);NodePickerModal._mountedChisels=AbstractModalChisel._mountedChisels;NodePickerModal.prototype.getHakon=function(){var a=this.getTheme();return AbstractModalChisel.prototype.getHakon.call(this)+"\n.base\n color "+a.linkColor+"\n cursor pointer"};
NodePickerModal.prototype._openNodeEditorCommand=function(a){a=a.split(" ").map(function(a){return parseInt(a)});a=a.splice(2);app.closeModal();app.openNodeEditorModalCommand(a)};
NodePickerModal.prototype.getModalBray=function(){var a=this.getApp().getMountedProgram().getTopDownArray().map(function(a){return"@ span\n data-onClickCommand chisel _openNodeEditorCommand\n value "+a.getPathVector().join(" ")+"\n bern "+a.getLine()}).join("\n");return"@ h4\n bern Click a property to edit\n@ div\n class monospaceModal\n @ div"+TreeNotation.nest(a,2)};window.NodePickerModal=NodePickerModal;var SourceEditorModal=function(a){return AbstractModalChisel.apply(this,arguments)||this};
$jscomp.inherits(SourceEditorModal,AbstractModalChisel);SourceEditorModal._mountedChisels=AbstractModalChisel._mountedChisels;SourceEditorModal.prototype.hasChanges=function(){return this._getTextarea().getShadow().getShadowValue()!==this.getApp().getMountedProgram().childrenToString()};SourceEditorModal.prototype._getTextarea=function(){return this.getStump().findStumpByTag("textarea")};
SourceEditorModal.prototype._saveChangesCommand=function(){var a=this.getApp(),b=this._getTextarea(),c=a.getMountedProgram(),b=b.getShadow().getShadowValue();c.setChildren(b);a.closeModal();c.autosaveAndRender()};SourceEditorModal.prototype.chiselDidMount=function(){this._getTextarea().getShadow().setShadowValue(this.getApp().getMountedProgram().childrenToString())};
SourceEditorModal.prototype.getModalBray=function(){return"@ h4\n bern Edit Source\n@ textarea\n rows 20\n class bigInput\n wrap off\n@ button\n title Save\n data-onClickCommand chisel _saveChangesCommand\n class SVGIcon rightButton\n bern "+Icons("check",30)};window.SourceEditorModal=SourceEditorModal;var OhayoApp=function(a){return AbstractAppChisel.apply(this,arguments)||this};$jscomp.inherits(OhayoApp,AbstractAppChisel);OhayoApp._mountedChisels=AbstractAppChisel._mountedChisels;
OhayoApp.prototype.fetchProgram=function(a){a.setChildrenAndDiskAndUndoStack(this.getFromStore(a.getUrl()));return Promise.resolve()};OhayoApp.prototype.chiselWillMount=function(){AbstractAppChisel.prototype.chiselWillMount.call(this);1===this._getVisitCount()&&this.playFirstVisitCommand()};OhayoApp.prototype.playFirstVisitCommand=function(){var a=this;return this.openOhayoProgramCommand("readme.flow faq.flow releasenotes.flow helloWorld.fire").then(function(){return a.openOhayoProgramCommand("ohayo.flow")})};
OhayoApp.prototype.saveProgramToDisk=function(a,b){this.storeValue(a.getFileName(),b.newVersion);return Promise.resolve()};OhayoApp.prototype.getCaddies=function(){var a=this;return this.getStoreKeys().filter(function(a){return!StorageKeys.isKey(a)}).map(function(b){return new LocalStorageCaddy(a.getFromStore(b),b)})};OhayoApp.prototype.getProgramToOpen=function(){return this.getFromStore(StorageKeys.mountedProgram)};OhayoApp.prototype.doesFileExistSync=function(a){return void 0!==this.getFromStore(a)};
OhayoApp.prototype.deleteFileCommand=function(a){this.removeValue(a);return Promise.resolve()};OhayoApp.prototype.renameFileCommand=function(a,b,c){this.storeValue(b,this.getFromStore(a)||"");this.removeValue(a);return Promise.resolve(b)};OhayoApp.prototype._createFile=function(a,b){a=this._getAvailablePermalink(a);this.storeValue(a,b);return Promise.resolve(a)};OhayoApp.prototype.createAndOpen=function(a,b){var c=this;return this._createFile(b,a).then(function(a){return c.openUrlInNewSpaceAndFocus(a)})};
window.OhayoApp=OhayoApp;var Version="3.1.2";"undefined"!==typeof exports&&(module.exports=Version);var WillowBernNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(WillowBernNode,TreeNotation);WillowBernNode.prototype._toHtml=function(){return this.getBeamWithChildren()};var WillowAttributeNode=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(WillowAttributeNode,TreeNotation);WillowAttributeNode.prototype._toHtml=function(){return""};
WillowAttributeNode.prototype.getAttribute=function(){return" "+this.getBase()+'="'+this.getBeam()+'"'};var Stump=function(a){return TreeNotation.apply(this,arguments)||this};$jscomp.inherits(Stump,TreeNotation);Stump.prototype.getTag=function(){return this.getWord(1)};Stump.prototype.parseNodeType=function(a){return a.startsWith("@")?Stump:a.startsWith("bern ")||"bern"===a?WillowBernNode:WillowAttributeNode};Stump.prototype._childrenToHtml=function(a){return this.getChildren().map(function(b){return b._toHtml(a)}).join("")};
Stump.prototype.toHtml=function(){return this.isRoot()?TreeNotation.prototype.toHtml.call(this):this._toHtml()};Stump.prototype.toHtmlWithSuids=function(){return this.isRoot()?TreeNotation.prototype.toHtml.call(this):this._toHtml(void 0,!0)};
Stump.prototype._toHtml=function(a,b){var c=this.getTag(),d=this.getChildren().map(function(c){return c._toHtml(a+1,b)}).join(""),e=this.getChildrenByNodeType(WillowAttributeNode).map(function(a){return a.getAttribute()}).join(""),f=" ".repeat(a),g="@!"===this.getWord(0),h=!g&&0<this.getChildrenByNodeType(Stump).length,k=b?' data-suid="'+this._getUid()+'"':"";return(g?"":f)+"<"+c+e+k+">"+(h?"\n":"")+d+"</"+c+">"+(g?"":"\n")};Stump.prototype.removeStump=function(){this.getShadow().removeShadow();return this.destroy()};
Stump.prototype.getNodeByGuid=function(a){return this.getTopDownArray().find(function(b){return b._getUid()===a})};Stump.prototype.addClassToStump=function(a){var b=this.touchNode("class"),c=b.getWords();if(c.includes(a))return this;b.setWord(c.length,a);return this};Stump.prototype.removeClassFromStump=function(a){var b=this.getNode("class");if(!b)return this;a=b.getLine().replace(" "+a,"");"class"===a?b.destroy():b.setLine(a);return this};
Stump.prototype.stumpHasClass=function(a){var b=this.getNode("class");return b&&b.getWords().includes(a)?!0:!1};Stump.prototype.isStumpCheckbox=function(){return"checkbox"===this.findBeam("type")};Stump.prototype.getShadow=function(){return new (this.getShadowClass())(this)};Stump.prototype.insertChildNode=function(a,b){a=(new TreeNotation(a)).getChildren()[0];b=this.insert(a.getLine(),a.childrenToString(),b);a=this.getChildrenByNodeType(Stump).indexOf(b);this.getShadow().insertHtmlNode(b,a);return b};
Stump.prototype.isInputType=function(){return["input","div","textarea"].includes(this.getTag())||"true"===this.findBeam("contenteditable")};Stump.prototype.findStumpByChild=function(a){return this.findStumpsByChild(a)[0]};Stump.prototype.findStumpByTag=function(a){return this.findStumpsByTag(a)[0]};Stump.prototype.findStumpsByTag=function(a){return this.getTopDownArray().filter(function(b){return b instanceof Stump&&b.getWord(1)===a})};
Stump.prototype.hasLine=function(a){return this.getChildren().some(function(b){return b.getLine()===a})};Stump.prototype.findStumpsByChild=function(a){return this.getTopDownArray().filter(function(b){return b instanceof Stump&&b.hasLine(a)})};Stump.prototype.findStumpsWithClass=function(a){return this.getTopDownArray().filter(function(b){return b instanceof Stump&&b.has("class")&&b.getNode("class").getWords().includes(a)})};Stump.prototype.getShadowClass=function(){return this.getParent().getShadowClass()};
Stump.prototype.getLines=function(a,b){a=void 0===a?0:a;return this.toString().split("\n").slice(a,b).join("\n")};Stump.prototype.getStumpChisel=function(){return this._chisel||this.getParent().getStumpChisel()};Stump.prototype.setStumpChisel=function(a){this._chisel=a;return this};Stump.prototype.setStumpCss=function(a){this.getShadow().setShadowCss(a);return this};Stump.prototype.getStumpCss=function(a){return this.getShadow().getShadowCss(a)};Stump.prototype.getStumpAttr=function(a){return this.findBeam(a)};
Stump.prototype.setStumpAttr=function(a,b){return this};window.Stump=Stump;var DemoTemplates="faq.flow >url faq.md\n  format text\n  visible false\n  >markdown\nreadme.flow >url readme.md\n  format text\n  visible false\n  >markdown\nreleasenotes.flow >url releasenotes.md?06232017\n  format text\n  visible false\n  >markdown\nohayo.flow >youtube 8rwsuXHA7RA\nhelloWorld.fire =fn main\n  ::$ Hello world\n >> main\ntreeConsole.flow layout bin\n >data\n  slang hello world\n  format tree\n  >outline\n   dots true\n  >outline\nfib.fire =fn fib num\n  =< lessThan1 num 1\n  if lessThan1\n   return 0\n  =<= lessOr2 num 2\n  if lessOr2\n   return 1\n  =- oneLess num 1\n  =- twoLess num 2\n  =>> oneLessFib fib oneLess\n  =>> twoLessFib fib twoLess\n  =+ sum oneLessFib twoLessFib\n  return sum\n =>> result fib 10\n =#+ tests 0 1 2 3 4 5 6 7 8 9 10\n =.>> results tests map fib\n :: results\n >settings layout tree";
window.DemoTemplates=DemoTemplates;var DesktopTemplates={fileTypes:{}};DesktopTemplates.fileTypes.other=function(a){return">text No visualization templates for "+a};DesktopTemplates.fileTypes.csv=function(a){return">csv\n path "+a+"\n >scatter\n  limit 100\n >table\n  limit 100"};DesktopTemplates.fileTypes.xlsx=function(a){return">excel\n url "+a+"\n >scatter\n  limit 100\n >table\n  limit 100"};DesktopTemplates.fileTypes.json=function(a){return">files\n path "+a+"\n >read\n  >parse\n   column bytes\n   format json\n   >tree"};
DesktopTemplates.fileTypes.tree=function(a){return">files\n path "+a+"\n >read\n  >parse\n   column bytes\n   format tree\n   >tree"};DesktopTemplates.fileTypes.png=function(a){return'>html\n slang <img src="'+a+'" />'};DesktopTemplates.fileTypes.gif=DesktopTemplates.fileTypes.png;DesktopTemplates.fileTypes.jpg=DesktopTemplates.fileTypes.png;DesktopTemplates.fileTypes.jpeg=DesktopTemplates.fileTypes.png;DesktopTemplates.fileTypes.md=function(a){return">file\n path "+a+"\n format text\n >text\n >kpidown"};
DesktopTemplates.fileTypes.html=function(a){return">file\n path "+a+"\n format xml\n >tree\n>file\n path "+a+"\n format text\n >text"};DesktopTemplates.fileTypes.txt=function(a){return">file\n path "+a+"\n format text\n >text\n >wordcount\n  >wordcloud\n  >table\n   title Word Use\n   orderBy -count"};DesktopTemplates.fileTypes.sqlite=function(a){return">sqlite\n file "+a+"\n query SELECT * FROM sqlite_master where type='table'\n pin 0 0 10 6\n >filter\n  filter !name _\n  pin 11 0 9 6\n  >table\n   pin 0 7 39 7\n  >kpi\n   pin 21 0 9 6\n   input tables"};
DesktopTemplates.fileTypes.js=function(a){return">params\n path "+a+"\n>typescript\n path {params path}\n >table\n  title Tokens in file: {params path}\n  limit 1000\n  orderBy category\n  pin 0 0 21 37\n >kpi\n  pin 39 3 10 9\n  reduction sum\n  column count\n  title Tokens\n >group\n  by category\n  columns\n   count\n    reduction sum\n  pin 30 14 11 8\n  >table\n   pin 24 23 17 13\n   orderBy -categoryCount\n>files\n path {params path}\n stats true\n read true\n >kpi\n  pin 25 3 12 9\n  column size\n  reduction max\n  title Bytes\n >kpi\n  todo: Add a text stats transformer.\n  pin 25 13 12 9\n  column lineCount\n  reduction min\n  title Lines"};
DesktopTemplates.finder=function(a){var b=a.split("/");b.pop();b=b.join("/");return">files\n path "+a+"\n stats true\n columns\n  mtime\n   format fromNow\n  atime\n   format fromNow\n  ctime\n   format fromNow\n >text You are currently exploring the folder: "+a+'\n  pin 21 3 50 2\n >list\n  title Subfolders\n  link link\n  pin 0 6 35 18\n  filter "isDirectory":true\n >list\n  title All files\n  link link\n  pin 36 6 35 18\n >table\n  title All files\n  link link\n  pin 36 25 35 19\n  showColumns name size filetype mtime atime ctime\n  hideColumns blocks ino blksize rdev gid uid nlink mode dev atime mtime ctime birthtime size link isDirectory\n  orderBy -mtime\n  pretty true\n >scatter\n  title All files\n  link link\n  pin 0 25 35 19\n  showColumns name size filetype mtime atime ctime\n  hideColumns blocks ino blksize rdev gid uid nlink mode dev atime mtime ctime birthtime size link isDirectory\n  orderBy -mtime\n  pretty true\n  x ctime\n  y size\n >text Folder Explorer: Folder explorer visualizes a folder on your Mac, and let\'s you create charts and find stories in the data in those folders.\n  pin 0 0 71 2\n >html\n  pin 0 3 20 2\n  slang <a href="'+
b+'">'+b+"</a>"};window.DesktopTemplates=DesktopTemplates;var FlowCodeEditorTemplate=function(a,b){return">editor\n format text\n etn "+b+"\n slang"+TreeNotation.nest(a,2)+"\n >3d\n >outline\n >types\n  >pre\n   >wc\n    >table\n    >wordcloud\n>settings\n layout bin"};window.FlowCodeEditorTemplate=FlowCodeEditorTemplate;var MiniTemplate=">programs\n visible false\n >mini\n  title My Programs\n  orderBy link";window.MiniTemplate=MiniTemplate;
var SpeedTestTemplate=function(a,b){return">data\n pin 45 32 17 5\n slang "+b.replace(/\n/g,"\n  ")+"\n columns\n  timeToLoad\n   type number\n  timeToRender\n   type number\n >text "+a+"\n  pin 45 0 23 3\n >table\n  link url\n  title Slow Load Times\n  x timeToLoad\n  y timeToRender\n  orderBy -timeToLoad\n  pin 0 0 43 18\n >table\n  link url\n  title Slow Render Times\n  x timeToLoad\n  y timeToRender\n  orderBy -timeToRender\n  pin 0 20 41 17\n >kpi\n  pin 45 4 11 7\n  column timeToLoad\n  reduction average\n >kpi\n  pin 45 15 11 7\n  column timeToRender\n  reduction average\n >kpi\n  pin 45 24 11 7\n  column timeToRender\n  reduction median\n >kpi\n  pin 57 4 11 7\n  column timeToLoad\n  reduction sum\n >kpi\n  pin 57 15 11 7\n  column timeToRender\n  reduction sum\n >kpi\n  pin 57 24 11 7\n  column timeToRender\n  reduction count"};
window.SpeedTestTemplate=SpeedTestTemplate;
var Theme=function(a){var b=a=void 0===a?{}:a,c=void 0===b.backgroundColor?"rgb(255,255,255)":b.backgroundColor,d=void 0===b.foregroundColor?"black":b.foregroundColor,e=void 0===b.fn?"lighten":b.fn,b=void 0===b.selectionColor?"rgb(42, 89, 178)":b.selectionColor;this.blockBackgroundColor=this.contextMenuBackground=this.surfaceBackground=this.bodyBackground=this.programsBackground=this.tabBackground=this.menuBackground=this.backgroundColor=c;this.foregroundColor=this.menuChiselColor=d;this.lineColor=
tinycolor(d).setAlpha(.075).toString();this.boxShadow=tinycolor(d).setAlpha(.1).toString();this.darkerBackground=tinycolor(c).darken(10).toString();c=function(a){return tinycolor(d)[e](a).toString()};this.darkBlack=c(20);this.bodyColor=this.mediumBlack=c(40);this.midGray=c(60);this.greyish=c(82);this.lightGrey=c(93);this.veryLightGrey=c(97);this.borderColor=this.greyish;this.linkColor=this.hoverBackground=b;this.selectedOutline=tinycolor(b).setAlpha(.8).toString();this.selectionBackground=tinycolor(b).setAlpha(.1).toString();
this.errorColor="rgb(226, 120, 121)";this.successColor="#4CAF50";this.white="#fff";this.fonts="'San Francisco', 'Myriad Set Pro', 'Lucida Grande', 'Helvetica Neue', Helvetica, Arial, Verdana, sans-serif";this.modalDimmerBackground=tinycolor("#000").setAlpha(.4).toString();Object.assign(this,a)};Theme.prototype.enableTextSelect=function(a){return Theme._getIndented(a,"-moz-user-select text\n  -webkit-user-select text\n  -ms-user-select text\n  user-select text")};
Theme.prototype.getHeatColor=function(a){return"hsl(200, "+(25+75*a)+"%, "+(20+25*a)+"%)"};Theme._getIndented=function(a,b){return b.split(/\n/g).join("\n"+" ".repeat(a))};Theme.prototype.disableTextSelect=function(a){return Theme._getIndented(a,"-webkit-touch-callout none\n-webkit-user-select none\n-khtml-user-select none\n-moz-user-select none\n-ms-user-select none\nuser-select none")};Theme.prototype.hakonToCss=function(a){return(new HakonProgram(a)).toCss()};var Themes={};
Themes.light=new Theme({menuBackground:"#3B539A",menuChiselColor:"white"});Themes.dark=new Theme({backgroundColor:"rgb(16, 16, 16)",foregroundColor:"#fff",fn:"darken"});
var glassColors={selectionColor:"rgba(46, 195, 212, .9)",bodyBackground:"linear-gradient(130deg, rgb(56, 114, 127), rgb(28, 98, 151) 45%, rgb(62, 73, 135))",backgroundColor:"rgba(0,0,0,.12)",contextMenuBackground:"rgba(0,0,0,.90)",blockBackgroundColor:"rgba(0,0,0,.12)",programsBackground:"transparent",boxShadow:"transparent",surfaceBackground:"transparent",borderColor:"transparent",foregroundColor:"#eee"};Themes.glass=new Theme(glassColors);glassColors.blockBackgroundColor="transparent";
Themes.clearGlass=new Theme(glassColors);window.Themes=Themes;
var Util={getFileExtension:function(a){return(a=(void 0===a?"":a).match(/\.([^\.]+)$/))&&a[1]||""},removeFileExtension:function(a){a=void 0===a?"":a;if(!a.includes("."))return a;a=a.split(".");a.pop();return a.join(".")},getUniqueWordsArray:function(a){var b={};a.replace(/\n/g," ").split(" ").forEach(function(a){b[a]||(b[a]=0);b[a]++});return Object.keys(b).map(function(a){return{word:a,count:b[a]}})},makeSemiRandomFn:function(a){a=void 0===a?1:a;return function(){var b=1E4*Math.sin(a++);return b-
Math.floor(b)}},getAvailablePermalink:function(a,b){var c=Util.getFileExtension(a);a=Util.removeFileExtension(a);for(var d=2,e="",f=""+a+e+"."+c;b(f);)f=""+a+e+"."+c,e="-"+d,d++;return f},pLimit:function(a){var b=[],c=0;return function(d){return new Promise(function(e,f){var g=function(){c++;d().then(function(a){e(a);c--;b.length&&b.shift()()},function(a){f(a);c--;b.length&&b.shift()()})};c<a?g():b.push(g)})}},sortByAccessor:function(a){return function(b,c){b=a(b);c=a(c);var d=b<c?-1:b>c?1:0;void 0===
b&&void 0!==c?d=-1:void 0===c&&void 0!==b&&(d=1);return d}},toggle:function(a,b){a=b.indexOf(a);return-1===a||a+1===b.length?b[0]:b[a+1]},sortByFast:function(a,b){var c=[],d=b.split(/ /g).map(function(a,b){return"-"===a.substr(0,1)?(c[b]=!0,a.substr(1)):a}),e=function(a,b,h){var f=d[h];if(!f)return 0;var g=a.getCardNumeric()[f],f=b.getCardNumeric()[f];return g===f?e(a,b,h+1):g>f?c[h]?-1:1:c[h]?1:-1};a.sort(function(a,b){return e(a,b,0)})},joinArraysOn:function(a,b,c){var d={};c||(c=b.map(function(a){return Object.keys(a[0])}));
b.forEach(function(b,f){var e=c[f];b.forEach(function(b){var c=a?b[a]:f++;d[c]||(d[c]={});var g=d[c];e.forEach(function(a){return g[a]=b[a]})})});return Object.values(d)}};window.Util=Util;var AbstractShadow=function(a){this._stump=a};AbstractShadow.prototype.getShadowStump=function(){return this._stump};AbstractShadow.prototype.getShadowValue=function(){return""};AbstractShadow.prototype.setShadowValue=function(a){return this};AbstractShadow.prototype.removeShadow=function(){return this};
AbstractShadow.prototype.makeResizable=function(){return this};AbstractShadow.prototype.makeDraggable=function(){return this};AbstractShadow.prototype.makeSelectable=function(){return this};AbstractShadow.prototype.focusShadow=function(){return this};AbstractShadow.prototype.isShadowChecked=function(){return!1};AbstractShadow.prototype.getShadowHtml=function(){return""};AbstractShadow.prototype.getShadowOffset=function(){return{left:111,top:111}};AbstractShadow.prototype.getShadowWidth=function(){return 111};
AbstractShadow.prototype.getShadowHeight=function(){return 111};AbstractShadow.prototype.isShadowResizable=function(){return!1};AbstractShadow.prototype.bindShadow=function(){return this};AbstractShadow.prototype.toggleShadow=function(){};AbstractShadow.prototype.setShadowHtml=function(a){return this};AbstractShadow.prototype.onShadowEvent=function(){return this};AbstractShadow.prototype.offShadowEvent=function(){return this};AbstractShadow.prototype.triggerShadowEvent=function(a){return this};
AbstractShadow.prototype.getShadowPosition=function(){return{left:111,top:111}};AbstractShadow.prototype.getShadowOuterHeight=function(){return 11};AbstractShadow.prototype.getShadowOuterWidth=function(){return 11};AbstractShadow.prototype.getShadowCss=function(){return""};AbstractShadow.prototype.setShadowCss=function(){return this};AbstractShadow.prototype.insertHtmlNode=function(){};AbstractShadow.prototype.getShadowElement=function(){};window.AbstractShadow=AbstractShadow;
var WillowStore=function(){this._values={}};WillowStore.prototype.get=function(a){return this._values[a]};WillowStore.prototype.set=function(a,b){this._values[a]=b;return this};WillowStore.prototype.remove=function(a){delete this._values[a]};WillowStore.prototype.each=function(a){var b=this;Object.keys(this._values).forEach(function(c){a(b._values[c],c)})};WillowStore.prototype.clearAll=function(){this._values={}};var WillowMousetrap=function(){this.prototype={}};WillowMousetrap.prototype.bind=function(){};
var AbstractWillowDocument=function(a){var b=Stump.call(this,"@ html\n @ head\n @ body")||this;b._htmlStump=b.nodeAt(0);b._headStump=b.nodeAt(0).nodeAt(0);b._bodyStump=b.nodeAt(0).nodeAt(1);b.addSuidsToHtmlHeadAndBodyShadows();b._baseUrl=a;a=new miuri(a);b.location={};b.location.hostname=a.hostname();return b};$jscomp.inherits(AbstractWillowDocument,Stump);AbstractWillowDocument.prototype.addSuidsToHtmlHeadAndBodyShadows=function(){};AbstractWillowDocument.prototype.getShadowClass=function(){return Shadow};
AbstractWillowDocument.prototype.toggleFullScreen=function(){};AbstractWillowDocument.prototype.getMousetrap=function(){this._mousetrap||(this._mousetrap=new WillowMousetrap);return this._mousetrap};AbstractWillowDocument.prototype._getFocusedShadow=function(){return this._focusedShadow||this.getBodyStump().getShadow()};AbstractWillowDocument.prototype.getHeadStump=function(){return this._headStump};AbstractWillowDocument.prototype.getBodyStump=function(){return this._bodyStump};
AbstractWillowDocument.prototype.getHtmlStump=function(){return this._htmlStump};AbstractWillowDocument.prototype.getStore=function(){this._store||(this._store=new WillowStore);return this._store};AbstractWillowDocument.prototype.someInputHasFocus=function(){var a=this._getFocusedShadow();return a?(a=a.getShadowStump())&&a.isInputType():!1};AbstractWillowDocument.prototype.isNode=function(){return"undefined"!==typeof exports};AbstractWillowDocument.prototype.copyTextToClipboard=function(){};
AbstractWillowDocument.prototype.setCopyData=function(a,b){};AbstractWillowDocument.prototype._makeRelativeUrlAbsolute=function(a){return a.startsWith("http://")||a.startsWith("https://")?a:this._baseUrl.replace(/\/$/,"")+a};AbstractWillowDocument.prototype.get=function(a,b){a=this._makeRelativeUrlAbsolute(a);return superagent.get(a).query(b).set(this._headers||{}).then(function(a){return a.body||a.text})};
AbstractWillowDocument.prototype.post=function(a,b){a=this._makeRelativeUrlAbsolute(a);return superagent.post(a).set(this._headers||{}).send(b).then(function(a){return a.body||a.text})};AbstractWillowDocument.prototype.encodeURIComponent=function(a){return encodeURIComponent(a)};AbstractWillowDocument.prototype.downloadFile=function(a,b,c){};AbstractWillowDocument.prototype.appendScript=function(a){return Promise.resolve()};
AbstractWillowDocument.prototype.getWindowTitle=function(){var a=this.getTopDownArray().find(function(a){return"title"===a.getBase()});return a?a.getBeam():""};AbstractWillowDocument.prototype.setWindowTitle=function(a){this.getTopDownArray().find(function(a){return"head"===a.getWord(1)}).touchNode("title").setBeam(a);return this};AbstractWillowDocument.prototype._getHostname=function(){return this.location.hostname||""};AbstractWillowDocument.prototype.openUrl=function(a){};
AbstractWillowDocument.prototype.getPageHtml=function(){return this.toHtmlWithSuids()};AbstractWillowDocument.prototype.getStumpFromElement=function(a){};AbstractWillowDocument.prototype.setPasteHandler=function(a){return this};AbstractWillowDocument.prototype.setErrorHandler=function(a){return this};AbstractWillowDocument.prototype.setWindowBlurHandler=function(a){return this};AbstractWillowDocument.prototype.setWindowFocusHandler=function(a){return this};
AbstractWillowDocument.prototype.setCopyHandler=function(a){return this};AbstractWillowDocument.prototype.setCutHandler=function(a){return this};AbstractWillowDocument.prototype.setResizeEndHandler=function(a){return this};AbstractWillowDocument.prototype.getWindowSize=function(){return{width:1111,height:1111}};AbstractWillowDocument.prototype.getDocumentSize=function(){return this.getWindowSize()};
AbstractWillowDocument.prototype.isExternalLink=function(a){if(a&&"/"===a.substr(0,1)||!a.includes(":"))return!1;var b=this._getHostname();a=new miuri(a);return a.hostname()&&b!==a.hostname()};AbstractWillowDocument.prototype.forceRepaint=function(){};AbstractWillowDocument.prototype.blurFocusedInput=function(){};window.AbstractWillowDocument=AbstractWillowDocument;var BrowserDocument=function(a){return AbstractWillowDocument.apply(this,arguments)||this};$jscomp.inherits(BrowserDocument,AbstractWillowDocument);
BrowserDocument.prototype.findStumpsByShadowClass=function(a){var b=[],c=this;jQuery("."+a).each(function(){b.push(c.getStumpFromElement(this))});return b};BrowserDocument.prototype.addSuidsToHtmlHeadAndBodyShadows=function(){jQuery("html").attr("data-suid",this.getHtmlStump()._getUid());jQuery("head").attr("data-suid",this.getHeadStump()._getUid());jQuery("body").attr("data-suid",this.getBodyStump()._getUid())};BrowserDocument.prototype.getShadowClass=function(){return BrowserShadow};
BrowserDocument.prototype.setCopyHandler=function(a){jQuery(document).on(ShadowEvents.copy,a);return this};BrowserDocument.prototype.setCutHandler=function(a){jQuery(document).on(ShadowEvents.cut,a);return this};BrowserDocument.prototype.setPasteHandler=function(a){window.addEventListener(ShadowEvents.paste,a,!1);return this};BrowserDocument.prototype.setErrorHandler=function(a){window.addEventListener("error",a);return this};
BrowserDocument.prototype.toggleFullScreen=function(){var a=document;a.fullScreenElement&&null!==a.fullScreenElement||!a.mozFullScreen&&!a.webkitIsFullScreen?a.documentElement.requestFullScreen?a.documentElement.requestFullScreen():a.documentElement.mozRequestFullScreen?a.documentElement.mozRequestFullScreen():a.documentElement.webkitRequestFullScreen&&a.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.cancelFullScreen?a.cancelFullScreen():a.mozCancelFullScreen?a.mozCancelFullScreen():
a.webkitCancelFullScreen&&a.webkitCancelFullScreen()};BrowserDocument.prototype.setCopyData=function(a,b){a=a.originalEvent;a.preventDefault();a.clipboardData.setData("text/plain",b);a.clipboardData.setData("text/html",b)};BrowserDocument.prototype.getMousetrap=function(){return Mousetrap};
BrowserDocument.prototype.copyTextToClipboard=function(a){var b=document.createElement("textarea");b.style.position="fixed";b.style.top=0;b.style.left=0;b.style.width="2em";b.style.height="2em";b.style.padding=0;b.style.border="none";b.style.outline="none";b.style.boxShadow="none";b.style.background="transparent";b.value=a;document.body.appendChild(b);b.select();try{document.execCommand("copy")}catch(c){}document.body.removeChild(b)};BrowserDocument.prototype.getStore=function(){return store};
BrowserDocument.prototype._getHostname=function(){return location.hostname};
BrowserDocument.prototype.appendScript=function(a){if(!a)return Promise.resolve();this._loadingPromises||(this._loadingPromises={});if(this._loadingPromises[a])return this._loadingPromises[a];if(this.isNode())return Promise.resolve();var b=new Promise(function(b,d){var c=!1,f=document.createElement("script");f.type="text/javascript";f.src=a;f.async=!0;f.onload=f.onreadystatechange=function(){c||this.readyState&&"complete"!=this.readyState||(c=!0,b(this))};f.onerror=f.onabort=d;document.head.appendChild(f)});
return this._loadingPromises[a]=b};BrowserDocument.prototype.downloadFile=function(a,b,c){var d=document.createElement("a");d.setAttribute("href","data:"+c+","+encodeURIComponent(a));d.setAttribute("download",b);d.click()};BrowserDocument.prototype.openUrl=function(a){window.open(a)};BrowserDocument.prototype.setWindowBlurHandler=function(a){jQuery(window).on(ShadowEvents.blur,a);return this};
BrowserDocument.prototype.setResizeEndHandler=function(a){var b;$(window).on(ShadowEvents.resize,function(c){$(c.target).is("div")||(clearTimeout(b),b=setTimeout(a,100))});return this};BrowserDocument.prototype.setWindowFocusHandler=function(a){jQuery(window).on(ShadowEvents.focus,a);return this};BrowserDocument.prototype.getStumpFromElement=function(a){return this.getHtmlStump().getNodeByGuid(parseInt(jQuery(a).attr("data-suid")))};BrowserDocument.prototype.forceRepaint=function(){jQuery(window).width()};
BrowserDocument.prototype.getBrowserHtml=function(){return document.documentElement.outerHTML};BrowserDocument.prototype.getWindowSize=function(){var a=jQuery(window);return{width:a.width(),height:a.height()}};BrowserDocument.prototype.getDocumentSize=function(){var a=jQuery(document);return{width:a.width(),height:a.height()}};BrowserDocument.prototype.blurFocusedInput=function(){document.activeElement.blur()};
BrowserDocument.prototype._getFocusedShadow=function(){var a=this.getStumpFromElement(document.activeElement);return a&&a.getShadow()};BrowserDocument.startApp=function(a){document.addEventListener("DOMContentLoaded",function(){window.app||(window.app=new a,window.app.renderApp())},!1)};window.BrowserDocument=BrowserDocument;var BrowserShadow=function(a){AbstractShadow.apply(this,arguments)};$jscomp.inherits(BrowserShadow,AbstractShadow);
BrowserShadow.prototype._getJQ=function(){return jQuery('[data-suid="'+this.getShadowStump()._getUid()+'"]')};BrowserShadow.prototype.getShadowElement=function(){return this._getJQ()[0]};BrowserShadow.prototype.insertHtmlNode=function(a,b){var c=a.toHtmlWithSuids(),c=jQuery(c),d=this._getJQ();void 0===b?d.append(c):0===b?d.prepend(c):jQuery(d.children().get(b-1)).after(c);c.data("stump",a)};BrowserShadow.prototype.getShadowPosition=function(){return this._getJQ().position()};
BrowserShadow.prototype.setShadowHtml=function(a){this._getJQ().html(a);return this};BrowserShadow.prototype.onShadowEvent=function(a,b,c){this._getJQ().on(a,b,c);return this};BrowserShadow.prototype.offShadowEvent=function(a,b){this._getJQ().off(a,b);return this};BrowserShadow.prototype.triggerShadowEvent=function(a){this._getJQ().trigger(a);return this};BrowserShadow.prototype.getShadowHtml=function(){return this._getJQ().html()};BrowserShadow.prototype.getShadowValue=function(){return this._getJQ().val()};
BrowserShadow.prototype.getShadowOuterHeight=function(){return this._getJQ().outerHeight()};BrowserShadow.prototype.getShadowOuterWidth=function(){return this._getJQ().outerWidth()};BrowserShadow.prototype.setShadowValue=function(a){this._getJQ().val(a);return this};BrowserShadow.prototype.isShadowChecked=function(){return this._getJQ().is(":checked")};BrowserShadow.prototype.toggleShadow=function(){this._getJQ().toggle();return this};BrowserShadow.prototype.getShadowWidth=function(){return this._getJQ().width()};
BrowserShadow.prototype.getShadowHeight=function(){return this._getJQ().height()};BrowserShadow.prototype.makeResizable=function(a){this._getJQ().resizable(a);return this};BrowserShadow.prototype.getShadowOffset=function(){return this._getJQ().offset()};BrowserShadow.prototype.removeShadow=function(){this._getJQ().remove();return this};BrowserShadow.prototype.makeDraggable=function(a){this._getJQ().draggable(a);return this};BrowserShadow.prototype.getShadowCss=function(a){return this._getJQ().css(a)};
BrowserShadow.prototype.setShadowCss=function(a){this._getJQ().css(a);return this};BrowserShadow.prototype.focusShadow=function(){this._getJQ().focus();return this};BrowserShadow.prototype.makeSelectable=function(a){this._getJQ().selectable(a);return this};BrowserShadow.prototype.bindShadow=function(a,b){this._getJQ().bind(a,b);return this};BrowserShadow.prototype.isShadowResizable=function(){return 0<this._getJQ().find(".ui-resizable-handle").length};window.BrowserShadow=BrowserShadow;
window.lodash||(window.lodash=_);window.console||(window.console={log:function(){},time:function(){},error:function(){},debug:function(){}});Object.values||(Object.values=function(a){return Object.keys(a).map(function(b){return a[b]})});var Shadow=function(a){AbstractShadow.apply(this,arguments)};$jscomp.inherits(Shadow,AbstractShadow);window.Shadow=Shadow;
var ShadowEvents={click:"click",change:"change",mouseover:"mouseover",mouseout:"mouseout",mousedown:"mousedown",contextmenu:"contextmenu",keypress:"keypress",keyup:"keyup",focus:"focus",mousemove:"mousemove",dblclick:"dblclick",submit:"submit",blur:"blur",paste:"paste",copy:"copy",resize:"resize",cut:"cut",drop:"drop",dragover:"dragover",dragenter:"dragenter",dragleave:"dragleave",ready:"ready"};window.ShadowEvents=ShadowEvents;
var WillowDocument=function(a){return AbstractWillowDocument.apply(this,arguments)||this};$jscomp.inherits(WillowDocument,AbstractWillowDocument);window.WillowDocument=WillowDocument;BrowserDocument.startApp(OhayoApp);
